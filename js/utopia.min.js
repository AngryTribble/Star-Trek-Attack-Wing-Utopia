{var module=angular.module("utopia-dragdrop",[]),module,module,module,module,module,module;module.directive("draggable",function(){return{scope:{dragItem:"=",dragStore:"=",dragSource:"="},link:function(n,e){e.prop("draggable",!0),e.on("dragstart",function(t){n.$apply(function(){n.dragStore.item=n.dragItem,n.dragStore.source=n.dragSource}),e.addClass("dragging"),t.originalEvent.dataTransfer.effectAllowed="move",t.originalEvent.dataTransfer.setData("text/plain","google")}),e.on("dragend",function(t){e.removeClass("dragging"),n.$apply(function(t){delete t.dragStore.item,delete t.dragStore.source})}),e.on("click",function(t){return n.$apply(function(){n.dragStore.item!=n.dragItem?(n.dragStore.item=n.dragItem,n.dragStore.source=n.dragSource):delete n.dragStore.item}),t.preventDefault(),!1})}}}),module.directive("droppable",function(){return{scope:{drop:"&",canDrop:"&",dragStore:"="},link:function(n,e){e.on("dragover",function(t){n.canDrop({$item:n.dragStore.item})&&(e.addClass("drag-over"),t.preventDefault())}),e.on("dragenter",function(t){n.canDrop({$item:n.dragStore.item})&&e.addClass("drag-over")}),e.on("dragleave",function(t){e.removeClass("drag-over")}),e.on("drop",function(t){e.removeClass("drag-over"),n.$apply(function(t){t.drop({$item:t.dragStore.item}),delete t.dragStore.item}),t.preventDefault()}),e.on("click",function(t){n.$apply(function(){n.dragStore.item&&(n.drop({$item:n.dragStore.item}),delete n.dragStore.item)}),t.preventDefault()})}}}),(module=angular.module("utopia-fleet-builder",["utopia-card-upgrade","utopia-dragdrop"])).directive("fleetBuilder",["$filter",function(u){return{scope:{fleet:"=",cards:"=",searchOptions:"=",dragStore:"="},templateUrl:"fleet-builder.html",controller:["$scope","isMobile",function(s,t){s.isMobile=t,s.$watch("fleet",function(t){location.hash=btoa(angular.toJson(s.saveFleet(t)))},!0),s.$on("removeFromFleet",function(t,n){s.removeFromFleet(n,s.fleet)}),s.$on("zoom",function(t,n){s.zoom=n}),s.setSearchTypes=function(e){$.each(s.searchOptions.types,function(t,n){n.search=0<=$.inArray(t,e)}),s.searchOptions.columns<1&&(s.searchOptions.columns=1)},s.addFleetShip=function(t,n){var e=s.findOtherInFleet(n,t);return c(n,"canJoinFleet",n,t)?e&&e!=n?(console.log("upgrade uniquenes check failed"),!1):(e&&s.removeFromFleet(e,t),n=angular.copy(n),t.ships.push(n),n):(console.log("joinFleet stopped by interceptor"),!1)},s.getUpgradeSlots=u("upgradeSlots"),s.isUpgradeCompatible=function(t,n,e,a){return t!=n.occupant&&(n=c(n,"type",e,a),"question"==t.type?t.isSlotCompatible&&t.isSlotCompatible(n):0<=$.inArray(t.type,n))};var c=u("valueOf");function i(t,n){return n&&t.unique&&n.unique&&t.name==n.name&&t.mirror==n.mirror&&n}function r(t){var n,a,i;return t?(n={id:t.type+":"+t.id},t.resource&&(n.resource=r(t.resource)),t.captain&&(n.captain=r(t.captain)),t.admiral&&(n.admiral=r(t.admiral)),t.ambassador&&(n.ambassador=r(t.ambassador)),t.construction&&(n.construction=r(t.construction)),a=[],$.each(t.upgrades||[],function(t,n){var e={};n.occupant&&(e=r(n.occupant)),a.push(e)}),0<a.length&&(n.upgrades=a),i=[],$.each(t.upgradeSlots||[],function(t,n){var e={};n.occupant&&(e=r(n.occupant)),i.push(e)}),0<i.length&&(n.upgradeSlots=i),n):{}}function o(a,i,r,c){var t=angular.copy(s.findCardById(i,r.id));return t?{card:t,promulgate:function(e){var t,n;r.resource&&(t=o(a,i,r.resource,e))&&(n=s.setShipResource(a,e,t.card))&&t.promulgate(n),r.captain&&(t=o(a,i,r.captain,e))&&(n=s.setShipCaptain(a,e,t.card))&&t.promulgate(n),r.admiral&&(t=o(a,i,r.admiral,e))&&(n=s.setShipAdmiral(a,e,t.card))&&t.promulgate(n),r.ambassador&&(t=o(a,i,r.ambassador,e))&&(n=s.setShipAmbassador(a,e,t.card))&&t.promulgate(n),r.construction&&(t=o(a,i,r.construction,e))&&(n=s.setShipConstruction(a,e,t.card))&&t.promulgate(n),$.each(r.upgrades||[],function(t,n){n&&n.id&&(n=o(a,i,n,e))&&(t=s.setUpgrade(a,e,e.upgrades[t],n.card))&&n.promulgate(t)}),$.each(r.upgradeSlots||[],function(t,n){n&&n.id&&(n=o(a,i,n,c||e))&&(t=s.setUpgrade(a,c||e,e.upgradeSlots[t],n.card))&&n.promulgate(t)})}}:(console.log("unable to load card",r.id),!1)}s.setUpgrade=function(t,n,e,a){var i;return s.isUpgradeCompatible(a,e,n,t)?e.occupant!=a&&(c(a,"canEquip",n,t,e)?c(a,"canEquipFaction",n,t,e)?e.canEquip&&!e.canEquip(a,n,t,e)?(console.log("upgrade rejected by slot"),!1):(i=s.findOtherInFleet(a,t))&&i!=a&&i!=e.occupant?(console.log("upgrade uniquenes check failed"),!1):(i&&i!=e.occupant&&s.removeFromFleet(i,t,e.occupant),e.occupant=angular.copy(a),c(e.occupant,"onEquip",n,t),e.occupant):(console.log("equip stopped by faction-specific special card rule"),!1):(console.log("equip stopped by special card rule"),!1)):(console.log("wrong slot type"),!1)},s.setShipResource=function(t,n,e){return!(!t.resource||e.type!=t.resource.slotType)&&(c(e,"canEquip",n,t)?(t=s.findOtherInFleet(e,t))&&t!=upgrade&&t!=n.resource?(console.log("upgrade uniquenes check failed"),!1):(n.resource=angular.copy(e),n.resource):(console.log("equip stopped by special card rule"),!1))},s.setShipCaptain=function(t,n,e){var a;return"captain"!=e.type?(console.log("card is not a captain"),!1):c(e,"canEquipCaptain",n,t)?(a=s.findOtherInFleet(e,t))&&a!=e&&a!=n.captain?(console.log("captain already in fleet"),!1):(a&&a!=n.captain&&s.removeFromFleet(a,t,n.captain),n.captain=angular.copy(e),n.captain):(console.log("equip stopped by interceptor"),!1)},s.setShipConstruction=function(t,n,e){return"starship_construction"!=e.type?(console.log("card is not a starship_construction"),!1):c(e,"canEquipConstruction",n,t)?(n.construction=angular.copy(e),n.construction):(console.log("equip stopped by interceptor"),!1)},s.fleetHasAdmiral=function(t){var e=!1;return $.each(t.ships,function(t,n){if(n.admiral)return!(e=!0)}),e},s.fleetHasAmbassador=function(t){var e=!1;return $.each(t.ships,function(t,n){if(n.ambassador)return!(e=!0)}),e},s.setShipAdmiral=function(t,n,e){var a;return"admiral"==e.type&&(c(e,"canEquipAdmiral",n,t)?(a=s.findOtherInFleet(e,t))&&a!=e&&a!=n.admiral?(console.log("admiral already in fleet"),!1):(a&&a!=n.admiral&&s.removeFromFleet(a,t,n.admiral),n.admiral=angular.copy(e),n.admiral):(console.log("equip stopped by interceptor"),!1))},s.setShipAmbassador=function(t,n,e){var a;return"ambassador"==e.type&&(c(e,"canEquipAmbassador",n,t)?(a=s.findOtherInFleet(e,t))&&a!=e&&a!=n.ambassador?(console.log("ambassador already in fleet"),!1):(a&&a!=n.ambassador&&s.removeFromFleet(a,t,n.ambassador),n.ambassador=angular.copy(e),n.ambassador):(console.log("equip stopped by interceptor"),!1))},s.findOtherInFleet=function(e,t){var a=!1;return $.each(t.ships,function(t,n){return e==n||i(e,n)?(a=n,!1):e==n.captain||i(e,n.captain)?(a=n.captain,!1):e==n.admiral||i(e,n.admiral)?(a=n.admiral,!1):e==n.ambassador||i(e,n.ambassador)?(a=n.ambassador,!1):($.each(s.getUpgradeSlots(n),function(t,n){if(e==n.occupant||i(e,n.occupant))return a=n.occupant,!1}),!a&&void 0)}),t.resource&&$.each(t.resource.upgradeSlots||[],function(t,n){if(e==n.occupant||i(e,n.occupant))return a=n.occupant,!1}),a},s.removeFromFleet=function(a,i,r){if(!a)return!1;a==i.resource&&delete i.resource,i.resource&&$.each(i.resource.upgradeSlots||[],function(t,n){if(a==n.occupant)return r&&s.isUpgradeCompatible(r,n)?n.occupant=r:delete n.occupant,!(found=!0)}),$.each(i.ships,function(t,n){var e;return a==n?(r&&"ship"==r.type?i.ships[t]=r:i.ships.splice(t,1),!1):a==n.resource?(delete n.resource,!1):a==n.captain?(r&&"captain"==r.type?n.captain=r:delete n.captain,!1):a==n.admiral?(r&&"admiral"==r.type?n.admiral=r:delete n.admiral,!1):a==n.ambassador?(r&&"ambassador"==r.type?n.ambassador=r:delete n.ambassador,!1):a==n.construction?(r&&"construction"==r.type?n.construction=r:delete n.construction,!1):(e=!1,$.each(s.getUpgradeSlots(n),function(t,n){if(a==n.occupant)return r&&s.isUpgradeCompatible(r,n)?n.occupant=r:delete n.occupant,!(e=!0)}),!e)}),c(a,"onRemove",{},i)},s.getTotalCost=function(e,a){var i=u("valueOf"),r=i(e,"cost",e,a);return e.resource&&!i(e.resource,"free",e,a)&&(r+=i(e.resource,"cost",e,a)),e.captain&&!i(e.captain,"free",e,a)&&(r+=i(e.captain,"cost",e,a)),e.admiral&&!i(e.admiral,"free",e,a)&&(r+=i(e.admiral,"cost",e,a)),e.ambassador&&!i(e.ambassador,"free",e,a)&&(r+=i(e.ambassador,"cost",e,a)),e.construction&&!i(e.construction,"free",e,a)&&(r+=i(e.construction,"cost",e,a)),$.each(s.getUpgradeSlots(e),function(t,n){!n.occupant||i(n.occupant,"free",e,a)||(r+=i(n.occupant,"cost",e,a))}),e.totalCost=r},s.getFleetCost=function(e){var a=e.resource?c(e.resource,"cost",{},e):0;return $.each(e.ships,function(t,n){a+=s.getTotalCost(n,e)}),e.totalCost=a},s.setFleetResource=function(t,n){t.resource&&s.removeFromFleet(t.resource,t),t.resource=n},s.saveFleet=function(t){var e={ships:[]};return t.resource&&(e.resource=r(t.resource)),$.each(t.ships,function(t,n){e.ships.push(r(n))}),e},s.findCardById=function(t,e){var a=!1;return $.each(t,function(t,n){if(n.type+":"+n.id==e)return a=n,!1}),a};var n=!(s.loadFleet=function(a,t){var i={ships:[]};return t.resource&&(result=o(i,a,t.resource))&&(i.resource=result.card,result.promulgate(i.resource)),$.each(t.ships,function(t,n){var e,n=o(i,a,n);n&&(e=s.addFleetShip(i,n.card))&&n.promulgate(e)}),i});try{n=!!location.hash&&angular.fromJson(atob(location.hash.substring(1)))}catch(t){}s.$on("cardsLoaded",function(){(n=n&&s.loadFleet(s.cards,n))&&(s.fleet=n,0<s.fleet.ships.length)&&($.each(n.ships,function(t,n){n.hideEmptySlots=!0}),s.searchOptions.columns=0)})}]}}]),(module=angular.module("utopia-fleet-export",[])).directive("fleetExport",function(){return{scope:{fleet:"=",sets:"=",searchOptions:"="},templateUrl:"fleet-export.html",link:function(t,n){$(n).find("textarea").focus(function(){($this=$(this)).select(),window.setTimeout(function(){$this.select()},1),$this.mouseup(function(){return $this.unbind("mouseup"),!1})})},controller:["$scope","$filter",function(f,t){f.fleetText="",f.showSetNames=!1,f.ttsExportStyle=!1;var h=t("valueOf");function n(e){var a,i,t,r,c,s,o;"fleetSheet"==f.exportType?(o={cost:(s=e).totalCost,ships:[],resource:{}},$.each(s.ships,function(t,n){var e=[];!function e(t,a,i,r){var n={name:t.name,type:l(t.type),faction:p(t.factions),cost:h(t,"cost",a,i),priority:0};console.log(t+" the data: "+n);"ship"!=t.type||t.unique||(n.name="Generic "+t.class);switch(n.type){case"Ship":n.priority=0;break;case"Captain":n.priority=1;break;case"Admiral":n.priority=2;break;case"Ambassador":n.priority=3;break;default:n.priority=4}r.push(n);t.resource&&r.push(e(t.resource,a,i,r));t.captain&&r.push(e(t.captain,a,i,r));t.admiral&&r.push(e(t.admiral,a,i,r));t.ambassador&&r.push(e(t.ambassador,a,i,r));t.construction&&r.push(e(t.construction,a,i,r));t.upgrades&&0<t.upgrades.length&&$.each(t.upgrades,function(t,n){n.occupant&&r.push(e(n.occupant,a,i,r))});t.upgradeSlots&&0<t.upgradeSlots.length&&$.each(t.upgradeSlots||[],function(t,n){n.occupant&&r.push(e(n.occupant,a,i,r))})}(n,n,s,e),(e=$.grep(e,function(t){return 0==t||t})).sort(function(t,n){return t.priority-n.priority}),$.each(e,function(t,n){delete n.priority,n.index=t}),o.ships.push({cards:e.slice(),cost:n.totalCost})}),s.resource&&(o.resource.name=s.resource.name,o.resource.cost=h(s.resource,"cost",{},s)),o.ships.sort(function(t,n){return n.cost-t.cost}),f.fleetText=JSON.stringify(o,null,2)):"tts"==f.exportType?(r=e,c="",$.each(r.ships,function(t,n){n=u(n,n,r);c+=n.text+"\n"}),r.resource&&(t=u(r.resource,{},r),c+=t.text+"\n"),c+="\n\n------------------------------------------\nGenerated by Utopia for Tabletop Simulator",f.fleetText=c):(a="",i=0,a+="Save your URL for easy Reloading\n\n",$.each(e.ships,function(t,n){n=g(n,n,e);a+=n.text+"Ship Total: "+n.cost+" SP\n\n",i+=n.cost}),e.resource&&(t=g(e.resource,{},e),a+="Resource: "+t.text+"\n",i+=t.cost),a=(a+="Fleet Total: "+i+" SP\n\n")+"Generated by Utopia "+window.location.href.split("#")[0].replace("index.html",""),f.fleetText=a)}function g(t,e,a,i,n){var r="";i=i||0;for(var c=0;c<i;c++)r+="- ";var s,o,u,p=h(t,"cost",e,a),l=h(t,"free",e,a),d=!0;return"resource"==t.type&&(d=!1),r+=t.name,"captain"==t.type&&(r+=" "+t.skill+" (Captain)"),"admiral"==t.type&&(r+=" (Admiral)"),"ambassador"==t.type&&(r+=" (Ambassador)"),"starship_construction"==t.type&&(r+=" "),"fleet-captain"==t.type&&(r+=" Fleet Captain"),"flagship"==t.type&&(r+=" Flagship"),"faction"==t.type&&(r+=" Faction"),"ship"==t.type?r+=t.unique?"":" ("+t.class+")":f.showSetNames&&(r+=t.set?" ("+(s=t.set,o="",$.each(s,function(t,n){o+=f.sets[n]?f.sets[n].name:n,t<s.length-1&&(o+=", ")}),o)+")":""),l&&(p=0),n||(r+=" ["+p+"]"),r+="\n",t.resource&&(u=g(t.resource,e,a,i+1),r+=u.text,p+=u.cost),t.captain&&(u=g(t.captain,e,a,i+1),r+=u.text,p+=u.cost),t.admiral&&(u=g(t.admiral,e,a,i+1),r+=u.text,p+=u.cost),t.ambassador&&(u=g(t.ambassador,e,a,i+1),r+=u.text,p+=u.cost),t.construction&&(u=g(t.construction,e,a,i+1),r+=u.text,p+=u.cost),$.each(t.upgrades||[],function(t,n){n.occupant&&(n=g(n.occupant,e,a,i+1),r+=n.text,d)&&(p+=n.cost)}),$.each(t.upgradeSlots||[],function(t,n){n.occupant&&(n=g(n.occupant,e,a,i+1,!d),r+=n.text,d)&&(p+=n.cost)}),{cost:p,text:r}}function u(t,e,a){var n,i="",i=("ship"==t.type&&t.unique,t.id);return i+="\n",t.resource&&(n=u(t.resource,e,a),i+=n.text),t.captain&&(n=u(t.captain,e,a),i+=n.text),t.admiral&&(n=u(t.admiral,e,a),i+=n.text),t.ambassador&&(n=u(t.ambassador,e,a),i+=n.text),t.construction&&(n=u(t.construction,e,a),i+=n.text),$.each(t.upgrades||[],function(t,n){n.occupant&&(n=u(n.occupant,e,a),i+=n.text)}),$.each(t.upgradeSlots||[],function(t,n){n.occupant&&(n=u(n.occupant,e,a),i+=n.text)}),{cost:0,text:i}}function p(t){var e={federation:"FED",klingon:"KLI",romulan:"ROM",dominion:"DOM",borg:"BOR","species-8472":"SPE",kazon:"KAZ",xindi:"XIN",bajoran:"BAJ",ferengi:"FER",vulcan:"VUL",independent:"IND","mirror-universe":"MIR","q-continuum":"Q"},a=[];return $.each(t,function(t,n){n in e?a.push(e[n]):console.error("Unknown Faction: "+n)}),a.join("/")}function l(t){return{ship:"Ship",captain:"Captain",admiral:"A",ambassador:"M",construction:"Starship Construction",crew:"C",talent:"E",tech:"T",weapon:"W",borg:"B",squadron:"S"}[t]}f.$watch("fleet",function(t){n(t)},!0),f.$watch("showSetNames",function(){n(f.fleet)}),f.$watch("exportType",function(){n(f.fleet)})}]}}),(module=angular.module("utopia-missions",["utopia"])).controller("UtopiaSetCtrl",["$scope","cardLoader",function(a,t){a.missionSets={},a.missionList=[],a.viewer={},a.activeSet=!1,a.setCards=[],t(a.missionSets,function(){location.hash&&location.hash.substring(1);$.each(Object.keys(a.missionSets),function(t,n){var e=a.missionSets[n];e.sourceID!=n&&e.name!=n||(a.viewer.missionSets=e,a.missionList.push(e))}),a.$watch("viewer.missionSets",function(e){a.missionSetCards=[],e&&(location.hash=e.sourceID,$.each(a.cards,function(t,n){0<=$.inArray(e.sourceID,n.missionSet)&&a.setCards.push(n)}),a.setCards.sort(displaySort))})})}]),(module=angular.module("utopia-search",["utopia-card","utopia-dragdrop","utopia-card-loader","utopia-card-rules"])).filter("cardFilter",["$factions","$filter",function(u,e){return function(t,o){var n=e("valueOf");return $.map(t,function(a){if(o.unique&&!a.unique&&!o.generic)return null;if(o.generic&&a.unique&&!o.unique)return null;if(a.set&&!o.ignoreSetsFilter&&o.sets){var e=!1;if($.each(a.set,function(t,n){o.sets[n].search&&(e=!0)}),!e)return null}if(o.filterField&&o.filterOperator&&o.filterValue){var t=n(a,o.filterField);if(!t)return null;switch(o.filterOperator){case"<":if(t>=o.filterValue)return null;break;case"<=":if(t>o.filterValue)return null;break;case"=":if(t!=o.filterValue)return null;break;case">=":if(t<o.filterValue)return null;break;case">":if(t<=o.filterValue)return null}}if(o.query&&a.name.toLowerCase().indexOf(o.query.toLowerCase())<0&&(!a.class||a.class.toLowerCase().indexOf(o.query.toLowerCase())<0)&&a.text.toLowerCase().indexOf(o.query.toLowerCase())<0)return null;var i,r=!0;if($.each(o.types,function(t,n){if(n.search)return r=!1}),!r&&!o.types[a.type].search)return null;if(o.maneuverType){if("ship"!=a.type)return null;var c=!1,s=[];if($.each(Object.keys(a.classData.maneuvers),function(t,e){var n;$.isNumeric(e)&&(n=Object.keys(a.classData.maneuvers[e]),$.each(n,function(t,n){(maneuver_object={}).direction=n,maneuver_object.difficulty=a.classData.maneuvers[e][n],maneuver_object.speed=parseInt(e,10),maneuver_object.speed<0&&(maneuver_object.direction="reverse",maneuver_object.speed=Math.abs(maneuver_object.speed)),s.push(maneuver_object)}))}),$.each(s,function(t,n){o.maneuverDifficulty?n.direction==o.maneuverType&&n.difficulty==o.maneuverDifficulty&&(c=!0):n.direction==o.maneuverType&&(c=!0)}),!c)return null}return"resource"==a.type||(i=!(r=!0),$.each(o.factions,function(t,n){n.search&&(r=!1,i|=u.hasFaction(a,t))}),r)||i?a:null})}}]),module.filter("sortBy",["$filter",function(a){return function(t,n,e){return e=!0===e||"true"==e,a("orderBy")(t,function(t){return a("valueOf")(t,n)||0},!e)}}]),module.directive("search",function(){return{scope:{cards:"=",sets:"=",setList:"=",dragStore:"=",search:"=searchOptions",defaults:"="},templateUrl:"search.html",controller:["$scope","$factions",function(a,t){a.search={query:"",unique:!1,generic:!1,factions:{},types:{ship:{},captain:{},admiral:{}},columns:1,sortBy:"cost",ascending:"false",maneuverType:"",maneuverDifficulty:"",filterField:"",filterOperator:"<=",filterValue:""},a.defaults=localStorage.defaults?angular.fromJson(localStorage.defaults):{},a.defaults.search?angular.copy(a.defaults.search,a.search):a.defaults.search=angular.copy(a.search),a.resetSearch=function(){a.search.query="",a.search.unique=!1,a.search.generic=!1,$.each(a.search.factions,function(t,n){n.search=!1}),$.each(a.search.types,function(t,n){n.search=!1}),a.search.sortBy=a.defaults.search.sortBy||"name",a.search.ascending=a.defaults.search.ascending||"true",a.search.maneuverType="",a.search.maneuverDifficulty="",a.search.filterField="",a.search.filterOperator="<=",a.search.filterValue=""},a.modifySearchColumns=function(t){a.search.columns+=t,a.search.columns<0&&(a.search.columns=0),5<a.search.columns&&(a.search.columns=5)},a.$watch("search",function(){a.resultLimit=10},!0),a.$watch("search.sets",function(t){t&&(localStorage.sets=angular.toJson(t))},!0),a.$watch("defaults",function(t){t&&(localStorage.defaults=angular.toJson(t))},!0),$.each(t.list,function(t,n){a.search.factions[n.toLowerCase().replace(/ /g,"-")]={}}),a.sortables=[{value:"name",name:"Name"},{value:"cost",name:"Cost"},{value:"attack",name:"Attack"},{value:"agility",name:"Agility"},{value:"hull",name:"Hull"},{value:"shields",name:"Shields"},{value:"skill",name:"Skill Value"}],a.maneuvers=[{value:"bank",name:"Bank"},{value:"turn",name:"Turn"},{value:"about",name:"Come About"},{value:"reverse",name:"Full Astern"},{value:"spin",name:"Spin"},{value:"stop",name:"Stop"},{value:"flank",name:"Flank"},{value:"45-degree-rotate",name:"Rotate 45 Degrees"},{value:"90-degree-rotate",name:"Rotate 90 Degrees"}],a.difficulty_list=[{value:"green",name:"Green"},{value:"white",name:"White"},{value:"red",name:"Red"}],a.$on("cardsLoaded",function(){$.each(a.cards,function(t,n){a.search.types[n.type]||(a.search.types[n.type]={})});try{a.search.sets=localStorage.sets?angular.fromJson(localStorage.sets):{},a.defaults=localStorage.defaults?angular.fromJson(localStorage.defaults):{}}catch(t){a.search.sets={},a.defaults={}}$.each(a.sets,function(t,n){a.search.sets[n.id]||(console.log("New set: "+n.name),a.search.sets[n.id]={search:!0}),a.setList.push(n)})}),a.uncheckAllSets=function(){$.each(a.search.sets,function(t,n){n.search=!1})},a.exportSets=function(){var t="utopia_owned_sets.json",n=JSON.stringify(a.search.sets,null,2),n=encodeURIComponent(n),e=document.createElement("a");console.log("Exporting owned sets to the file "+t),e.setAttribute("href","data:application/json;charset=utf-8,"+n),e.setAttribute("download",t),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},a.importSets=function(t){var n,t=t.files[0],e=new FileReader;e.onload=function(t){n=t.target.result,a.processSetsImport(n)},console.info("Opening "+t.name+" saved set file..."),e.readAsText(t)},a.processSetsImport=function(t){var t=JSON.parse(t),e=0;$.each(t,function(t,n){"search"in n==0&&e++}),0<e?console.error("Owned set file import failed with "+e+" errors found in file."):(localStorage.sets=angular.toJson(t),window.location.reload(!0))},a.checkAllSets=function(){$.each(a.search.sets,function(t,n){n.search=!0})}}]}}),module.directive("searchFilterGroup",function(){return{scope:{title:"@"},templateUrl:"search-filter-group.html",transclude:!0,link:function(t,n,e){null!=e.open&&(t.showContent=!0)}}}),(module=angular.module("utopia-set-viewer",["utopia"])).controller("UtopiaSetCtrl",["$scope","$filter","cardLoader","$factions",function(a,t,n,e){function i(t,n){var e,a;return"ship"==t.type&&t.unique?-1:"ship"==n.type&&n.unique?1:t.type==n.type?(a=n,(e=t).cost>a.cost?-1:a.cost>e.cost?1:0):"ship"==t.type?-1:"ship"==n.type?1:"captain"==t.type?-1:"captain"==n.type?1:"admiral"==t.type?-1:"admiral"==n.type?1:"talent"==t.type?-1:"talent"==n.type?1:"weapon"==t.type?-1:"weapon"==n.type?1:"tech"==t.type?-1:"tech"==n.type?1:"crew"==t.type?-1:"crew"==n.type?1:0}a.cards=[],a.sets={},a.setList=[],a.shipClasses={},a.token={},a.viewer={},a.activeSet=!1,a.setCards=[],n(a.cards,a.sets,a.shipClasses,a.token,function(){var e=!!location.hash&&location.hash.substring(1);$.each(Object.keys(a.sets),function(t,n){n=a.sets[n];n.id!=e&&n.name!=e||(a.viewer.set=n),a.setList.push(n)})}),a.$watch("viewer.set",function(e){a.setCards=[],e&&(location.hash=e.id,$.each(a.cards,function(t,n){0<=$.inArray(e.id,n.set)&&a.setCards.push(n)}),a.setCards.sort(i))})}]),(module=angular.module("utopia-tooltip",[])).directive("tooltip",["$filter",function(r){return{scope:{tooltip:"&",tooltipPosition:"@",tooltipShow:"="},restrict:"A",link:function(n,e,t){var i=!1;n.$watch("tooltipShow",function(t){var a;t&&!i&&(i=!0,$(e).data("powertipjq",$("<div></div>")),$(e).powerTip({placement:n.tooltipPosition||"ne-alt"}),a=r("icons"),$(e).on("powerTipRender",function(){var e=$("<table class='card-tooltip'></table>");$.each(n.tooltip(),function(t,n){e.append("<tr><td>"+a(n.source)+"</td><td>"+(0<n.value&&0<t?"+":"")+n.value+"</tr>")}),$("#powerTip").html(e)}),n.$on("$destroy",function(){$(e).powerTip("destroy")}))})}}}])}function wrapInterceptors(t,e,a){e=e.type?"["+e.type+"] "+e.name:e;(t instanceof Function||!t.length)&&(t=[t]),$.each(t,function(t,n){n instanceof Function?a.push({fn:n,priority:50,source:e}):n.fn?(n.priority=n.priority||50,n.source=n.source||e,a.push(n)):console.log("Invalid interceptor",n)})}(module=angular.module("utopia",["ngSanitize","utopia-search","utopia-card","utopia-fleet-builder","utopia-fleet-export","utopia-card-loader","utopia-card-rules"])).factory("isMobile",function(){var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}),module.controller("UtopiaCtrl",["$scope","$filter","cardLoader","$factions",function(e,t,n,a){e.defaults={};try{e.defaults=!!localStorage.defaults&&angular.fromJson(localStorage.defaults)}catch(t){e.defaults={}}e.drag={},e.cards=[],e.sets={},e.setList=[],e.shipClasses={},e.token={},e.activeFleet={ships:[]},e.loading=!0,n(e.cards,e.sets,e.shipClasses,e.token,function(){e.$broadcast("cardsLoaded"),e.loading=!1}),e.$watch("defaults",function(t){t&&(localStorage.defaults=angular.toJson(t))},!0),e.$on("removeFromFleetDropped",function(t,n){e.$broadcast("removeFromFleet",n)}),e.keypress=function(t){(26==t.which||122==t.which&&t.ctrlKey)&&(e.zoom=!e.zoom,e.$broadcast("zoom",e.zoom))}}]),(module=angular.module("utopia-card-faction",[])).directive("cardFaction",function(){return{scope:{faction:"=",dragStore:"=",dragSource:"="},templateUrl:"card-faction.html",controller:["$scope",function(t){}]}}),(module=angular.module("utopia-card-loader",["utopia-card-rules","utopia-card-ship","utopia-card-upgrade","utopia-card-resource","utopia-card-faction","utopia-card-token"])).factory("cardLoader",["$http","$filter","cardRules","$factions",function(t,g,m,v){var y=g("valueOf");return function(s,e,a,o,n){function r(e,t){var a=!1;return $.each(t,function(t,n){if(e.id==n.id&&e.type==n.type)return!(a=!0)}),a}var i={canJoinFleet:!0,intercept:{ship:{},fleet:{}}};var u={intercept:{ship:{},fleet:{}},canEquip:!0,canEquipCaptain:!0,canEquipFaction:!0,showType:!0};var p={intercept:{ship:{},fleet:{}},canEquip:!0,canEquipAdmiral:!0,canEquipFaction:!0,isSkillModifier:!0,showType:!0};var l={intercept:{ship:{},fleet:{}},canEquip:!0,canEquipAmbassador:!0,canEquipFaction:!0,isSkillModifier:!0,showType:!0};var d={intercept:{ship:{},fleet:{}},canEquipConstruction:!0};var f={intercept:{ship:{},fleet:{}},canEquip:!0,canEquipFaction:!0};var h={intercept:{ship:{},fleet:{}},canEquip:!0,canEquipFaction:!0};t.get("data/data.json").success(function(t){var c=[];$.each(t.sets||[],function(t,n){"copy"==n.type?c.push(n):e[(n=n).id]?console.log("Duplicate set",n.id,n.name):e[n.id]=n}),$.each(t.ships||[],function(t,n){if("copy"==n.type)c.push(n);else{var e=n;if(r(e,s))console.log("Duplicate card definition ignored",e.id);else{e.mirror=v.hasFaction(e,"mirror-universe");for(var a=0;a<e.upgrades.length;a++)"string"==typeof e.upgrades[a]&&(e.upgrades[a]={type:[e.upgrades[a]],source:"ship"});$.extend(!0,e,i),e.squadron&&(e.canJoinFleet=function(t,n,e){var a=0,i=0;return $.each(e.ships,function(t,n){n.squadron?i++:4<=n.hull&&a++}),i<a}),m[e.type+":"+e.id]&&$.extend(!0,e,m[e.type+":"+e.id]),$.each(e.upgradeSlots||[],function(t,n){n.source||(n.source=e.name)}),e.intercept.ship.cost?e.intercept.ship.cost=[e.intercept.ship.cost]:e.intercept.ship.cost=[],e.intercept.ship.cost.push({source:"Faction Penalty",priority:1,fn:function(t,n,e,a){var i;return v.match(t,n,n,e)?a:(i=y(t,"factionPenalty",n,e),(a instanceof Function?a(t,n,e,0):a)+i)}}),s.push(e)}}}),$.each(t.shipClasses||[],function(t,n){"copy"==n.type?c.push(n):a[(n=n).id]?console.log("Duplicate ship class",n.id,n.name,a[n.id].name):a[n.id]=n}),$.each(t.captains||[],function(t,n){if("copy"==n.type)c.push(n);else{var e=n;if(r(e,s))console.log("Duplicate card definition ignored",e.id);else{$.extend(!0,e,u),null==e.factionPenalty&&(e.factionPenalty=1),e.mirror=v.hasFaction(e,"mirror-universe"),e.upgradeSlots=[];for(var a=0;a<e.talents;a++)e.upgradeSlots.push({type:["talent"],source:e.name});m[e.type+":"+e.id]&&$.extend(!0,e,m[e.type+":"+e.id]),$.each(e.upgradeSlots||[],function(t,n){n.source||(n.source=e.name)}),s.push(e)}}}),$.each(t.admirals||[],function(t,n){if("copy"==n.type)c.push(n);else{var i=n;if(r(i,s))console.log("Duplicate card definition ignored",i.id);else{$.extend(!0,i,p),null==i.factionPenalty&&(i.factionPenalty=3),i.mirror=v.hasFaction(i,"mirror-universe"),i.upgradeSlots=[];for(var e=0;e<i.talents;e++)i.upgradeSlots.push({type:["talent"],source:i.name});i.intercept.ship.skill=function(t,n,e,a){return a=t==n.captain?(a instanceof Function?a(t,n,e,0):a)+i.skill:a},m[i.type+":"+i.id]&&$.extend(!0,i,m[i.type+":"+i.id]),$.each(i.upgradeSlots||[],function(t,n){n.source||(n.source=i.name)}),s.push(i)}}}),$.each(t.ambassadors||[],function(t,n){var e;"copy"==n.type?c.push(n):r(e=n,s)?console.log("Duplicate card definition ignored",e.id):($.extend(!0,e,l),null==e.factionPenalty&&(e.factionPenalty=0),e.mirror=v.hasFaction(e,"mirror-universe"),m[e.type+":"+e.id]&&$.extend(!0,e,m[e.type+":"+e.id]),$.each(e.upgradeSlots||[],function(t,n){n.source||(n.source=e.name)}),s.push(e))}),$.each(t.starship_construction||[],function(t,n){var e;"copy"==n.type?c.push(n):(e=n,console.log(`Load construction card: ${e.type}:`+e.id),console.dir(e),$.extend(!0,e,d),null==e.factionPenalty&&(e.factionPenalty=0),e.mirror=v.hasFaction(e,"mirror-universe"),e.upgradeSlots=[],m[e.type+":"+e.id]&&$.extend(!0,e,m[e.type+":"+e.id]),$.each(e.upgradeSlots||[],function(t,n){n.source||(n.source=e.name)}),s.push(e))}),$.each(t.upgrades||[],function(t,n){var e;"copy"==n.type?c.push(n):r(e=n,s)?console.log("Duplicate card definition ignored",e.id):($.extend(!0,e,f),null==e.factionPenalty&&(e.factionPenalty=1),e.mirror=v.hasFaction(e,"mirror-universe"),m[e.type+":"+e.id]&&$.extend(!0,e,m[e.type+":"+e.id]),$.each(e.upgradeSlots||[],function(t,n){n.source||(n.source=e.name)}),s.push(e))}),$.each(t.resources||[],function(t,n){"copy"==n.type?c.push(n):(n=n,$.extend(!0,n,h),m[n.type+":"+n.id]&&$.extend(!0,n,m[n.type+":"+n.id]),s.push(n))}),$.each(t.others||[],function(t,n){if("copy"==n.type)c.push(n);else{var i,r=n;if("fleet-captain"==r.type){for(var e=0;e<r.talentAdd;e++)r.upgradeSlots.push({type:["talent"],source:"Fleet Captain",rules:"Free talent if Captain has an empty talent slot",showOnCard:!0,intercept:{ship:{cost:{priority:-1,fn:function(t,n,e,a){var i;return n.captain&&(n=g("upgradeSlots")(n.captain),i=!1,$.each(n,function(t,n){0<=n.type.indexOf("talent")&&!n.occupant&&(i=!0)}),i)?0:a}}}}});for(e=0;e<r.techAdd;e++)r.upgradeSlots.push({type:["tech"],source:"Fleet Captain",showOnCard:!0});for(e=0;e<r.weaponAdd;e++)r.upgradeSlots.push({type:["weapon"],source:"Fleet Captain",showOnCard:!0});for(e=0;e<r.crewAdd;e++)r.upgradeSlots.push({type:["crew"],source:"Fleet Captain",showOnCard:!0});r.intercept.ship.skill=function(t,n,e,a){return a=t==n.captain?(a instanceof Function?a(t,n,e,0):a)+r.skill:a}}if("flagship"==r.type&&((i=r).intercept.ship={attack:function(t,n,e,a){return t==n&&"flagship"!=n.type?(a instanceof Function?a(t,n,e,0):a)+i.attack:a},agility:function(t,n,e,a){return t==n&&"flagship"!=n.type?(a instanceof Function?a(t,n,e,0):a)+i.agility:a},hull:function(t,n,e,a){return t==n&&"flagship"!=n.type?(a instanceof Function?a(t,n,e,0):a)+i.hull:a},shields:function(t,n,e,a){return t==n&&"flagship"!=n.type?(a instanceof Function?a(t,n,e,0):a)+i.shields:a}}),"token"==r.type){if(o[r.id])return void console.log("Duplicate token",r.id,r.name);o[r.id]=r}m[r.type+":"+r.id]&&$.extend(!0,r,m[r.type+":"+r.id]),s.push(r)}}),$.each(c||[],function(t,e){$.each(s,function(t,n){if(n.id==e.of)return n.set=n.set.concat(e.set),!1})}),$.each(s,function(t,e){"ship"==e.type&&(e.classId&&a[e.classId]?e.classData=a[e.classId]:$.each(a,function(t,n){if(n.name==e.class)return e.classId=t,e.classData=n,!1}),e.classId&&e.classData&&a[e.classId]||console.log("No class for ship",e.id,e.name,e.class,e.classId)),e.hasTokenInfo&&o[e.tokenId]&&(e.tokenData=o[e.tokenId])}),n&&n()})}}]),(module=angular.module("utopia-card-resource",[])).directive("cardResource",function(){return{scope:{resource:"=",ship:"=",fleet:"=",dragStore:"=",dragSource:"="},templateUrl:"card-resource.html",controller:["$scope",function(t){}]}}),(module=angular.module("utopia-card-rules",["utopia-valueof"])).filter("shipCardNamed",["$filter",function(t){var n=t("upgradeSlots");return function(t,e){var a;return t.name==e?t:t.captain&&t.captain.name==e?t.captain:(a=!1,$.each(n(t),function(t,n){if(n.occupant&&n.occupant.name==e)return a=n.occupant,!1}),a)}}]),module.filter("fleetCardNamed",["$filter",function(t){var i=t("shipCardNamed");return function(t,e){var a;return!!t&&(a=!1,$.each(t.ships,function(t,n){if(a=i(n,e))return!1}),a)}}]),module.factory("$factions",["$filter",function(t){var c=t("valueOf");let e={federation:"federation",vulcan:"federation",bajoran:"federation",klingon:"klingon",romulan:"romulan",dominion:"dominion",independent:"independent",ferengi:"independent",kazon:"independent",xindi:"independent",borg:"borg","mirror-universe":"mirror-universe","species-8472":"species-8472","q-continuum":"q-continuum"},i=t=>t.reduce((t,n)=>{n=e[n];return t.includes(n)||t.push(n),t},[]),s=(t,n)=>i([t]).some(t=>i([n]).includes(t));t={hasFaction:function(t,n,e,a){return!!t&&(t=c(t,"factions",e,a)||[],e=i(t),t.includes(n)||e.includes(n))},match:function(t,n,a,i){var r=!1;return $.each(c(t,"factions",a,i),function(t,e){if($.each(c(n,"factions",a,i),function(t,n){if(e==n||s(e,n))return!(r=!0)}),r)return!1}),r},matchByPrimeFaction:function(t,n,a,i){var r=!1;return $.each(c(t,"factions",a,i),function(t,e){if($.each(c(n,"factions",a,i),function(t,n){if(s(e,n))return!(r=!0)}),r)return!1}),r},list:["Federation","Klingon","Vulcan","Romulan","Bajoran","Dominion","Independent","Borg","Ferengi","Species 8472","Kazon","Mirror Universe","Xindi","Q Continuum"]};return t.listCodified=$.map(t.list,function(t){return t.toLowerCase().replace(/ /g,"-")}),t}]),module.factory("cardRules",["$filter","$factions",function(o,s){function a(i){return function(e,t,n){var a=!1,t=o("upgradeSlots")(t);return $.each(t,function(t,n){n.occupant&&n.occupant!=e&&n.occupant.name==i&&(a=!0)}),!a}}function r(t){return 0<=$.inArray(t.type,e)}function u(t,n,e,a){return a instanceof Function?a(t,n,e):a}function t(t,n){for(var e=[n],a=1;a<t;a++)e.push(angular.copy(n));return e}function n(e,t){var a=["weapon"];return $.each(o("upgradeSlots")(t),function(t,n){if(n.occupant&&n.occupant.name==e.source)return a=n.type,!1}),a}function c(t,n,e){var a=!1;if(n.type==t)a=!0;else if("question"==n.type&&n.countsAsUpgrade)for(var i=o("upgradeSlots")(e),r=0;r<i.length;r++)if(i[r].occupant&&i[r].occupant.id==n.id&&-1<$.inArray(t,i[r].type)){a=!0;break}return a}var p=o("valueOf"),e=["crew","weapon","tech","talent","question","borg"],l=s.hasFaction;return{"captain:Cap101":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)?0:1}},"captain:Cap112":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"vulcan",n,e)?0:1}},"captain:Cap115":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"federation",n,e)?0:1}},"captain:Cap111":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"ferengi",n,e)||s.hasFaction(n,"kazon",n,e)||s.hasFaction(n,"xindi",n,e)?0:1}},"captain:Cap114":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"independent",n,e)||s.hasFaction(n,"kazon",n,e)||s.hasFaction(n,"xindi",n,e)?0:1}},"captain:Cap113":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"ferengi",n,e)||s.hasFaction(n,"independent",n,e)||s.hasFaction(n,"xindi",n,e)?0:1}},"captain:Cap116":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"ferengi",n,e)||s.hasFaction(n,"kazon",n,e)||s.hasFaction(n,"independent",n,e)?0:1}},"talent:E213":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"federation",n,e)||l(n.captain,"bajoran",n,e)||l(n.captain,"vulcan",n,e)&&l(n.captain,"federation",n,e)||l(n.captain,"bajoran",n,e)||l(n.captain,"vulcan",n,e)}},"talent:E214":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"federation",n,e)||l(n.captain,"bajoran",n,e)||l(n.captain,"vulcan",n,e)&&l(n.captain,"federation",n,e)||l(n.captain,"bajoran",n,e)||l(n.captain,"vulcan",n,e)}},"talent:E215":{canEquipFaction:function(t,n,e){return l(n.captain,"federation",n,e)||l(n.captain,"bajoran",n,e)||l(n.captain,"vulcan",n,e)&&a("Shakedown Cruise Commander")}},"weapon:W222":{canEquipFaction:function(t,n,e){return l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)&&a("Type 10 Phasers")}},"weapon:W223":{canEquipFaction:function(t,n,e){return n&&(s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e))&&4<=n.hull&&a("Dorsal Phaser Array")},intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e):a},cost:function(t,n,e,a){return n?u(t,n,e,a)+p(n,"attack",n,e)+1:a}}}},"weapon:W224":{attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e)+1:a}}}},"weapon:W225":{canEquip:function(t,n,e){return 0<=n.class.indexOf("Akira Class")&&a("Dorsal Torpedo Pod")}},"weapon:W226":{canEquip:a("Quantum Torpedoes"),attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e)+1:a},cost:function(t,n,e,a){return"Galaxy Class"==n.class||"Constitution Class"==n.class||"Miranda Class"==n.class||"Nor Class Orbital Space Station"==n.class||"Vor'cha Class"==n.class||"D'Deridex Class"==n.class||"Breen Battle Cruiser"==n.class||"Cardassian Galor Class"==n.class||"Negh'Var Class"==n.class||"D7 Class"==n.class||"Romulan Science Vessel"==n.class||"Valdore Class"==n.class||"D'Kora Class"==n.class||"Jem'Hadar Attack Ship"==n.class||"Romulan Bird-Of-Prey"==n.class||"K't'inga Class"==n.class||"B'Rel Class"==n.class||"Cardassian Keldon Class"==n.class||"Romulan Scout Ship"==n.class||"K'Vort Class"==n.class||"Excelsior Class"==n.class||"Nebula Class"==n.class||"Raptor Class"==n.class||"Jem'Hadar Battleship"==n.class||"Nova Class"==n.class||"Bajoran Scout Ship"==n.class||"Borg Sphere"==n.class||"Kazon Raider"==n.class||"Species 8472 Bioship"==n.class||"Intrepid Class"==n.class||"Tholian Vessel"==n.class||"Gorn Raider"==n.class||"D'Kyr Class"==n.class||"Bajoran Interceptor"==n.class||"Borg Tactical Cube"==n.class||"Maquis Raider"==n.class||"Saber Class"==n.class||"Suurok Class"==n.class||"Jem'Hadar Battle Cruiser"==n.class||"Constitution Refit Class"==n.class||"Borg Type 03"==n.class||"Aerie Class"==n.class||"Constellation Class"==n.class||"Federation NX Class"==n.class||"Borg Scout Cube"==n.class||"Predator Class"==n.class||"Borg Octahedron"==n.class||"Reman Warbird"==n.class||"Klingon Bird-Of-Prey"==n.class||"Borg Cube"==n.class||"Vidiian Battle Cruiser"==n.class||"Hirogen Warship"==n.class||"Romulan Drone Ship"==n.class||"Type 7 Shuttlecraft"==n.class||"Oberth class"==n.class||"Terran NX Class"==n.class||"Krenim Weapon Ship"==n.class||"Prometheus Class"==n.class||"Olympic Class"==n.class||"Dauntless Class"==n.class||"Ferengi Shuttle"==n.class||"Delta Flyer Class Shuttlecraft"==n.class||"Scorpion Class Attack Squadron"==n.class||"Cardassian ATR-4107"==n.class||"Bajoran Solar Sailor"==n.class||"Xindi Insectoid Starship"==n.class||"Xindi Aquatic Cruiser"==n.class||"Xindi Reptilian Warship"==n.class||"Andorian Battle Cruiser"==n.class||"Xindi Weapon"==n.class?u(t,n,e,a)+2:a}}}},"weapon:W227":{canEquip:function(t,n,e){return"Prometheus Class"==n.class&&a("Multi-Vector Assault Mode")}},"tech:T277":{canEquip:function(t,n,e){return"Prometheus Class"==n.class&&a("Ablative Hull Armor")}},"tech:T278":{canEquip:function(t,n,e){return"Prometheus Class"==n.class&&a("Regenerative Shields")},intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"tech:T279":{intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"tech:T280":{intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a},cost:function(t,n,e,a){return!n||l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)?a:u(t,n,e,a)+1}}}},"question:Q023":{canEquip:a("EMH Mark I"),isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("crew",t)}},"crew:C389":{canEquipFaction:function(t,n,e){return l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)}},"starship_construction:Con001":{canEquipConstruction:function(t,n,e){return n.name.startsWith("U.S.S. ")&&n.name.replace("U.S.S. ","")==n.class.replace(/ [Cc]lass/,"")},upgradeSlots:[{type:["tech","weapon","crew"]}]},"captain:Cap014":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"federation",n,e)?0:1},intercept:{ship:{factionPenalty:function(t,n,e,a){return"crew"==t.type&&l(t,"romulan",n,e)&&l(n,"federation",n,e)?0:a}}}},"crew:C380":{upgradeSlots:[{type:["crew"]}]},"crew:C383":{intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"romulan",n,e)?u(t,n,e,a)+2:a}}}},"crew:C384":{upgradeSlots:[{type:["tech"],rules:"May equip Romulan Cloaking Decice for 0 SP",canEquip:function(t){return"T276"==t.id},intercept:{ship:{cost:function(t,n,e,a){return s.match(t,n,n,e)?s.match(t,n,n,e)?0:a:1}}}}]},"crew:C385":{intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+(l(t,"romulan",n,e)?3:1):a}}}},"talent:E210":{canEquipFaction:function(t,n,e){return l(n.captain,"romulan",n,e)}},"talent:E211":{canEquip:a("Outflank")},"talent:E212":{canEquipFaction:function(t,n,e){return l(n,"romulan",n,e)&&l(n.captain,"romulan",n,e)}},"weapon:W218":{canEquip:function(t,n,e){return"Reman Warbird"==n.class}},"weapon:W219":{canEquip:a("Aft Disruptor Emitters"),intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"romulan",n,e)?u(t,n,e,a)+2:a}}}},"weapon:W220":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"romulan",n,e)?u(t,n,e,a)+2:a}}}},"weapon:W221":{canEquipFaction:function(t,n,e){return l(n,"romulan",n,e)}},"tech:T274":{canEquip:function(t,n,e){return"Reman Warbird"==n.class}},"tech:T276":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"romulan",n,e)?u(t,n,e,a)+2:a},canEquip:function(t,n,e){return a("Romulan Cloaking Device")(t,n,e)}}}},"question:Q022":{canEquip:function(t,n,e){return a("Romulan Ale")(t,n,e)},isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"romulan",n,e)?u(t,n,e,a)+3:a}}},upgradeSlots:[{type:n}]},"talent:E208":{canEquipFaction:function(t,n,e){return n.captain&&("Kor"==n.captain.name||"Koloth"==n.captain.name||"Kang"==n.captain.name)},intercept:{fleet:{skill:function(t,n,e,a){return t!=n.captain||"Kor"!=t.name&&"Kang"!=t.name&&"Koloth"!=t.name?a:u(t,n,e,a)+1}}}},"captain:Cap004":{upgradeSlots:[{type:["talent"],rules:"Equip Dahar Master for 0 SP",intercept:{ship:{cost:function(t,n,e,a){return"Dahar Master"==t.name?0:a}}}}]},"ship:S336":{upgradeSlots:[{type:["tech"],rules:"Klingon Upgrade, 4 SP cost or less",canEquip:function(t){return"klingon"==t.factions&&t.cost<=4},intercept:{ship:{cost:function(){return 0}}}}]},"weapon:W217":{attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e):a}}},canEquipFaction:function(t,n,e){return n.hull<=3}},"weapon:W216":{attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e):a}}},canEquipFaction:function(t,n,e){return l(n,"klingon",n,e)}},"talent:E209":{canEquipFaction:function(t,n,e){return l(n.captain,"klingon",n,e)}},"tech:T273":{upgradeSlots:[{type:["tech"]}]},"ship:S342":{intercept:{ship:{cost:function(t,n,e,a){return(s.hasFaction(t,"federation",n,e)||s.hasFaction(t,"bajoran",n,e)||s.hasFaction(t,"vulcan",n,e))&&"weapon"==t.type?u(t,n,e,a)-1:a}}}},"captain:Cap008":{upgradeSlots:t(1,{type:["talent"],rules:"No Faction Penalty for Klingon Elite Talent",intercept:{ship:{factionPenalty:{priority:100,fn:function(t,n,e,a){return"klingon"==t.factions?0:a}}}}})},"weapon:W215":{upgradeSlots:[{type:["weapon"],rules:"Torpedo Upgrade with Printed Cost 5 or less.",faceDown:!0,canEquip:function(t){return"W204"==t.id||"W192"==t.id||"W191"==t.id||"W183"==t.id||"W177"==t.id||"W161"==t.id||"W160"==t.id||"W158"==t.id||"W157"==t.id||"W008"==t.id||"W004"==t.id||"W003"==t.id||"W002"==t.id||"W009"==t.id||"W154"==t.id||"W152"==t.id||"W145"==t.id||"W142"==t.id||"W141"==t.id||"W137"==t.id||"W128"==t.id||"W122"==t.id||"W120"==t.id||"W119"==t.id||"W118"==t.id||"W117"==t.id||"W116"==t.id||"W114"==t.id||"W112"==t.id||"W105"==t.id||"W100"==t.id||"W088"==t.id||"W082"==t.id||"W081"==t.id||"W079"==t.id||"W078"==t.id||"W074"==t.id||"W072"==t.id||"W067"==t.id||"W059"==t.id||"W050"==t.id||"W039"==t.id||"W038"==t.id||"W031"==t.id||"W195"==t.id||"W016"==t.id||"W119"==t.id||"W226"==t.id||"W224"==t.id},intercept:{ship:{canEquip:function(t,n,e){return p(t,"cost",n,e)<=6},free:function(){return!0},factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"klingon",n,e)||s.hasFaction(n,"romulan",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)||s.hasFaction(n,"dominion",n,e)||s.hasFaction(n,"borg",n,e)||s.hasFaction(n,"independent",n,e)||s.hasFaction(n,"ferengi",n,e)||s.hasFaction(n,"xindi",n,e)||s.hasFaction(n,"kazon",n,e)||s.hasFaction(n,"mirror-universe",n,e)||s.hasFaction(n,"species-8472",n,e)?0:1}}}}]},"tech:T271":{canEquip:function(t,n,e){return 0<=n.class.indexOf("Defiant Class")}},"tech:T270":{canEquipFaction:function(t,n,e){return l(n,"federation",n,e)&&5<=n.hull},intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+2:a}}}},"weapon:W214":{canEquip:function(t,n,e){return 0<=n.class.indexOf("Akira Class")}},"weapon:W213":{canEquip:function(t,n,e){return 0<=n.class.indexOf("Defiant Class")}},"crew:C372":{upgradeSlots:[{type:["crew"]}]},"weapon:W204":{attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e)+1:a}}}},"talent:E202":{canEquip:a("Battle-Hardened")},"talent:E200":{canEquip:a("Calculating")},"weapon:W201":{canEquip:a("Full Spread")},"weapon:W207":{canEquip:a("Enhanced Targeting")},"weapon:W205":{canEquip:a("Overcharged Phasers")},"weapon:W203":{canEquip:a("Dorsal Phaser Array")},"tech:T255":{canEquip:a("Detection Grid")},"tech:T253":{canEquip:a("Reinforced Shielding")},"crew:C362":{canEquip:a("Commander")},"crew:C360":{canEquip:a("Tactical Officer")},"crew:C361":{canEquip:a("Helmsman")},"crew:C358":{canEquip:a("Science Officer")},"crew:C359":{canEquip:a("Operations Officer")},"captain:Cap118":{intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"captain:Cap119":{intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"captain:Cap121":{upgradeSlots:[{},{type:["tech","weapon","crew"]}],intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"captain:Cap122":{upgradeSlots:[{},{type:["tech","weapon","crew"]}],intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"captain:Cap123":{upgradeSlots:[{},{},{type:["tech","weapon","crew"]}],intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"captain:Cap124":{upgradeSlots:[{},{},{type:["tech","weapon","crew"]}],intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"captain:Cap125":{upgradeSlots:[{},{},{type:["tech","weapon","crew"]},{type:["tech","weapon","crew"]}],intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"captain:Cap126":{upgradeSlots:[{},{},{type:["tech","weapon","crew"]},{type:["tech","weapon","crew"]}],intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"captain:Cap127":{upgradeSlots:[{},{},{},{type:["tech","weapon","crew"]},{type:["tech","weapon","crew"]}],intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"captain:Cap128":{upgradeSlots:[{},{},{},{type:["tech","weapon","crew"]},{type:["tech","weapon","crew"]}],intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&(i=30),u(t,n,e,a)-i}}}},"tech:T253":{canEquip:a("Reinforced Shielding"),intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+2:a}}}},"weapon:W120":{intercept:{self:{attack:function(t,n,e,a){return n&&"Vor'cha Class"==n.class?u(t,n,e,a)+1:a}}}},"captain:Cap641":{intercept:{ship:{cost:function(t,n,e,a){var i=a;return i=c("weapon",t,n)?u(t,n,e,a)-1:i}}}},"weapon:W111":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Breen")<0?u(t,n,e,a)+5:a}}}},"weapon:W114":{intercept:{self:{attack:function(t,n,e,a){return n&&"Negh'var Class"==n.class?u(t,n,e,a)+1:a}}}},"crew:C193":{intercept:{self:{cost:function(t,n,e,a){return n&&"Romulan Science Vessel"!=n.class?u(t,n,e,a)+5:a}}}},"tech:T247":{canEquip:function(t,n,e){return"Romulan Science Vessel"==n.class}},"captain:Cap644":{intercept:{ship:{cost:function(t,n,e,a){return c("crew",t,n)?u(t,n,e,a)-1:a}}}},"captain:Cap905":{upgradeSlots:t(2,{type:["talent"],rules:"Fed Talents Cost Exactly 3 SP",faceDown:!0,intercept:{ship:{cost:function(t,n,e,a){return l(t,"federation",n,e)||l(t,"bajoran",n,e)||l(t,"vulcan",n,e)?3:a}}}})},"captain:Cap814":{intercept:{ship:{factionPenalty:function(t,n,e,a){return r(t)?0:a}}}},"captain:Cap645":{intercept:{ship:{factionPenalty:function(t,n,e,a){return"captain"==t.type||"talent"==t.type?0:a}}}},"captain:Cap325":{intercept:{ship:{cost:function(t,a,i,n){var r=!1,c=0;return $.each(o("upgradeSlots")(a),function(t,n){var e;n.occupant&&s.hasFaction(n.occupant,"dominion",a,i)&&(e=u(n.occupant,a,i,n.occupant.cost),c<e)&&(r=n.occupant,c=e)}),n=t==r?c-2:n}}}},"tech:T236":{canEquip:function(t,n,e){return n&&0<=n.class.indexOf("Jem'Hadar")}},"weapon:W103":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Jem'Hadar")<0?u(t,n,e,a)+5:a}}}},"crew:C178":{canEquip:function(t,n,e){return n&&0<=n.class.indexOf("Jem'Hadar")}},"crew:C177":{canEquip:function(t,n,e){return n&&0<=n.class.indexOf("Jem'Hadar")}},"crew:C176":{canEquip:function(t,n,e){return n&&0<=n.class.indexOf("Jem'Hadar")}},"tech:T240":{intercept:{self:{cost:function(t,n,e,a){return n&&"U.S.S. Defiant"!=n.name?u(t,n,e,a)+5:a}}}},"weapon:W102":{intercept:{self:{attack:function(t,n,e,a){return n&&0<=n.class.indexOf("Keldon Class")?u(t,n,e,a)+1:a}}}},"tech:T233":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Keldon Class")<0?u(t,n,e,a)+5:a}}}},"captain:Cap323":{upgradeSlots:[{type:["tech"]}]},"talent:E111":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"klingon",n,e)}},"tech:T225":{canEquip:function(t,n,e){return"Raptor Class"==n.class}},"tech:T224":{canEquip:function(t,n,e){return"Raptor Class"==n.class}},"captain:Cap717":{upgradeSlots:[{}].concat(t(2,{type:["crew"],rules:"-1 SP if Dominion",intercept:{ship:{cost:function(t,n,e,a){return s.hasFaction(t,"dominion",n,e)?u(t,n,e,a)-1:a}}}}))},"crew:C159":{canEquip:function(t,n,e){return n&&0<=n.class.indexOf("Jem'Hadar")}},"crew:C157":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Jem'Hadar")<0?u(t,n,e,a)+5:a}}}},"weapon:W097":{intercept:{self:{attack:function(t,n,e,a){return n&&"Jem'Hadar Battleship"==n.class?u(t,n,e,a)+2:a}}}},"weapon:W096":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Jem'Hadar")<0?u(t,n,e,a)+5:a}}}},"question:Q024":{canEquip:a("EMH Mark I"),isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("crew",t)}},"tech:T228":{upgradeSlots:[{type:["weapon"]},{type:["weapon"]}]},"captain:Cap524":{upgradeSlots:[{},{type:["tech"],rules:"Costs exactly 3 SP",faceDown:!0,canEquip:function(t,n,e){return!(t.text.includes("may only be purchased for the U.S.S. Voyager.")||t.text.includes("Galor or Keldon Class Only")||t.text.includes("This Upgrade may only be purchased for a Species 8472 ship"))&&("T272"==t.id||"T254"==t.id||"T252"==t.id||"T223"==t.id||"T094"==t.id||"T091"==t.id||"T054"==t.id||"T045"==t.id||"T258"==t.id||"T256"==t.id||"T260"==t.id||"T269"==t.id||"T182"==t.id||"T181"==t.id||"T175"==t.id||"T172"==t.id||"T171"==t.id||"T150"==t.id||"T138"==t.id||"T136"==t.id||"127"==t.id||"T103"==t.id||"T102"==t.id||"T238"==t.id||"T237"==t.id||"T232"==t.id||"T230"==t.id||"T212"==t.id||"T208"==t.id||"T204"==t.id||"T200"==t.id||"T088"==t.id||"T087"==t.id||"T086"==t.id||"T033"==t.id||"T031"==t.id||"T027"==t.id||"T015"==t.id||"T002"==t.id||"T280"==t.id||"T279"==t.id||"T255"==t.id||"T253"==t.id||"T268"==t.id||"T267"==t.id||"T180"==t.id||"T178"==t.id||"T167"==t.id||"T164"==t.id||"T162"==t.id||"T161"==t.id||"T157"==t.id||"T156"==t.id||"T153"==t.id||"T151"==t.id||"T146"==t.id||"T130"==t.id||"T129"==t.id||"T122"==t.id||"T118"==t.id||"T106"==t.id||"T101"==t.id||"T100"==t.id||"T249"==t.id||"T248"==t.id||"T242"==t.id||"T241"==t.id||"T239"==t.id||"T234"==t.id||"T231"==t.id||"T214"==t.id||"T202"==t.id||"T084"==t.id||"T083"==t.id||"T077"==t.id||"T076"==t.id||"T074"==t.id||"T071"==t.id||"T069"==t.id||"T066"==t.id||"T052"==t.id||"T030"==t.id||"T026"==t.id||"T019"==t.id||"T016"==t.id||"T004"==t.id||void 0)},intercept:{ship:{cost:function(t,n,e,a){return s.match(t,n,n,e)?s.match(t,n,n,e)?3:a:4}}}}]},"weapon:W094":{canEquip:function(t,n,e){return s.hasFaction(n,"borg",n,e)}},"crew:C152":{canEquip:function(t,n,e){return s.hasFaction(n,"kazon",n,e)}},"tech:T217":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"kazon",n,e)?u(t,n,e,a)+5:a}}}},"tech:T221":{canEquip:function(t,n,e){return s.hasFaction(n,"species-8472",n,e)}},"tech:T219":{canEquip:function(t,n,e){return s.hasFaction(n,"species-8472",n,e)}},"tech:T216":{canEquip:function(t,n,e){return s.hasFaction(n,"species-8472",n,e)}},"talent:E104":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"species-8472",n,e)?u(t,n,e,a)+5:a}}}},"weapon:W095":{canEquip:function(t,n,e){return s.hasFaction(n,"species-8472",n,e)}},"weapon:W093":{intercept:{self:{attack:function(t,n,e,a){return n&&"Species 8472 Bioship"==n.class?u(t,n,e,a)+2:a}}}},"weapon:W092":{canEquip:function(t,n,e){return s.hasFaction(n,"species-8472",n,e)}},"tech:T222":{canEquip:function(t,n,e){return"U.S.S. Voyager"==n.name}},"crew:C154":{name:"B'Elanna Torres",upgradeSlots:[{type:["weapon"]},{type:["tech"]}]},"question:Q025":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("crew",t)}},"weapon:W090":{canEquip:function(t,n,e){return"U.S.S. Voyager"==n.name}},"talent:E103":{canEquipFaction:function(t,n,e){return n.captain&&("Loskene"==n.captain.name||0<=n.captain.name.indexOf("Tholian"))}},"weapon:W089":{canEquip:function(t,n,e){return"Tholian Vessel"==n.class}},"captain:Cap322":{upgradeSlots:[{type:["crew"]}]},"talent:E101":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n,"vulcan",n,e)&&s.hasFaction(n.captain,"vulcan",n,e)},upgradeSlots:t(2,{type:["tech","crew"]})},"tech:T212":{canEquip:function(t,n,e){return!!(n&&n.classData&&n.classData.maneuvers&&n.classData.maneuvers.max)&&n.classData.maneuvers.max<4}},"tech:T211":{intercept:{self:{cost:function(t,n,e,a){return n&&"Bajoran Interceptor"!=n.class?u(t,n,e,a)+5:a}}}},"weapon:W085":{canEquip:function(t,n,e){return n.hull<=3},intercept:{self:{cost:function(t,n,e,a){return n&&"Bajoran Interceptor"!=n.class?u(t,n,e,a)+5:a}}}},"ship:S139":{intercept:{ship:{cost:function(t,n,e,a){return"Borg Ablative Hull Armor"==t.name?u(t,n,e,a)-3:a}}}},"talent:E099":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"borg",n,e)}},"weapon:W084":{intercept:{self:{attack:function(t,n,e,a){return n&&"Borg Tactical Cube"==n.class?u(t,n,e,a)+3:a}}}},"weapon:W083":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"borg",n,e)}},"talent:E093":{canEquip:function(t,n,e){return n.hull<=3}},"tech:T204":{canEquip:a("Ion Thrusters")},"crew:C134":{upgradeSlots:[{type:["weapon"]}],intercept:{ship:{cost:{priority:100,fn:function(t,n,e,a){return c("weapon",t,n)&&"Torpedo Fusillade"!=t.name&&"W057"!=t.id&&"Aft Phaser Emitters"!=t.name&&"W156"!=t.id&&"W199"!=t.id&&"W223"!=t.id&&(a=u(t,n,e,a))<=5&&(a-=2),a}}}}},"captain:Cap522":{intercept:{ship:{cost:function(t,n,e,a){return(s.hasFaction(t,"federation",n,e)||s.hasFaction(t,"bajoran",n,e)||s.hasFaction(t,"vulcan",n,e))&&"tech"==t.type?u(t,n,e,a)-2:a}}}},"tech:T201":{canEquip:function(t,n,e){return"Suurok Class"==n.class},intercept:{ship:{attack:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a},hull:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"talent:E087":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"dominion",n,e)}},"weapon:W075":{canEquip:function(t,n,e){return"Jem'Hadar Battleship"==n.class||"Jem'Hadar Battleship "==n.class||"Jem'Hadar Battle Cruiser"==n.class}},"talent:E090":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)}},"captain:Cap424":{intercept:{ship:{cost:function(t,n,e,a){return c("crew",t,n)?u(t,n,e,a)-1:a},factionPenalty:function(t,n,e,a){return r(t)&&s.hasFaction(t,"borg",n,e)?0:a}}}},"captain:Cap711":{upgradeSlots:[{},{type:["crew"]}],intercept:{ship:{canEquipFaction:{priority:100,fn:function(t,n,e,a){return"talent"==t.type||a}},factionPenalty:{priority:100,fn:function(t,n,e,a){return"talent"==t.type?0:a}}}}},"talent:E088":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"borg",n,e)}},"borg:B012":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"borg",n,e)}},"weapon:W077":{intercept:{self:{attack:function(t,n,e,a){return n&&s.hasFaction(n,"borg",n,e)?u(t,n,e,a)+1:a}}}},"weapon:W076":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"borg",n,e)?u(t,n,e,a)+5:a}}}},"tech:T099":{name:"Multi-Adaptive Shields",canEquipFaction:function(t,n,e){return s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)}},"tech:T098":{intercept:{self:{cost:function(t,n,e,a){return n&&"U.S.S. Raven"!=n.name?u(t,n,e,a)+5:a}}}},"crew:C110":{upgradeSlots:[{type:["tech"]}]},"crew:C114":{text:"At the start of the game, place 1 non-Borg [tech] or [weapon] Upgrade with a cost of 5 or less face down beneath this card. At any time, you may discard Quark to flip the Upgrade that is beneath this card face up and deploy it to your ship, even if it exceeds your ship's restrictions.",upgradeSlots:[{type:["weapon","tech"],rules:"Non-Borg, 5SP or less",faceDown:!0,intercept:{ship:{canEquip:function(t,n,e){return p(t,"cost",n,e)<=5},canEquipFaction:function(t,n,e){return!s.hasFaction(t,"borg",n,e)},free:function(){return!0}}}}]},"crew:C109":{upgradeSlots:[{type:["talent"],rules:"No Faction Penalty",intercept:{ship:{factionPenalty:function(){return 0}}}}],factionPenalty:0},"ship:S106":{class:"Galaxy Class",classId:"galaxy__class_mu"},"ship:S107":{class:"Galaxy Class",classId:"galaxy__class_mu"},"ship:S108":{class:"Galaxy Class",classId:"galaxy__class_mu"},"ship:S105":{class:"Galaxy Class",classId:"galaxy__class_mu"},"weapon:W070":{intercept:{self:{cost:function(t,n,e,a){return n&&"Galaxy Class"!=n.class&&"Intrepid Class"!=n.class&&"Sovereign Class"!=n.class?u(t,n,e,a)+5:a}}}},"captain:Cap629":{upgradeSlots:[{},{type:["crew"]}]},"weapon:W170":{upgradeSlots:[{type:["weapon"]}]},"captain:Cap630":{upgradeSlots:[{},{type:["crew"]}]},"crew:C101":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"vulcan",n,e)}},"tech:T095":{upgradeSlots:[{type:["weapon"]}],canEquip:function(t,n,e){return"Suurok Class"==n.class&&a("Combat Vessel Variant")(t,n,e)},intercept:{ship:{attack:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a},hull:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a},canEquip:function(t,n,e){return"Combat Vessel Variant"!=t.name}}}},"ship:S115":{upgradeSlots:[{type:["tech"],rules:"Free EHP Only",canEquip:function(t){return"Enhanced Hull Plating"==t.name},intercept:{ship:{cost:function(){return 0}}}}]},"captain:Cap521":{upgradeSlots:[{},{type:["crew"]}]},"tech:T096":{canEquip:a("Enhanced Hull Plating"),canEquipFaction:function(t,n,e){return s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)}},"crew:C107":{upgradeSlots:[{type:["tech"]}]},"ship:S113":{intercept:{ship:{canEquip:function(t,n,e,a){return!(c("borg",t,n)&&5<p(t,"cost",n,e))&&a}}}},"ship:S111":{intercept:{ship:{canEquip:function(t,n,e,a){return!(c("borg",t,n)&&5<p(t,"cost",n,e))&&a}}}},"captain:Cap317":{canEquip:function(t,n,e){return!o("fleetCardNamed")(e,"Hugh")},intercept:{fleet:{canEquip:function(t,n,e,a){return"Hugh"!=t.name&&a},canEquipCaptain:function(t,n,e,a){return"Hugh"!=t.name&&a}}}},"crew:C100":{canEquip:function(t,n,e){return!o("fleetCardNamed")(e,"Hugh")},intercept:{fleet:{canEquip:function(t,n,e,a){return"Hugh"!=t.name&&a},canEquipCaptain:function(t,n,e,a){return"Hugh"!=t.name&&a}}}},"borg:B011":{canEquip:a("Scavenged Parts")},"weapon:W071":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"borg")}},"tech:T090":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"ferengi",n,e)}},"talen:E080":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"ferengi",n,e)&&s.hasFaction(n,"ferengi",n,e)}},"tech:T089":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"mirror-universe",n,e)?u(t,n,e,a)+5:a}}}},"captain:Cap315":{upgradeSlots:[{type:["weapon"]}],intercept:{ship:{cost:function(t,n,e,a){return c("weapon",t,n)&&s.hasFaction(t,"kazon",n,e)?u(t,n,e,a)-1:a}}}},"tech:T088":{canEquip:a("Tractor Beam")},"weapon:W064":{intercept:{self:{cost:function(t,n,e,a){return"Predator Class"!=n.class?u(t,n,e,a)+4:a}}}},"ship:S099":{intercept:{ship:{canEquip:function(t,n,e,a){return!(c("borg",t,n)&&5<p(t,"cost",n,e))&&a}}}},"weapon:W062":{name:"Proton Beam",intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"borg",n,e)?u(t,n,e,a)+5:a}}}},"talent:E079":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"vulcan",n,e)&&s.hasFaction(n,"vulcan",n,e)}},"borg:B007":{canEquip:a("Hive Mind")},"talent:E078":{canEquipFaction:function(t,n,e){return n.captain&&!s.hasFaction(n.captain,"borg",n,e)&&!s.hasFaction(n,"borg",n,e)},upgradeSlots:[{type:["borg"]}]},"captain:Cap807":{upgradeSlots:[{},{type:["crew","tech","weapon","talent"]}]},"tech:T085":{canEquip:a("Advanced Shields")},"crew:C089":{upgradeSlots:[{type:["crew"]}]},"crew:C088":{upgradeSlots:[{type:["tech"]}]},"weapon:W058":{intercept:{self:{attack:function(t,n,e,a){return n&&"Sovereign Class"==n.class?u(t,n,e,a)+1:a}}}},"weapon:W057":{attack:0,canEquip:function(t,n,e){return n&&(s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e))&&4<=n.hull},intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e):a},cost:function(t,n,e,a){return n?u(t,n,e,a)+p(n,"attack",n,e)+1:a}}}},"borg:B006":{canEquip:a("Transwarp Signal"),canEquipFaction:function(t,n,e){return s.hasFaction(n,"borg",n,e)}},"borg:B005":{canEquip:a("Borg Shield Matrix")},"weapon:W056":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"borg",n,e)?u(t,n,e,a)+5:a}}}},"captain:Cap518":{upgradeSlots:[{type:["tech","weapon","crew"]}],intercept:{ship:{cost:function(t,n,e,a){return(s.hasFaction(n,"independent",n,e)||s.hasFaction(n,"ferengi",n,e)||s.hasFaction(n,"kazon",n,e)||s.hasFaction(n,"xindi",n,e))&&r(t)?u(t,n,e,a)-1:a}}}},"captain:Cap626":{upgradeSlots:[{},{type:["weapon","crew"]}]},"weapon:W060":{canEquip:function(t,n,e){return n.hull<=3}},"ship:S087":{canJoinFleet:function(t,n,e){var a=!0;return $.each(e.ships,function(t,n){if("Assimilated Vessel 80279"==n.name)return a=!1}),a},intercept:{fleet:{canJoinFleet:function(t,n,e){return"Assimilated Vessel 80279"!=t.name}}}},"borg:T083":{canEquip:a("Data Node")},"talent:E071":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"klingon",n,e)}},"talent:E063":{upgradeSlots:t(4,{type:["talent"],rules:"Romulan Talent Only",faceDown:!0,intercept:{ship:{cost:function(){return 0},factionPenalty:function(){return 0},canEquip:function(t,n,e,a){return!!s.hasFaction(t,"romulan",n,e)&&a}}}}),canEquip:function(t,n,e){return n.captain&&"Shinzon"==n.captain.name},factionPenalty:0},"tech:T080":{canEquip:function(t,n,e){return"Reman Warbird"==n.class}},"tech:T079":{intercept:{self:{cost:function(t,n,e,a){return n&&"Reman Warbird"!=n.class?u(t,n,e,a)+5:a}}}},"weapon:W054":{canEquip:function(t,n,e){return"Reman Warbird"==n.class}},"weapon:W053":{intercept:{self:{attack:function(t,n,e,a){return n&&"Reman Warbird"==n.class?u(t,n,e,a)+2:a}}}},"tech:T081":{canEquip:function(t,n,e){return"Klingon Bird-of-Prey"==n.class}},"talent:E068":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"klingon",n,e)}},"ship:S084":{class:"Defiant Class",classId:"defiant_class_mirror"},"ship:S080":{class:"Defiant Class",classId:"defiant_class_mirror"},"captain:Cap516":{upgradeSlots:[{},{type:["tech"]}]},"crew:C078":{upgradeSlots:[{type:["tech"]}]},"captain:Cap902":{upgradeSlots:[{},{type:["borg"]}]},"borg:E070":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"borg",n,e)?u(t,n,e,a)+5:a}}}},"borg:B002":{canEquip:a("Interplexing Beacon")},"ship:S070":{canJoinFleet:function(t,n,e){var a=!0;return $.each(e.ships,function(t,n){if("Assimilated Vessel 64758"==n.name)return a=!1}),a},intercept:{fleet:{canJoinFleet:function(t,n,e){return"Assimilated Vessel 64758"!=t.name}}}},"talent:E060":{intercept:{self:{cost:function(t,n,e,a){return n&&n.captain&&5<n.captain.skill?u(t,n,e,a)+5:a}}}},"captain:Cap901":{canEquipCaptain:function(t,n,e){return!o("fleetCardNamed")(e,"Jean-Luc Picard")},intercept:{fleet:{canEquip:function(t,n,e,a){return"Jean-Luc Picard"!=t.name&&a},canEquipCaptain:function(t,n,e,a){return"Jean-Luc Picard"!=t.name&&a}}}},"squadron:D016":{canEquip:a("Cover Fire")},"squadron:D015":{canEquip:a("Flanking Attack")},"squadron:D013":{canEquip:a("Support Ship")},"squadron:D011":{canEquip:a("Aft Disruptor Wave Cannons")},"squadron:D010":{canEquip:a("Galor Class Phaser Banks")},"ship:S067":{class:"Negh'var Class",classId:"negh_var_class_mirror"},"ship:S066":{class:"Negh'var Class",classId:"negh_var_class_mirror"},"crew:C067":{intercept:{ship:{skill:function(t,n,e,a){return a=t==n.captain&&s.hasFaction(n,"mirror-universe",n,e)?u(t,n,e,a)+2:a}}}},"tech:T078":{intercept:{self:{cost:function(t,n,e,a){return n&&"Regent's Flagship"!=n.name?u(t,n,e,a)+5:a}}}},"weapon:W050":{intercept:{self:{attack:function(t,n,e,a){return n&&"Negh'var Class"==n.class?u(t,n,e,a)+1:a}}}},"weapon:W052":{canEquip:function(t,n,e){return 0<=n.class.indexOf("Vidiian")}},"crew:C063":{talents:1,factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"klingon",n,e)?0:1},upgradeSlots:[{type:["talent"]}]},"tech:T069":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"klingon",n,e)?0:1}},"weapon:W047":{canEquip:a("Phaser Array Retrofit")},"tech:T076":{canEquip:a("Monotanium Armor Plating")},"tech:T075":{canEquip:function(t,n,e){return 0<=n.class.indexOf("Hirogen")}},"talent:E056":{canEquip:function(t,n,e){return 0<=n.class.indexOf("Hirogen")},intercept:{self:{cost:function(t,n,e,a){return n&&n.captain&&"Karr"!=n.captain.name&&n.captain.name.indexOf("Hirogen")<0?u(t,n,e,a)+5:a}}}},"weapon:W049":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Hirogen")<0?u(t,n,e,a)+5:a}}}},"crew:C062":{upgradeSlots:[{type:["weapon"]}]},"squadron:D009":{canEquip:a("Defensive Maneuvers")},"squadron:D008":{canEquip:a("Support Ship")},"squadron:D006":{canEquip:a("Attack Wave")},"squadron:D004":{canEquip:a("Attack Formation")},"squadron:D002":{canEquip:a("Cover Fire")},"squadron:D001":{canEquip:a("Coordinated Attack")},"ship:S061":{intercept:{ship:{canEquipCaptain:function(t,n,e){return"Gareb"==t.name||"Jhamel"==t.name||"Romulan Drone Pilot"==t.name}}}},"ship:S266":{intercept:{ship:{canEquipCaptain:function(t,n,e){return"Gareb"==t.name||"Jhamel"==t.name||"Romulan Drone Pilot"==t.name}}}},"captain:Cap105":{upgradeSlots:[{type:["captain"],rules:"Captain to place under Gareb",intercept:{ship:{cost:function(){return 0},onEquip:function(t,n,e){t.upgradeSlots=[];for(var a=0;a<t.talents;a++)t.upgradeSlots.push({type:["talent"],source:"Gareb"});t.unique=!1,t.text="(Place underneath Gareb)",t.name=t.name+" (Gareb)"},canEquip:function(){return!0},canEquipFaction:function(){return!0},factionPenalty:function(){return 0}}}}],skill:function(t,n,e){return t.upgradeSlots[0].occupant?t.upgradeSlots[0].occupant.skill:0},cost:function(t,n,e){var a=0;return a=t.upgradeSlots[0].occupant?t.upgradeSlots[0].occupant.cost-3:a},canEquipCaptain:function(t,n,e){return"Romulan Drone Ship"==n.class}},"captain:Cap104":{canEquipCaptain:function(t,n,e){return"Romulan Drone Ship"==n.class}},"captain:Cap621":{upgradeSlots:[{},{type:["tech"]}]},"tech:T074":{intercept:{self:{cost:function(t,n,e,a){return n&&"Romulan Drone Ship"!=n.class?u(t,n,e,a)+5:a}}}},"tech:T073":{canEquip:function(t,n,e){return"Romulan Drone Ship"==n.class}},"tech:T072":{canEquip:function(t,n,e){return"Romulan Drone Ship"==n.class}},"weapon:T071":{name:"Triphasic Emitters",range:!1,upgradeSlots:[{type:["weapon"],rules:"Non-Borg, 5SP or less",intercept:{ship:{free:function(){return!0},canEquip:function(t,n,e,a){return!(0==t.printedValue||l(t,"borg",n,e)||5<p(t,"cost",n,e))&&a}}}}]},"talent:E051":{canEquipFaction:function(t,n,e){return 0<=n.class.indexOf("Tholian")&&n.captain&&("Loskene"==n.captain.name||0<=n.captain.name.indexOf("Tholian"))}},"weapon:W045":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Tholian")<0?u(t,n,e,a)+5:a}}}},"captain:Cap618":{canEquipCaptain:function(t,n,e){return s.hasFaction(n,"romulan",n,e)}},"admiral:A017":{canEquipAdmiral:function(t,n,e){return s.hasFaction(n,"romulan",n,e)}},"crew:C059":{canEquip:a("Romulan Helmsman")},"talent:E049":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"romulan",n,e)&&n.captain&&s.hasFaction(n.captain,"romulan",n,e)}},"crew:C057":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"romulan",n,e)}},"crew:C058":{intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+1:a}}}},"weapon:W044":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"romulan",n,e)?u(t,n,e,a)+5:a}}}},"crew:C061":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"kazon",n,e)}},"crew:C060":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"kazon",n,e)}},"talent:T058":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)}},"tech:T057":{type:"question",isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},upgradeSlots:[{type:["tech"]}],intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}},canEquip:a("Systems Upgrade"),canEquipFaction:function(t,n,e){return s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)}},"weapon:W034":{canEquip:function(t,n,e){return n.attack<=3&&a("Type 8 Phaser Array")(t,n,e)}},"talent:E046":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"dominion",n,e)}},"weapon:W041":{canEquip:function(t,n,e){return 4<=n.hull},canEquipFaction:function(t,n,e){return s.hasFaction(n,"dominion",n,e)}},"captain:Cap312":{upgradeSlots:[{type:["talent"],rules:"Salvage Only",canEquip:function(t){return"Salvage"==t.name}}]},"tech:T068":{canEquip:function(t,n,e){return n.hull<=3&&a("Improved Deflector Screens")(t,n,e)}},"weapon:W042":{intercept:{self:{cost:function(t,n,e,a){return n&&"Gorn Raider"!=n.class?u(t,n,e,a)+4:a}}}},"crew:C051":{cost:function(a,i,r){var c;return i&&(c=0,$.each(o("upgradeSlots")(i),function(t,n){if(n.occupant&&n.occupant!=a&&"talent"==n.occupant.type){var e=p(n.occupant,"cost",i,r);if(0<e)return n.occupant,c=e,!1}}),0<c)?2:3}},"tech:T066":{canEquip:function(t,n,e){return a("Agony Booth")(t,n,e)}},"talent:E045":{canEquip:function(t,n,e){return"I.S.S. Enterprise"==n.name}},"ship:S051":{upgradeSlots:[{type:["crew","tech"],rules:"This Upgrade costs -2 SP",intercept:{ship:{cost:function(t,n,e,a){return u(t,n,e,a)-2}}}}]},"tech:T065":{canEquip:function(t,n,e){return 0<=n.class.indexOf("Shuttlecraft")},canEquipFaction:function(t,n,e){return s.hasFaction(n,"federation",n,e)}},"tech:T064":{canEquip:function(t,n,e){return 0<=n.class.indexOf("Shuttlecraft")&&a("Warp Drive")(t,n,e)},canEquipFaction:function(t,n,e){return s.hasFaction(n,"federation",n,e)}},"ship:S047":{intercept:{ship:{cost:function(t,n,e,a){return c("tech",t,n)?u(t,n,e,a)-1:a}}}},"crew:C273":{intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+3:a}}}},"tech:T056":{canEquip:function(t,n,e){return n.hull<=3},canEquipFaction:function(t,n,e){return s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)}},"tech:T055":{intercept:{self:{cost:function(t,n,e,a){return n&&"Oberth Class"!=n.class?u(t,n,e,a)+5:a}}}},"crew:C044":{canEquipFaction:function(t,n,e){return l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)},canEquip:function(t,n,e){return n.hull<=3}},"crew:C043":{upgradeSlots:[{type:["tech"]}]},"captain:Cap415":{intercept:{ship:{factionPenalty:function(t,n,e,a){return r(t)?0:a}}}},"crew:C049":{canEquip:a("Orion Tactical Officer")},"crew:C048":{canEquip:a("Andorian Helmsman")},"tech:T062":{canEquip:a("Enhanced Hull Plating"),canEquipFaction:function(t,n,e){return s.hasFaction(n,"mirror-universe",n,e)&&n.hull<=4}},"captain:Cap805":{upgradeSlots:[{},{type:["tech"]}]},"talent:E042":{canEquipFaction:function(t,n,e){return"Krenim Weapon Ship"==n.class&&n.captain&&("Annorax"==n.captain.name||"Obrist"==n.captain.name||0<=n.captain.name.indexOf("Krenim"))}},"tech:T061":{canEquip:function(t,n,e){return"Krenim Weapon Ship"==n.class}},"tech:T060":{canEquip:function(t,n,e){return"Krenim Weapon Ship"==n.class}},"tech:T059":{canEquip:function(t,n,e){return"Krenim Weapon Ship"==n.class}},"weapon:W036":{intercept:{self:{cost:function(t,n,e,a){return n&&"Krenim Weapon Ship"!=n.class?u(t,n,e,a)+6:a}}}},"weapon:W035":{canEquip:function(t,n,e){return"Krenim Weapon Ship"==n.class}},"captain:Cap410":{upgradeSlots:[{type:["talent"],rules:"Mauk-to'Vor Only at 3SP",canEquip:function(t,n,e){return"Mauk-to'Vor"==t.name},intercept:{ship:{cost:function(){return 3}}}}],factionPenalty:function(){return 0}},"crew:C041":{canEquip:a("Klingon Stealth Team"),canEquipFaction:function(t,n,e){return s.hasFaction(n,"klingon",n,e)}},"talent:E039":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"klingon",n,e)&&s.hasFaction(n.captain,"klingon",n,e)}},"weapon:W033":{canEquip:a("Ambush Attack")},"captain:Cap804":{upgradeSlots:[{},{type:["crew"]}]},"crew:C038":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"klingon",n,e)}},"tech:T049":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"klingon",n,e)?u(t,n,e,a)+5:a}}}},"talent:E038":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)&&(!n.captain||s.hasFaction(n.captain,"klingon",n,e))},intercept:{ship:{canEquipCaptain:function(t,n,e){return s.hasFaction(t,"klingon",n,e)}}}},"captain:Cap207":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"bajoran",n,e)}},"admiral:A012":{canEquipAdmiral:function(t,n,e){return s.hasFaction(n,"bajoran",n,e)}},"captain:Cap616":{upgradeSlots:[{},{type:["crew"]}]},"tech:T053":{type:"question",isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},canEquip:function(t,n,e){return"Bajoran Scout Ship"==n.class&&a("Assault Vessel Upgrade")(t,n,e)},intercept:{ship:{attack:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a},shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"crew:C042":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"bajoran",n,e)}},"captain:Cap206":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)?0:1}},"question:Q026":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("crew",t)}},"crew:C039":{canEquip:function(t,e,a){var i;return!(e.captain&&!s.hasFaction(e.captain,"romulan",e,a))&&(i=!0,$.each(o("upgradeSlots")(e),function(t,n){n.occupant&&"crew"==n.occupant.type&&!s.hasFaction(n.occupant,"romulan",e,a)&&(i=!1)}),i)},intercept:{ship:{canEquip:function(t,n,e,a){return!("crew"==t.type&&!s.hasFaction(t,"romulan",n,e))&&a},canEquipCaptain:function(t,n,e,a){return!!s.hasFaction(t,"romulan",n,e)&&a},cost:function(t,n,e,a){return a="tech"!=t.type&&"weapon"!=t.type||s.hasFaction(t,"borg",n,e)?a:u(t,n,e,a)-1},factionPenalty:function(t,n,e,a){return"captain"==t.type||r(t)&&s.hasFaction(t,"romulan",n,e)?0:a}}}},"tech:T048":{intercept:{self:{cost:function(t,n,e,a){return n&&"U.S.S. Prometheus"!=n.name?u(t,n,e,a)+4:a}}},canEquip:a("Regenerative Shielding")},"tech:T047":{canEquip:function(t,n,e){return"Prometheus Class"==n.class}},"weapon:W031":{intercept:{self:{attack:function(t,n,e,a){return n&&"Prometheus Class"==n.class?u(t,n,e,a)+1:a}}}},"weapon:W030":{canEquip:function(t,n,e){return"Prometheus Class"==n.class&&a("Multi-Vector Assault Mode")}},"tech:T015":{canEquip:a("Inverse Tachyon Pulse")},"talent:E025":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"ferengi",n,e)&&s.hasFaction(n.captain,"ferengi",n,e)}},"talent:E024":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"ferengi",n,e)&&s.hasFaction(n.captain,"ferengi",n,e)}},"crew:C025":{canEquip:a("Tactical Officer")},"tech:T020":{canEquip:a("Ferengi Probe")},"captain:Cap306":{intercept:{self:{skill:function(t,n,e,a){return n&&"Dauntless Class"==n.class?u(t,n,e,a)+5:a}}}},"tech:T033":{skill:0,upgradeSlots:[{type:["tech"]}],intercept:{self:{skill:function(t,n,e,a){return n&&!n.captain?2:a}}}},"tech:T030":{intercept:{self:{cost:function(t,n,e,a){return n&&"Dauntless Class"!=n.class?u(t,n,e,a)+5:a}}}},"tech:T029":{canEquip:a("Navigational Deflector")},"tech:T028":{canEquip:function(t,n,e){return"Dauntless Class"==n.class}},"question:Q001":{type:"question",isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)||0<=$.inArray("talent",t)}},"weapon:W010":{canEquip:function(t,n,e){return"D'deridex Class"==n.class&&a("Additional Phaser Array")(t,n,e)}},"tech:T004":{intercept:{self:{cost:function(t,n,e,a){return n&&"D'deridex Class"!=n.class?u(t,n,e,a)+3:a}}}},"talent:E001":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"romulan",n,e)&&n.captain&&s.hasFaction(n.captain,"romulan",n,e)}},"crew:C002":{intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"romulan",n,e)?u(t,n,e,a)+2:a}}},canEquip:a("Bridge Officer")},"captain:Cap504":{upgradeSlots:[{type:["talent"],rules:"Klingon Talents Only",canEquip:function(t,n,e){return l(t,"klingon",n,e)}}],intercept:{ship:{cost:function(t,n,e,a){return a=r(t)&&l(t,"klingon",n,e)?u(t,n,e,a)-1:a},factionPenalty:function(t,n,e,a){return a=r(t)&&!l(t,"klingon",n,e)?2*u(t,n,e,a):a}}}},"talent:E002":{canEquipFaction:function(t,n,e){return l(n,"klingon",n,e)&&l(n.captain,"klingon",n,e)}},"crew:C004":{intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"klingon",n,e)?u(t,n,e,a)+3:a}}},canEquip:a("Tactical Officer")},"tech:T001":{upgradeSlots:t(2,{type:["crew"],rules:"Non-Borg, Combined cost 5 or less",faceDown:!0,canEquip:function(t,e,a,i){var r;return!l(t,"borg",e,a)&&(r=0,$.each(o("upgradeSlots")(e),function(t,n){i!=n&&n.occupant&&"Cryogenic Stasis"==n.source&&(r=p(n.occupant,"cost",e,a))}),r+p(t,"cost",e,a)<=5)},intercept:{ship:{free:function(){return!0}}}})},"talent:E005":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"federation",n,e)&&s.hasFaction(n.captain,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)&&s.hasFaction(n.captain,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)&&s.hasFaction(n.captain,"vulcan",n,e)}},"question:Q027":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("crew",t)||0<=$.inArray("weapon",t)}},"weapon:W025":{intercept:{self:{cost:function(t,n,e,a){return n&&"Intrepid Class"!=n.class?u(t,n,e,a)+4:a}}}},"tech:T042":{canEquip:function(t,n,e){return"Intrepid Class"==n.class&&a("Variable Geometry Pylons")(t,n,e)}},"ship:S013":{intercept:{ship:{factionPenalty:function(t,n,e,a){return"crew"==t.type||"tech"==t.type?0:a}}}},"captain:Cap201":{canEquipCaptain:function(t,n,e){return l(n,"ferengi",n,e)}},"admiral:A005":{canEquipAdmiral:function(t,n,e){return l(n,"ferengi",n,e)}},"captain:Cap404":{upgradeSlots:[{type:["talent"],rules:"Grand Nagus Only",canEquip:function(t){return"Grand Nagus"==t.name}}]},"talent:E015":{canEquipFaction:function(t,n,e){return l(n,"ferengi",n,e)&&l(n.captain,"ferengi",n,e)}},"tech:T013":{upgradeSlots:t(2,{type:["crew","tech"],rules:"Combined cost 4SP or less",canEquip:function(t,e,a,i){var r=0;return $.each(o("upgradeSlots")(e),function(t,n){i!=n&&n.occupant&&"Cargo Hold"==n.source&&(r=p(n.occupant,"cost",e,a))}),r+p(t,"cost",e,a)<=4}}),canEquip:function(t,n,e){return!!l(n,"ferengi",n,e)&&a("Cargo Hold")(t,n,e)}},"tech:T012":{canEquip:a("Inversion Wave")},"weapon:W024":{canEquip:function(t,n,e){return"Species 8472 Bioship"==n.class}},"weapon:W023":{canEquip:function(t,n,e){return"Species 8472 Bioship"==n.class}},"tech:T041":{canEquip:function(t,n,e){return"Species 8472 Bioship"==n.class&&a("Biological Technology")(t,n,e)}},"tech:T040":{canEquip:function(t,n,e){return"Species 8472 Bioship"==n.class&&a("Biogenic Field")(t,n,e)}},"tech:T039":{canEquip:function(t,n,e){return"Species 8472 Bioship"==n.class}},"tech:T038":{canEquip:a("Fluidic Space"),intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"species-8472",n,e)?u(t,n,e,a)+5:a}}}},"tech:T014":{canEquip:a("High Energy Sensor Sweep")},"weapon:W012":{upgradeSlots:t(2,{type:["weapon"]}),canEquip:a("Arsenal")},"question:Q002":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},intercept:{self:{cost:function(t,n,e,a){return!n||l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)?a:u(t,n,e,a)+5}}},canEquip:function(t,n,e){return(!n.classData||!n.classData.rearArc)&&4<=n.hull}},"weapon:W017":{canEquip:function(t,n,e){return!(n&&!l(n,"federation",n,e)&&!l(n,"bajoran",n,e)&&!l(n,"vulcan",n,e))&&a("Dual Phaser Banks")(t,n,e)},intercept:{self:{cost:function(t,n,e,a){return n&&"Constitution Class"!=n.class&&"Constitution Refit Class"!=n.class?u(t,n,e,a)+3:a}}}},"question:Q003":{isSlotCompatible:function(t){return 0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"federation",n,e)?u(t,n,e,a)+5:a}}},canEquip:function(t,n,e){return("Constitution Class"==n.class||"Constitution Refit Class"==n.class)&&a("Astrogator")(t,n,e)}},"captain:Cap303":{upgradeSlots:[{type:["talent"],rules:"Secret Research Only",canEquip:function(t,n,e){return"Secret Research"==t.name}}]},"talent:E009":{intercept:{self:{cost:function(t,n,e,a){return n&&"Romulan Science Vessel"!=n.class?u(t,n,e,a)+5:a}}}},"tech:T008":{canEquip:function(t,n,e){return n&&"Romulan Science Vessel"==n.class}},"tech:T007":{intercept:{self:{cost:function(t,n,e,a){return n&&"Romulan Science Vessel"!=n.class?u(t,n,e,a)+5:a}}}},"tech:T006":{intercept:{self:{cost:function(t,n,e,a){return n&&"Romulan Science Vessel"!=n.class?u(t,n,e,a)+5:a}}},canEquip:a("Signal Amplifier")},"tech:T010":{canEquip:a("Warp Core Ejection System")},"tech:T009":{canEquip:function(t,n,e){return n&&"Romulan Science Vessel"==n.class}},"captain:Cap701":{intercept:{ship:{cost:function(t,n,e,a){return r(t)&&l(t,"klingon",n,e)?u(t,n,e,a)-1:a}}}},"talent:E013":{canEquipFaction:function(t,n,e){return l(n,"klingon",n,e)&&l(n.captain,"klingon",n,e)}},"crew:C012":{intercept:{self:{factionPenalty:function(t,n,e,a){return l(n,"klingon",n,e)?0:a}}}},"crew:C013":{intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+(l(t,"klingon",n,e)?3:1):a}}}},"captain:Cap507":{upgradeSlots:[{type:["tech"],rules:"Costs -1 SP",intercept:{ship:{cost:function(t,n,e,a){return u(t,n,e,a)-1}}}}]},"tech:T027":{canEquip:a("Parametallic Hull Plating"),intercept:{self:{cost:function(t,n,e,a){return!n||l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)?a:u(t,n,e,a)+3}}}},"tech:T026":{canEquip:a("Immersion Shielding"),intercept:{self:{cost:function(t,n,e,a){return!n||l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)?a:u(t,n,e,a)+3}},ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"tech:T025":{canEquip:a("Unimatrix Shielding"),intercept:{self:{cost:function(t,n,e,a){return!n||l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)?a:u(t,n,e,a)+4}},ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+2:a}}}},"weapon:W019":{intercept:{self:{range:function(t,n,e,a){return n&&0<=n.class.indexOf("Shuttlecraft")?"1 - 2":a}}}},"crew:C217":{upgradeSlots:t(3,{type:["tech"],rules:"FEDERATION TECH UPGRADES, 4SP OR LESS",faceDown:!0,intercept:{ship:{cost:function(){return 0},factionPenalty:function(){return 0},canEquip:function(t,n,e,a){return console.log(!s.hasFaction(t,"federation",n,e),4<p(t,"cost",n,e)),!!(s.hasFaction(t,"federation",n,e)&&p(t,"cost",n,e)<5)&&a}}}})},"crew:C215":{intercept:{ship:{cost:{priority:100,fn:function(t,n,e,a){return c("tech",t,n)&&(a=u(t,n,e,a),--a),a}}}}},"tech:T104":{canEquip:function(t,n,e){return a("Navigational Station")(t,n,e)}},"crew:C228":{canEquip:function(t,n,e){return a("Kazon Gurad")(t,n,e)}},"question:Q004":{type:"question",isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},canEquipFaction:function(t,n,e){return console.log(n),!s.hasFaction(n,"borg",n,e)},canEquip:function(t,n,e){return a("Unremarkable Species")(t,n,e)},intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"kazon",n,e)?u(t,n,e,a)+5:a}}},upgradeSlots:[{type:n}]},"squadron:D023":{canEquip:function(t,n,e){return a("Cover Fire")(t,n,e)}},"squadron:D021":{canEquip:function(t,n,e){return a("Torpedo Attack")(t,n,e)}},"squadron:D018":{canEquip:function(t,n,e){return a("Support Ship")(t,n,e)}},"captain:Cap307":{upgradeSlots:[{type:["talent"],rules:"Tal Shiar Only",canEquip:function(t){return"Tal Shiar"==t.name}}]},"talent:E034":{canEquipFaction:function(t,n,e){return l(n.captain,"romulan",n,e)}},"captain:Cap205":{canEquipCaptain:function(t,n,e){return l(n,"species-8472",n,e)}},"weapon:W022":{canEquip:function(t,n,e){return!!l(n,"species-8472",n,e)&&a("Energy Weapon")(t,n,e)}},"tech:T037":{canEquip:function(t,n,e){return!!l(n,"species-8472",n,e)&&a("Neuro Peptides")(t,n,e)}},"tech:T036":{canEquip:function(t,n,e){return l(n,"species-8472",n,e)}},"tech:T035":{canEquip:function(t,n,e){return!!l(n,"species-8472",n,e)&&a("Resistant Hull")(t,n,e)}},"weapon:W029":{canEquip:a("Aft Weapons Array"),intercept:{self:{cost:function(t,n,e,a){return n&&"Cardassian Galor Class"!=n.class?u(t,n,e,a)+5:a}}}},"tech:T046":{canEquip:a("High Energy Subspace Field"),intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"dominion",n,e)?u(t,n,e,a)+5:a}}}},"weapon:W014":{canEquip:function(t,n,e){return!(3<p(n,"attack",n,e))&&a("Upgraded Phasers")(t,n,e)},intercept:{self:{cost:function(t,n,e,a){return!n||l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)?a:u(t,n,e,a)+5}}}},"tech:T002":{canEquip:a("Reactor Core")},"tech:T034":{canEquip:a("Targeting Systems")},"crew:C032":{intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"klingon",n,e)?u(t,n,e,a)+5:a}}}},"talent:E027":{canEquip:function(t,n,e){return p(n,"hull",n,e)<=3}},"crew:C027":{canEquip:function(t,n,e){return l(n,"federation",n,e)||l(n,"bajoran",n,e)||l(n,"vulcan",n,e)}},"weapon:W018":{canEquip:function(t,n,e){return p(n,"hull",n,e)<=3},intercept:{self:{cost:function(t,n,e,a){return n&&"Bajoran Interceptor"!=n.class?u(t,n,e,a)+5:a}}}},"tech:T023":{canEquip:function(t,n,e){return"Bajoran Interceptor"==n.class&&a("Navigational Sensors")(t,n,e)}},"talent:E022":{canEquipFaction:function(t,n,e){return l(n,"kazon",n,e)&&l(n.captain,"kazon",n,e)}},"tech:T018":{canEquipFaction:function(t,n,e){return l(n,"kazon",n,e)}},"talent:E010":{canEquipFaction:function(t,n,e){return l(n,"vulcan",n,e)&&l(n.captain,"vulcan",n,e)}},"crew:C008":{intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"vulcan",n,e)?u(t,n,e,a)+4:a}}}},"tech:T011":{canEquip:function(t,n,e){return!!l(n,"vulcan",n,e)&&a("Power Distribution Net")(t,n,e)}},"tech:T112":{canEquip:function(t,n,e){return a("Counter Measures")(t,n,e)},intercept:{self:{cost:function(t,n,e,a){return n&&"Cardassian ATR-4107"!=n.class?u(t,n,e,a)+5:a}}}},"question:Q005":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},upgradeSlots:[{type:n},{type:["crew"]}],canEquip:function(t,n,e){return a("Maintenance Crew")(t,n,e)}},"question:Q021":{canEquipFaction:function(t,n,e){return l(n,"kazon",n,e)&&l(n.captain,"kazon",n,e)},isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},upgradeSlots:[{type:n},{type:["tech"]}],intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+2:a}}}},"captain:Cap219":{upgradeSlots:t(2,{type:["talent"],rules:"Bajoran upgrades",faceDown:!0,intercept:{ship:{canEquip:function(t,n,e,a){return!!s.hasFaction(t,"bajoran",n,e)&&a}}}})},"talent:E139":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"bajoran",n,e)&&s.hasFaction(n,"bajoran",n,e)}},"talent:E138":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"bajoran",n,e)&&s.hasFaction(n,"bajoran",n,e)}},"tech:T110":{canEquip:function(t,n,e){return a("TACHYON EDDIES")(t,n,e)},canEquipFaction:function(t,n,e){return n&&"BAJORAN SOLAR SAILOR"==n.class}},"tech:T109":{canEquip:function(t,n,e){return a("MAINSAILS")(t,n,e)},canEquipFaction:function(t,n,e){return n&&"BAJORAN SOLAR SAILOR"==n.class}},"tech:T108":{canEquipFaction:function(t,n,e){return n&&"BAJORAN SOLAR SAILOR"==n.class}},"weapon:W019":{intercept:{self:{cost:function(t,n,e,a){return n&&!l(n,"xindi",n,e)?u(t,n,e,a)+5:a}}}},"tech:T024":{canEquip:function(t,n,e){return!!l(n,"xindi",n,e)&&a("Phase Deflector Pulse")(t,n,e)}},"talent:E036":{upgradeSlots:t(2,{type:["weapon"]})},"weapon:W028":{canEquipFaction:function(t,n,e){return l(n,"xindi",n,e)}},"weapon:W141":{attack:function(t,n,e,a){return n&&"Xindi Reptilian Warship"==n.class?u(t,n,e,a)+1:a}},"captain:temporal_cold_war_vosk":{factionPenalty:function(t,n,e,a){return"talent"==t.type?0:a}},"tech:T126":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"mirror-universe",n,e)?u(t,n,e,a)+4:a}}}},"tech:T103":{canEquip:function(t,n,e){return a("Distress Signal")(t,n,e)}},"tech:T102":{canEquip:function(t,n,e){return a("Gravition Field Generator")(t,n,e)}},"tech:T101":{canEquip:function(t,n,e){return a("Self Destruct Sequence")(t,n,e)}},"captain:Cap434":{upgradeSlots:[{},{type:["crew"]}]},"talent:E136":{canEquipFaction:function(t,n,e){return l(n,"federation",n,e)&&l(n.captain,"federation",n,e)||l(n,"bajoran",n,e)&&l(n.captain,"bajoran",n,e)||l(n,"vulcan",n,e)&&l(n.captain,"vulcan",n,e)||l(n,"federation",n,e)&&l(n.captain,"bajoran",n,e)||l(n,"federation",n,e)&&l(n.captain,"vulcan",n,e)||l(n,"vulcan",n,e)&&l(n.captain,"federation",n,e)||l(n,"vulcan",n,e)&&l(n.captain,"bajoran",n,e)||l(n,"bajoran",n,e)&&l(n.captain,"federation",n,e)||l(n,"bajoran",n,e)&&l(n.captain,"vulcan",n,e)}},"talent:E142":{canEquip:function(t,n,e){return n&&"Xindi Weapon"==n.class}},"crew:C230":{intercept:{ship:{cost:function(t,n,e,a){return c("weapon",t,n)&&s.hasFaction(t,"xindi",n,e)?u(t,n,e,a)-1:a}}}},"weapon:W136":{canEquip:function(t,n,e){return n&&"Xindi Weapon"==n.class}},"weapon:W135":{canEquip:function(t,n,e){return n&&"Xindi Weapon"==n.class}},"tech:T117":{canEquip:function(t,n,e){return s.hasFaction(n,"xindi",n,e)}},"tech:T116":{canEquip:function(t,n,e){return n&&"Xindi Weapon"==n.class}},"captain:Cap329":{intercept:{ship:{cost:function(a,i,r,t){var c=0,e=0;return $.each(r.ships,function(t,n){s.hasFaction(n,"romulan",n,r)&&(e+=1)}),!(e<2)&&($.each(o("upgradeSlots")(i),function(t,n){if(n.occupant&&n.occupant!=a&&"talent"==n.occupant.type&&s.hasFaction(n.occupant,"romulan",i,r)){var e=p(n.occupant,"cost",i,r);if(0<e)return n.occupant,c=e,!1}}),0<c)?t-1:t}}}},"weapon:W134":{canEquip:function(t,n,e){return a("CHARGING WEAPONS")(t,n,e)}},"tech:T115":{canEquip:function(t,n,e){return a("SELF REPAIR TECHNOLOGY")(t,n,e)},canEquipFaction:function(t,n,e){return s.hasFaction(n,"romulan",n,e)}},"weapon:W139":{canEquip:function(t,n,e){return a("Stand By Torpedoes")(t,n,e)}},"crew:C234":{intercept:{self:{canEquip:function(t,n,e){if(n&&n.classData&&n.classData.maneuvers)for(i=1;i<n.classData.maneuvers.max;i++)if(void 0!==n.classData.maneuvers[i].about)return!0;return!1}},ship:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"klingon",n,e)?u(t,n,e,a)+5:a}}}},"crew:C233":{canEquip:function(t,n,e){return a("Klingon Navigator")(t,n,e)}},"captain:Cap331":{upgradeSlots:[{type:["talent"]},{type:["crew"],rules:"Reman Bodyguards Only"}]},"tech:T121":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"romulan",n,e)?u(t,n,e,a)+5:a},canEquip:function(t,n,e){return a("Prototype Cloaking Device")(t,n,e)}}}},"crew:C235":{upgradeSlots:t(1,{type:["tech"],intercept:{ship:{cost:function(t,n,e,a){return a=(a=u(t,n,e,a)-1)<1?1:a},canEquip:function(t,n,e,a){return!!s.hasFaction(t,"romulan",n,e)&&a}}}})},"crew:C236":{intercept:{self:{canEquip:function(t,n,e){return!!a("Reman Bodyguards")(t,n,e)||!(!a("Reman Bodyguards")(t,n,e)||!n.captain||"Vrax"!=n.captain.name)},cost:function(t,n,e,a){return n&&n.captain&&"Vrax"==n.captain.name?u(t,n,e,a)-2:a}}}},"weapon:W140":{canEquip:function(t,n,e){return a("Disruptor Banks")(t,n,e)}},"talent:E145":{canEquip:function(t,n,e){return n&&!!~n.actions.indexOf("battlestations")}},"question:Q007":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)},canEquip:function(t,n,e){return a("Auxiliary Control Room")(t,n,e)}},"question:Q006":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},canEquip:function(t,n,e){return a("Automated Distress Beacon")(t,n,e)}},"captain:Cap725":{intercept:{ship:{factionPenalty:function(t,n,e,a){return r(t)?0:a},cost:function(t,n,e,a){var i=!1;if("ship"!=t.type){var r=[],c=o("upgradeSlots")(n);if($.each(c,function(t,n){!n.occupant||5!=n.occupant.cost&&6!=n.occupant.cost||r.push(n)}),r.length){3<r.length&&(r.sort(function(t,n){return n.occupant.cost-t.occupant.cost}),r=r.slice(0,3));for(var s=0;s<r.length;s++)if(t.id==r[s].occupant.id){i=!0;break}}}return i?4:u(t,n,e,a)}}}},"captain:Cap539":{upgradeSlots:[{type:["talent"],rules:"Klingon only",canEquip:function(t,n,e,a){return s.hasFaction(t,"klingon",n,e)}}]},"tech:T124":{canEquip:function(t,n,e){return a("Emergency Power")(t,n,e)}},"weapon:W142":{intercept:{self:{attack:function(t,n,e,a){return n&&"Vor'cha Class"==n.class?u(t,n,e,a)+1:a}}}},"talent:E151":{canEquip:function(t,n,e){return n&&"D7 Class"==n.class}},"crew:C243":{canEquip:function(t,n,e){return a("Romulan Technical Officer")(t,n,e)}},"tech:T127":{canEquip:function(t,n,e){return a("Impulse Drive")(t,n,e)}},"talent:E153":{rules:"Borg Queen only",canEquip:function(t,n,e){return n.captain&&"Borg Queen"==n.captain.name}},"borg:B017":{rules:"Borg Cube only",canEquip:function(t,n,e){return n&&"Borg Cube"==n.class}},"question:Q008":{canEquip:(a("Borg Support Vehicle Token"),function(t,n,e){return n.hull<=7}),factionPenalty:function(t,n,e){return t&&"Borg Support Vehicle Token"==t.name?0:1},isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)||0<=$.inArray("borg",t)},upgradeSlots:[{type:n}],intercept:{ship:{cost:function(t,n,e,a){var i=0;return"ship"==t.type&&"Borg Sphere"==n.class?i=15:"ship"==t.type&&(i=10),a-i}}}},"tech:T128":{rules:"Borg ship only",canEquipFaction:function(t,n,e){return s.hasFaction(n,"borg",n,e)}},"captain:Cap727":{upgradeSlots:[{},{type:["crew"]}]},"captain:Cap821":{intercept:{ship:{cost:function(t,n,e,a){return c("crew",t,n)&&s.hasFaction(t,"federation",n,e)||s.hasFaction(t,"bajoran",n,e)||s.hasFaction(t,"vulcan",n,e)?u(t,n,e,a)-1:a}}}},"crew:C248":{upgradeSlots:[{type:["tech","weapon"]}]},"weapon:W146":{upgradeSlots:[{type:["weapon"],rules:"Photon Torpedoes Only",canEquip:function(t){return 0<=t.name.indexOf("Photon Torpedoes")}}]},"weapon:W149":{canEquip:function(t,n,e){return a("Additional Phaser Arrays")(t,n,e)}},"tech:T131":{canEquip:function(t,n,e){return a("High-Capacty Deflector Shield Grid")(t,n,e)}},"question:Q017":{isSlotCompatible:function(t){return 0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},upgradeSlots:[{type:["tech"]}]},"question:Q009":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},upgradeSlots:[{type:n}],canEquip:function(t,n,e){return a("Delta Shift")(t,n,e)}},"tech:T137":{rules:"Only one per ship",canEquip:a("Holo-Communicator")},"tech:T136":{rules:"Only one per ship",canEquip:a("Full Reverse")},"tech:T135":{rules:"Only one per ship",canEquip:a("Deflector Control")},"tech:T134":{rules:"Only one per ship",canEquip:a("Resonance Burst")},"tech:T133":{canEquip:function(t,n,e){return a("Control Central")(t,n,e)}},"weapon:W150":{canEquip:function(t,n,e){return a("Main Batteries")(t,n,e)},upgradeSlots:[{type:["weapon"]}]},"captain:Cap333":{canEquip:function(t,n,e){return"Kuvah'Magh"==t.name},intercept:{ship:{cost:function(t,n,e,a){return"Kuvah'Magh"==t.name?u(t,n,e,a)-2:a}}}},"talent:E161":{upgradeSlots:[{}].concat(t(1,{type:["weapon"],rules:"-2 SP if Xindi",intercept:{ship:{cost:function(t,n,e,a){return s.hasFaction(t,"xindi",n,e)?u(t,n,e,a)-2:a}}}}))},"talent:E160":{canEquipFaction:function(t,n,e){return l(n,"xindi",n,e)&&l(n.captain,"xindi",n,e)}},"crew:C259":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Xindi")<0?u(t,n,e,a)+5:a},canEquip:function(t,n,e){return a("Insecetoid Raiding Party")(t,n,e)}}}},"weapon:W153":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Xindi")<0?u(t,n,e,a)+5:a}}}},"tech:T139":{canEquip:function(t,n,e){return s.hasFaction(n,"xindi",n,e)&&a("Hatchery")},upgradeSlots:[{type:["crew"],source:"Face-down Xindi (free)",intercept:{ship:{cost:function(t,n,e,a){return 0},canEquip:function(t,n,e,a){return!!s.hasFaction(t,"xindi",n,e)&&a}}}},{type:["crew"]}]},"tech:T140":{rules:"Only one per ship",canEquip:a("Auxiliary Power to Shields")},"question:Q016":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)||0<=$.inArray("talent",t)},rules:"Only one per ship",canEquip:a("Course Change")},"crew:C262":{upgradeSlots:[{type:["talent"]}],canEquip:function(t,n,e){return n.captain&&"Cap439"==n.captain.id},intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+4:a}}}},"crew:C261":{upgradeSlots:[{type:["talent"]}],canEquip:function(t,n,e){return n.captain&&"Cap438"==n.captain.id},intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+4:a}}}},"tech:T141":{rules:"Only one per ship",canEquip:a("Aft Shields")},"captain:Cap542":{intercept:{ship:{type:function(t,n,e,a){return 0<=$.inArray("tech",a)||0<=$.inArray("weapon",a)||0<=$.inArray("crew",a)?a.concat(["ship-resource"]):a}}}},"ship-resource:Rs01":{upgradeSlots:[{type:["talent","tech","weapon","crew"]}]},"talent:E166":{canEquipFaction:function(t,n,e){return(l(n,"romulan",n,e)||l(n,"klingon",n,e))&&(l(n.captain,"romulan",n,e)||l(n.captain,"klingon",n,e))}},"tech:T142":{rules:"Only one per ship",canEquip:a("Tachyon Pulse")},"weapon:W154":{intercept:{self:{attack:function(t,n,e,a){return n&&"Xindi Aquatic Cruiser"==n.class?u(t,n,e,a)+1:a}}}},"tech:T145":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"xindi",n,e)},canEquip:a("Biometric Hologram")},"tech:T144":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Xindi")<0?u(t,n,e,a)+5:a}}}},"tech:T143":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Xindi")<0?u(t,n,e,a)+4:a}}}},"talent:E167":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n,"xindi",n,e)&&s.hasFaction(n.captain,"xindi",n,e)}},"captain:Cap803":{intercept:{ship:{cost:{priority:100,fn:function(t,n,e,a){var i=0;if("ship"==t.type)i=2;else{var r=[],c=o("upgradeSlots")(n);if($.each(c,function(t,n){n.occupant&&r.push(n)}),r.length){3<r.length&&(r.sort(function(t,n){return n.occupant.cost-t.occupant.cost}),r=r.slice(0,3));for(var s=0;s<r.length;s++)if(t.id==r[s].occupant.id){i=1;break}}}return u(t,n,e,a)-i}}}}},"tech:T146":{rules:"Only one per ship",canEquip:a("Transporter")},"weapon:W155":{attack:0,canEquip:function(t,n,e){return s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"bajoran",n,e)||4<=n.hull},intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e)-1:a},cost:function(t,n,e,a){return n?u(t,n,e,a)+p(n,"attack",n,e):a}}}},"crew:C266":{upgradeSlots:[{type:["weapon"]},{type:["weapon"]}]},"captain:Cap801":{intercept:{ship:{type:function(t,n,e,a){return 0<=$.inArray("tech",a)||0<=$.inArray("crew",a)?a.concat(["weapon"]):a},cost:function(t,n,e,a){return c("weapon",t,n)?u(t,n,e,a)-1:a}}}},"weapon:W157":{self:{attack:function(t,n,e,a){return n&&"Xindi Reptilian Warship"==n.class?u(t,n,e,a)+1:a}}},"weapon:W156":{attack:0,canEquip:function(t,n,e){return s.hasFaction(n,"xindi",n,e)},intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e)+1:a},cost:function(t,n,e,a){return n?u(t,n,e,a)+p(n,"attack",n,e):a}}}},"crew:C267":{upgradeSlots:[{type:["tech"]}],canEquipFaction:function(t,n,e){return s.hasFaction(n,"xindi",n,e)},canEquip:a("Reptilian Analysis Team")},"tech:T148":{canEquip:function(t,n,e){return"Xindi Reptilian Warship"==n.class}},"tech:T147":{canEquip:(a("Sensor Encoders"),function(t,n,e){return"Xindi Reptilian Warship"==n.class})},"tech:T149":{canEquip:a("Impulse Thrusters")},"captain:Cap335":{upgradeSlots:[{type:["talent"],rules:"Captain's Discretion",canEquip:function(t,n,e,a){return"Captain's Discretion"==t.name&&a}}]},"tech:T152":{upgradeSlots:[{type:["crew"]}],canEquip:a("Comm Station")},"tech:T1511":{canEquip:a("Close-Range Scan")},"tech:T150":{name:"Genesis Effect",range:!1,upgradeSlots:[{type:["crew"],rules:"Crew, 5SP or less",intercept:{ship:{free:function(){return!0},canEquip:function(t,n,e,a){return!(5<p(t,"cost",n,e))&&a}}}}]},"crew:C273":{intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+3:a}}}},"talent:E172":{upgradeSlots:t(3,{type:["talent"],rules:"Klingon Talent Only",faceDown:!0,intercept:{ship:{cost:function(){return 0},factionPenalty:function(){return 0},canEquip:function(t,n,e,a){return!!s.hasFaction(t,"klingon",n,e)&&a}}}})},"crew:C278":{upgradeSlots:[{type:["crew"]}]},"tech:T154":{canEquip:a("Dispersive Armor")},"question:Q010":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)}},"question:Q011":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},canEquip:a("Captured"),upgradeSlots:[{type:n}],intercept:{ship:{factions:function(t,n,e,a){return t==n&&a.indexOf("independent")<0?a.concat(["independent"]):a}}}},"weapon:W162":{canEquip:a("Plasma Pulse")},"tech:T155":{canEquip:function(t,n,e){return 4<=n.hull}},"ship:S267":{intercept:{ship:{canEquipCaptain:function(t,n,e){return"Gareb"==t.name||"Jhamel"==t.name||"Romulan Drone Pilot"==t.name}}}},"ship:S266":{intercept:{ship:{canEquipCaptain:function(t,n,e){return"Gareb"==t.name||"Jhamel"==t.name||"Romulan Drone Pilot"==t.name}}}},"captain:Cap336":{canEquipCaptain:function(t,n,e){return"Romulan Drone Ship"==n.class}},"weapon:W166":{name:"Triphasic Emitters",range:!1,upgradeSlots:[{type:["weapon"],rules:"Non-Borg, 5SP or less",intercept:{ship:{free:function(){return!0},canEquip:function(t,n,e,a){return!(0==t.printedValue||l(t,"borg",n,e)||5<p(t,"cost",n,e))&&a}}}}]},"tech:T160":{canEquip:function(t,n,e){return"Romulan Drone Ship"==n.class},canEquip:a("Repair Protocol")},"weapon:W165":{canEquip:a("Tellarite Disruptor Banks")},"tech:T159":{canEquip:function(t,n,e){return"Romulan Drone Ship"==n.class},canEquip:a("Evasive Protocol")},"tech:T158":{canEquip:function(t,n,e){return"Romulan Drone Ship"==n.class},canEquip:a("Disguise Protocol")},"captain:Cap656":{upgradeSlots:t(1,{type:["talent"],rules:"Klingon And Romulan Talents Cost Exactly 3 SP",faceDown:!0,intercept:{ship:{cost:{priority:100,fn:function(t,n,e,a){return l(t,"klingon",n,e)||l(t,"romulan",n,e)?3:a}},factionPenalty:function(t,n,e,a){return l(t,"klingon",n,e)||l(t,"romulan",n,e)?0:a}}}})},"talent:E174":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"klingon",n,e)}},"weapon:W170":{canEquip:a("Tactical Station"),upgradeSlots:[{type:["weapon"]}]},"weapon:W169":{attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e)+1:a}}}},"weapon:W167":{attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e):a},cost:function(t,n,e,a){return n?u(t,n,e,a)+p(n,"attack",n,e):a}}}},"crew:C290":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)}},"captain:Cap817":{upgradeSlots:[{},{type:["tech"]}]},"talent:E177":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"romulan",n,e)}},"tech:T248":{canEquip:a("Interphase Generator")},"tech:T165":{canEquip:function(t,n,e){return a("Reinforced Shields")&&5<=n.hull}},"tech:T166":{canEquip:function(t,n,e){return a("Auxiliary Power Core")&&4<=n.hull},intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"romulan",n,e)?u(t,n,e,a)+2:a}}}},"weapon:W171":{canEquip:function(t,n,e){return a("Additional Weapons Array")&&"D'deridex Class"==n.class}},"talent:E180":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"dominion",n,e)&&5<=n.hull}},"crew:C297":{canEquip:function(t,n,e){return s.hasFaction(n,"dominion",n,e)}},"crew:C298":{upgradeSlots:[{type:["tech"]}]},"weapon:W178":{canEquip:function(t,n,e){return"Jem'Hadar Battleship "==n.class}},"weapon:W176":{canEquip:function(t,n,e){return a("Phased Polaron Beams")&&"Jem'Hadar Attack Ship"==n.class}},"weapon:W174":{canEquip:function(t,n,e){return"Jem'Hadar Attack Ship"==n.class}},"weapon:W175":{canEquip:a("Minesweeper")},"tech:T169":{canEquip:function(t,n,e){return a("Suicide Attack")&&"Jem'Hadar Attack Ship"==n.class}},"tech:T168":{canEquip:function(t,n,e){return s.hasFaction(n,"dominion",n,e)}},"captain:Cap730":{intercept:{ship:{factionPenalty:function(t,n,e,a){return s.hasFaction(t,"ferengi",n,e)?0:a},cost:function(t,n,e,a){return a=r(t)&&l(t,"ferengi",n,e)?u(t,n,e,a)-1:a}}}},"talent:E181":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"ferengi",n,e)}},"crew:C301":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"ferengi",n,e)}},"tech:T170":{canEquip:a("Metaphasic Shields"),intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"talent:E182":{canEquip:a("Neural Transponder"),canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"borg",n,e)}},"crew:C305":{upgradeSlots:[{type:["crew"]}],canEquip:a("Neonatal Borg"),intercept:{ship:{type:function(t,n,e,a){return 0<=$.inArray("tech",a)||0<=$.inArray("borg",a)||"borg"==n.hasFaction?a.concat(["crew"]):a}}}},"weapon:W181":{attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e):a}}}},"captain:Cap446":{upgradeSlots:[{type:["talent"]},{type:["crew"],faceDown:!0,rules:"Cost of 3sp or less",intercept:{ship:{cost:function(){return 0},canEquip:function(t,n,e,a){return(p(t,"cost",n,e)<=4&&s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"klingon",n,e)||s.hasFaction(n,"romulan",n,e)||s.hasFaction(n,"dominion",n,e)||s.hasFaction(n,"borg",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)||s.hasFaction(n,"mirror-universe",n,e)||!!(p(t,"cost",n,e)<=3||s.hasFaction(n,"independent",n,e)||s.hasFaction(n,"ferengi",n,e)||s.hasFaction(n,"kazon",n,e)||s.hasFaction(n,"xindi",n,e)))&&a}}}},{type:["crew"],faceDown:!0,rules:"Cost of 3sp or less",intercept:{ship:{cost:function(){return 0},canEquip:function(t,n,e,a){return(p(t,"cost",n,e)<=4&&s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"klingon",n,e)||s.hasFaction(n,"romulan",n,e)||s.hasFaction(n,"dominion",n,e)||s.hasFaction(n,"borg",n,e)||s.hasFaction(n,"bajoran",n,e)||s.hasFaction(n,"vulcan",n,e)||s.hasFaction(n,"mirror-universe",n,e)||!!(p(t,"cost",n,e)<=3||s.hasFaction(n,"independent",n,e)||s.hasFaction(n,"ferengi",n,e)||s.hasFaction(n,"kazon",n,e)||s.hasFaction(n,"xindi",n,e)))&&a}}}}]},"captain:Cap223":{upgradeSlots:[{type:["talent"],rules:"Grand Nagus Only",canEquip:function(t){return"Grand Nagus"==t.name}},{type:["talent"],rules:"The Rules of Acquisition Only",canEquip:function(t){return"The Rules Of Acquisition"==t.name}}]},"admiral:A033":{upgradeSlots:[{type:["talent"],rules:"Grand Nagus Only",canEquip:function(t){return"Grand Nagus"==t.name}},{type:["talent"],rules:"The Rules of Acquisition Only",canEquip:function(t){return"The Rules Of Acquisition"==t.name}}]},"talent:E183":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"ferengi",n,e)}},"tech:T172":{canEquip:a("Kemocite")},"weapon:W183":{attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e):a}}}},"crew:C310":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"ferengi",n,e)}},"crew:C309":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"ferengi",n,e)}},"crew:C308":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"ferengi",n,e)?0:1}},"question:Q019":{type:"question",isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("crew",t)}},"question:Q020":{type:"question",isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("crew",t)||0<=$.inArray("weapon",t)}},"question:Q012":{type:"question",isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)}},"talent:E184":{canEquipFaction:function(t,n,e){return n.captain&&("S'Sesslak"==n.captain.name||"Lahr"==n.captain.name||0<=n.captain.name.indexOf("Gorn"))},canEquip:function(t,n,e){return"Gorn Raider"==n.class}},"crew:C314":{intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+1:a}}}},"question:Q013":{canEquip:function(t,n,e){return a("Meridor - Gorn Ale")(t,n,e)&&s.hasFaction(n,"independent",n,e)||a("Meridor - Gorn Ale")(t,n,e)&&s.hasFaction(n,"ferengi",n,e)||a("Meridor - Gorn Ale")(t,n,e)&&s.hasFaction(n,"kazon",n,e)||a("Meridor - Gorn Ale")(t,n,e)&&s.hasFaction(n,"xindi",n,e)},isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},upgradeSlots:[{type:n}]},"weapon:W185":{canEquip:function(t,n,e){return"Gorn Raider"==n.class&&a("Disruptor Bombardment")}},"tech:T173":{canEquip:function(t,n,e){return"Gorn Raider"==n.class&&a("Gorn Sensors")}},"tech:T174":{canEquip:function(t,n,e){return"Gorn Raider"==n.class&&a("Enhanced Durability")},upgradeSlots:[{type:["tech"]}],intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a},agility:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"weapon:W187":{canEquip:a("Tactical Command Reticle"),canEquipFaction:function(t,n,e){return s.hasFaction(n,"dominion",n,e)},upgradeSlots:[{type:["weapon"]}]},"squadron:D032":{upgradeSlots:[{type:["squadron"]}]},"squadron:D029":{canEquip:a("Defensive Maneuver Beta")},"squadron:D028":{canEquip:a("Defensive Maneuver Theta")},"squadron:D027":{canEquip:a("Flanking Maneuver Delta")},"squadron:D031":{canEquip:a("Flanking Maneuver Epsilon")},"squadron:D026":{canEquip:a("Flanking Attack Omega")},"talent:E187":{canEquipFaction:function(t,n,e){return n.captain&&("Idrin"==n.captain.name||"Karr"==n.captain.name||0<=n.captain.name.indexOf("Hirogen"))}},"crew:C320":{canEquip:a("Beta Hirogen"),intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+1:a}}}},"crew:C321":{canEquip:function(t,n,e){return"Hirogen Warship"==n.class}},"weapon:W188":{intercept:{self:{cost:function(t,n,e,a){return n&&n.class.indexOf("Hirogen")<0?u(t,n,e,a)+5:a}}}},"tech:T178":{canEquip:a("Tractor Beam")},"tech:T177":{canEquip:function(t,n,e){return a("Stealth Mode")&&"Hirogen Warship"==n.class}},"question:Q014":{isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)}},"ship:S313":{upgradeSlots:[{type:["tech"],rules:"Free Inertial Compensators Only",canEquip:function(t){return"Inertial Compensators"==t.name},intercept:{ship:{cost:function(){return 0}}}}]},"ship:S316":{intercept:{ship:{type:function(t,n,e,a){return n.captain&&0<=$.inArray(a,n.captain)?a.concat(["crew"]):a}}},upgradeSlots:[{type:["crew"],rules:"Replace's Captain",intercept:{ship:{skill:function(t,n,e,a){return t.cost+3}}}}]},"captain:Cap658":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"vulcan",n,e)||s.hasFaction(n,"bajoran",n,e)?0:1}},"captain:Cap609":{canEquipCaptain:function(t,n,e){return"Dauntless Class"==n.class}},"captain:Cap336":{canEquipCaptain:function(t,n,e){return"Romulan Drone Ship"==n.class}},"talent:E192":{canEquip:function(t,n,e){return n.captain&&(s.hasFaction(n.captain,"independent",n,e)||s.hasFaction(n.captain,"ferengi",n,e)||s.hasFaction(n.captain,"kazon",n,e)||s.hasFaction(n.captain,"xindi",n,e))&&"Maquis Raider"==n.class}},"talent:E191":{canEquipFaction:function(t,n,e){return n.captain&&("Telev"==n.captain.name||"Thy'Lek Shran"==n.captain.name||0<=n.captain.name.indexOf("Andorian"))}},"talent:E190":{canEquipFaction:function(t,n,e){return n.captain&&0<=n.captain.name.indexOf("Vidiian")},canEquip:function(t,n,e){return"Vidiian Battle Cruiser"==n.class}},"crew:C340":{canEquip:function(t,n,e){return"Andorian Battle Cruiser"==n.class}},"weapon:W193":{canEquip:function(t,n,e){return"Vidiian Battle Cruiser"==n.class}},"weapon:W194":{canEquip:function(t,n,e){return n.attack<=2}},"tech:T184":{canEquip:function(t,n,e){return a("Enhanced Shield Emitters")&&"Andorian Battle Cruiser"==n.class},intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+2:a}}}},"tech:T251":{canEquip:function(t,n,e){return a("Particle Synthesis")&&"Dauntless Class"==n.class}},"tech:T182":{intercept:{self:{canEquip:function(t,n,e){if(n&&n.hull<=3&&n.classData&&n.classData.maneuvers)for(i=1;i<n.classData.maneuvers.max;i++)if(void 0!==n.classData.maneuvers[i].about)return!0;return!1}}}},"tech:T183":{canEquip:function(t,n,e){return a("Class 4 Cloaking Device")&&"Maquis Raider"==n.class}},"question:Q015":{canEquip:function(t,n,e){return a("Repurposed Cargo Hold")(t,n,e)&&s.hasFaction(n,"independent",n,e)||a("Repurposed Cargo Hold")(t,n,e)&&s.hasFaction(n,"ferengi",n,e)||a("Repurposed Cargo Hold")(t,n,e)&&s.hasFaction(n,"kazon",n,e)||a("Repurposed Cargo Hold")(t,n,e)&&s.hasFaction(n,"xindi",n,e)},isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},upgradeSlots:[{type:["tech","weapon"]}]},"captain:Cap820":{upgradeSlots:[{},{type:["crew"]}]},"admiral:A034":{upgradeSlots:[{},{type:["crew"]}]},"talent:E189":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"klingon",n,e)}},"crew:C336":{upgradeSlots:[{type:["talent"]}]},"crew:C335":{upgradeSlots:[{type:["talent"]}]},"crew:C330":{upgradeSlots:[{type:["crew"],faceDown:!0,intercept:{ship:{canEquip:function(t,n,e){return p(t,"cost",n,e)<=4},free:function(){return!0}}}}]},"crew:C322":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)}},"crew:C323":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)&&a("Klingon First Officer")}},"crew:C324":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)}},"crew:C325":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)}},"weapon:W189":{canEquip:function(t,n,e){return"Constitution Class (Kelvin)"==n.class&&a("Full Spread Phasers")}},"weapon:W192":{canEquip:function(t,n,e){return"Constitution Class (Kelvin)"==n.class},attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e)+1:a}}}},"weapon:W191":{attack:0,intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e)+1:a}}}},"weapon:W190":{canEquip:function(t,n,e){return"Warbird Class"==n.class}},"tech:T179":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)&&a("Klingon Cloaking Device")}},"tech:T180":{canEquip:function(t,n,e){return a("Future Technology")},upgradeSlots:[{type:["tech"],faceDown:!0,intercept:{ship:{canEquip:function(t,n,e){return p(t,"cost",n,e)<=4},free:function(){return!0}}}}],intercept:{ship:{factionPenalty:function(t,n,e,a){return"tech"==t.type&&s.hasFaction(t,"romulan",n,e)||"weapon"==t.type&&s.hasFaction(t,"romulan",n,e)||"tech"==t.type&&s.hasFaction(t,"borg",n,e)||"weapon"==t.type&&s.hasFaction(t,"borg",n,e)?0:a}}}},"captain:Cap825":{intercept:{self:{skill:function(t,n,e,a){return"Constitution Class"==n.class?u(t,n,e,a)+1:a}}}},"talent:E197":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"klingon",n,e)}},"talent:E196":{canEquipFaction:function(t,n,e){return n.captain&&s.hasFaction(n.captain,"federation",n,e)}},"crew:C345":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)}},"crew:C356":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)}},"crew:C349":{intercept:{ship:{factionPenalty:function(t,n,e,a){return"C349"==t.id?0:a}}}},"weapon:W197":{intercept:{self:{attack:function(t,n,e,a){return p(n,"attack",n,e)}}}},"weapon:W196":{canEquip:a("Magnetic Pulse"),intercept:{self:{attack:function(t,n,e,a){return p(n,"attack",n,e)}}}},"ship:S318":{class:"Galaxy Class",classId:"galaxy__class_mu",intercept:{ship:{factionPenalty:function(t,n,e,a){return t?0:a},factions:function(t,n,e,a){return t==n&&a.indexOf("mirror-universe")<0?a.concat(["mirror-universe"]):a},cost:function(t,n,e,a){return c("tech",t,n)?u(t,n,e,a)-1:a}}}},"captain:Cap911":{canEquipCaptain:function(t,n,e){return l(n,"borg",n,e)}},"captain:Cap910":{canEquipCaptain:function(t,n,e){return l(n,"borg",n,e)},upgradeSlots:[{type:["talent"]},{type:["crew"]},{type:["crew"]}],intercept:{fleet:{canEquip:function(t,n,e,a){return"Jean-Luc Picard"!=t.name&&a},canEquipCaptain:function(t,n,e,a){return"Jean-Luc Picard"!=t.name&&a}},ship:{factionPenalty:{priority:100,fn:function(t,n,e,a){return"crew"==t.type?0:a}}}}},"crew:C352":{canEquipFaction:function(t,n,e){return l(n,"borg",n,e)}},"crew:C345":{intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+(l(t,"borg",n,e)?3:1):a}}}},"crew:C351":{upgradeSlots:[{type:["borg"]}],intercept:{ship:{cost:{priority:100,fn:function(t,n,e,a){return c("borg",t,n)&&(a=u(t,n,e,a),--a),a}}}}},"crew:C357":{upgradeSlots:[{type:["borg"],rules:"-1SP for each Empty Slot",intercept:{ship:{cost:function(t,n,e,a){var i=0;$.inArray(n.upgrades);return $.each(o("upgradeSlots")(n),function(t,n){null==n.occupant&&"talent"!==n.type&&(i+=1)}),a=(a-=i)<0?0:a}}}}]},"tech:T252":{intercept:{ship:{factionPenalty:function(t,n,e,a){return"T252"==t.id?0:a}}},upgradeSlots:[{type:["borg"]}]},"weapon:W200":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"borg",n,e)},intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e):a}}}},"weapon:W199":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"borg",n,e)},intercept:{self:{attack:function(t,n,e,a){return n?p(n,"attack",n,e):a},cost:function(t,n,e,a){return n?p(n,"attack",n,e):a}}}},"borg:B020":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"borg",n,e)},canEquip:a("Borg Multi-Adaptive Shields")},"borg:B022":{canEquipFaction:function(t,n,e){return s.hasFaction(n,"borg",n,e)}},"talent:E195":{canEquipFaction:function(t,n,e){return l(n.captain,"borg",n,e)}},"talent:E194":{canEquipFaction:function(t,n,e){return l(n,"borg",n,e)}},"talent:E193":{canEquip:a("Ocular Implants"),canEquipFaction:function(t,n,e){return l(n,"borg",n,e)&&l(n.captain,"borg",n,e)}},"ship:S335":{intercept:{ship:{cost:function(t,n,e,a){return s.hasFaction(t,"vulcan",n,e)&&"captain"==t.type||s.hasFaction(t,"vulcan",n,e)&&"admiral"==t.type||s.hasFaction(t,"vulcan",n,e)&&"crew"==t.type?u(t,n,e,a)-1:a}}}},"crew:C369":{upgradeSlots:[{type:["tech"],rules:"0 SP Stone of Gol",faceDown:!0,canEquip:function(t){return"Stone of Gol"==t.name},intercept:{ship:{cost:function(t,n,e,a){return s.match(t,n,n,e)?s.match(t,n,n,e)?0:a:1}}}}]},"tech:T267":{intercept:{self:{cost:function(t,n,e,a){return n&&!s.hasFaction(n,"vulcan",n,e)?u(t,n,e,a)+5:a}}}},"talent:E198":{canEquipFaction:function(t,n,e){return l(n,"vulcan",n,e)&&l(n.captain,"vulcan",n,e)}},"talent:E207":{canEquipFaction:function(t,n,e){return l(n,"vulcan",n,e)&&l(n.captain,"vulcan",n,e)}},"weapon:W212":{canEquipFaction:function(t,n,e){return l(n,"vulcan",n,e)&&a("Photonic Auto-Cannon")}},"weapon:W211":{canEquipFaction:function(t,n,e){return l(n,"vulcan",n,e)}},"tech:T264":{canEquipFaction:function(t,n,e){return l(n,"vulcan",n,e)}},"tech:T266":{canEquip:function(t,n,e){return a("Science Vessel Variant")&&("D'Kyr Class"==n.class||"Suurok Class"==n.class)},intercept:{ship:{agility:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a},hull:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"tech:T265":{canEquip:function(t,n,e){return a("Combat Vessel Variant")&&("D'Kyr Class"==n.class||"Suurok Class"==n.class)},intercept:{ship:{attack:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"captain:Cap826":{canEquipCaptain:function(t,n,e){return l(n,"dominion",n,e)}},"question:Q018":{canEquip:a("Kanar"),canEquipFaction:function(t,n,e){return l(n,"dominion",n,e)},isSlotCompatible:function(t){return 0<=$.inArray("tech",t)||0<=$.inArray("weapon",t)||0<=$.inArray("crew",t)},upgradeSlots:[{type:n}]},"crew:C363":{canEquipFaction:function(t,n,e){return l(n,"dominion",n,e)}},"captain:Cap827":{intercept:{self:{factionPenalty:function(t,n,e,a){return l(n,"romulan",n,e)?0:a}}}},"admiral:A036":{intercept:{self:{factionPenalty:function(t,n,e,a){return l(n,"romulan",n,e)?0:a}}}},"crew:C364":{intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+2:a}}}},"crew:C365":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"federation",n,e)||s.hasFaction(n,"vulcan",n,e)?0:1}},"talent:E204":{canEquipFaction:function(t,n,e){return l(n,"dominion",n,e)},canEquip:a("Obsidian Order")},"weapon:W208":{canEquip:(a("Multiple Dorsal Arrays"),function(t,n,e){return"Cardassian Galor Class"==n.class})},"weapon:W209":{canEquip:a("Enhanced Resonance Field Grid")},"weapon:W210":{canEquip:function(t,n,e){return a("Phase Disruptor Array")&&("Cardassian Galor Class"==n.class||"Cardassian Keldon Class"==n.class)}},"tech:T260":{canEquip:a("Sensor Ghost")},"tech:T261":{canEquip:function(t,n,e){return a("Uridium Alloy")&&("Cardassian Galor Class"==n.class||"Cardassian Keldon Class"==n.class)}},"tech:T262":{canEquip:function(t,n,e){return a("Type-3 Galor Class")&&"Cardassian Galor Class"==n.class},intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+2:a}}}},"tech:T263":{canEquipFaction:function(t,n,e){return l(n,"dominion",n,e)},upgradeSlots:t(2,{type:["crew"]})},":":{factionPenalty:function(t,n,e){return n&&s.hasFaction(n,"ferengi",n,e)||s.hasFaction(n,"kazon",n,e)||s.hasFaction(n,"independent",n,e)?0:1}},"resource:R042":{slotType:"ship-resource",cost:0,hideCost:!0,showShipResourceSlot:function(t,n,e){var a;return!(!n.resource||"ship-resource"!=n.resource.type)||(a=!0,$.each(e.ships,function(t,n){n.resource&&(a=!1)}),a)},onRemove:function(t,n,e){$.each(e.ships,function(t,n){n.resource&&delete n.resource})}},"ship-resource:R042a":{canEquip:function(t,n,e){return 4<=p(n,"hull",n,e)}},"resource:R040":{slotType:"ship-resource",cost:0,hideCost:!0,showShipResourceSlot:function(t,n,e){var a;return!(!n.resource||"ship-resource"!=n.resource.type)||(a=!0,$.each(e.ships,function(t,n){n.resource&&(a=!1)}),a)},onRemove:function(t,n,e){$.each(e.ships,function(t,n){n.resource&&delete n.resource})}},"ship-resource:Rs40":{intercept:{ship:{shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a},skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+1:a}}}},"resource:R039":{slotType:"ship-resource",cost:0,hideCost:!0,showShipResourceSlot:function(t,n,e){var a;return!(!n.resource||"ship-resource"!=n.resource.type)||(a=!0,$.each(e.ships,function(t,n){n.resource&&(a=!1)}),a)},onRemove:function(t,n,e){$.each(e.ships,function(t,n){n.resource&&delete n.resource})}},"resource:R033":{slotType:"ship-resource",cost:0,hideCost:!0,showShipResourceSlot:function(t,n,e){var a;return!(!n.resource||"ship-resource"!=n.resource.type)||(a=!0,$.each(e.ships,function(t,n){n.resource&&(a=!1)}),a)},onRemove:function(t,n,e){$.each(e.ships,function(t,n){n.resource&&delete n.resource})}},"ship-resource:R033a":{upgradeSlots:[{type:["captain"],rules:"Fleet Commander"}],intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+1:a},shields:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a}}}},"ship-resource:R033b":{upgradeSlots:[{type:["captain"],rules:"Fleet Commander"}],intercept:{ship:{skill:function(t,n,e,a){return t==n.captain?u(t,n,e,a)+1:a},hull:function(t,n,e,a){return t==n?u(t,n,e,a)+1:a},canEquip:function(t,n,e){if(t)return!0}}}},"resource:R010":{slotType:"fleet-captain",cost:0,hideCost:!0,showShipResourceSlot:function(t,n,e){var a;return!(!n.resource||"fleet-captain"!=n.resource.type)||(a=!0,$.each(e.ships,function(t,n){n.resource&&(a=!1)}),a)},onRemove:function(t,n,e){$.each(e.ships,function(t,n){n.resource&&delete n.resource})}},"fleet-captain:R010a":{canEquip:function(t,n,e){return s.hasFaction(n,"federation",n,e)&&(!n.captain||n.captain.unique&&s.hasFaction(n.captain,"federation",n,e))},intercept:{ship:{canEquipCaptain:function(t,n,e){return t.unique&&s.hasFaction(t,"federation",n,e)}}}},"fleet-captain:R010b":{canEquip:function(t,n,e){return s.hasFaction(n,"dominion",n,e)&&(!n.captain||n.captain.unique&&s.hasFaction(n.captain,"dominion",n,e))},intercept:{ship:{canEquipCaptain:function(t,n,e){return t.unique&&s.hasFaction(t,"dominion",n,e)}}}},"fleet-captain:R010c":{canEquip:function(t,n,e){return s.hasFaction(n,"romulan",n,e)&&(!n.captain||n.captain.unique&&s.hasFaction(n.captain,"romulan",n,e))},intercept:{ship:{canEquipCaptain:function(t,n,e){return t.unique&&s.hasFaction(t,"romulan",n,e)}}}},"fleet-captain:R010d":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)&&(!n.captain||n.captain.unique&&s.hasFaction(n.captain,"klingon",n,e))},intercept:{ship:{canEquipCaptain:function(t,n,e){return t.unique&&s.hasFaction(t,"klingon",n,e)}}}},"fleet-captain:R010e":{canEquip:function(t,n,e){return!n.captain||n.captain.unique},intercept:{ship:{canEquipCaptain:function(t,n,e){return t.unique},factions:function(t,n,e,a){return a=a||t.factions,t==n.captain&&a.indexOf("independent")<0?a.concat(["independent"]):a}},fleet:{cost:function(t,n,e,a){return c("crew",t,n)?u(t,n,e,a)-1:a}}}},"fleet-captain:R010f":{canEquip:function(t,n,e){return!n.captain||n.captain.unique},intercept:{ship:{canEquipCaptain:function(t,n,e){return t.unique},factions:function(t,n,e,a){return a=a||t.factions,t==n.captain&&a.indexOf("independent")<0?a.concat(["independent"]):a}},fleet:{}}},"fleet-captain:R010g":{canEquip:function(t,n,e){return!n.captain||n.captain.unique},intercept:{ship:{canEquipCaptain:function(t,n,e){return t.unique},factions:function(t,n,e){var a=t.factions;return t==n.captain&&a.indexOf("independent")<0?a.concat(["independent"]):a}},fleet:{cost:function(t,n,e,a){return c("weapon",t,n)?u(t,n,e,a)-1:a}}}},"fleet-captain:R010h":{canEquip:function(t,n,e){return!n.captain||n.captain.unique},intercept:{ship:{canEquipCaptain:function(t,n,e){return t.unique},factions:function(t,n,e){var a=t.factions;return t==n.captain&&a.indexOf("independent")<0?a.concat(["independent"]):a}},fleet:{cost:function(t,n,e,a){return c("tech",t,n)?u(t,n,e,a)-1:a}}}},"resource:R015":{upgradeSlots:[{type:["faction"],source:"Select Factions for Officer Exchange Program"},{type:["faction"],source:"Select Factions for Officer Exchange Program"}],intercept:{fleet:{factionPenalty:function(t,n,e,a){var i=e.resource.upgradeSlots[0].occupant,e=e.resource.upgradeSlots[1].occupant;return i&&e&&("captain"==t.type||"admiral"==t.type||"crew"==t.type)&&(s.match(t,i)&&s.match(n,e)||s.match(t,e)&&s.match(n,i))?0:a},cost:function(t,n,e,a){var i=e.resource.upgradeSlots[0].occupant,r=e.resource.upgradeSlots[1].occupant;return i&&r&&("captain"==t.type||"admiral"==t.type)&&(s.match(t,i)&&s.match(n,r)||s.match(t,r)&&s.match(n,i))?u(t,n,e,a)-1:a}}}},"resource:R011":{hideCost:!0,intercept:{fleet:{type:function(t,n,e,a){return 0<=$.inArray("crew",a)?a.concat(["officer"]):a}}}},"officer:R011a":{skill:4,talents:1,upgradeSlots:[{},{type:["talent"],source:"First Officer"}]},"officer:R011b":{upgradeSlots:[{},{type:["weapon"],source:"Tactical Officer"}]},"officer:R011c":{upgradeSlots:[{},{type:["crew"],source:"Operations Officer"}]},"officer:R011d":{upgradeSlots:[{},{type:["tech"],source:"Science Officer"}]},"resource:R003":{class:"Sideboard",factions:s.listCodified,upgradeSlots:[{type:["captain"],source:"Sideboard",rules:"Combined cost 20 SP or less",canEquip:function(t,e,a,i){var r=0,t=($.each(a.resource.upgradeSlots,function(t,n){n.occupant&&n!=i&&(r+=p(n.occupant,"cost",e,a))}),p(t,"cost",e,a));return r+t<=20},intercept:{ship:{canEquip:{priority:100,fn:function(){return!0}},canEquipFaction:{priority:100,fn:function(){return!0}},factionPenalty:function(){return 0}}}},{type:["talent"],source:"Sideboard",rules:"Combined cost 20 SP or less",canEquip:function(t,e,a,i){var r=0,t=($.each(a.resource.upgradeSlots,function(t,n){n.occupant&&n!=i&&(r+=p(n.occupant,"cost",e,a))}),p(t,"cost",e,a));return r+t<=20},intercept:{ship:{canEquip:{priority:100,fn:function(){return!0}},canEquipFaction:{priority:100,fn:function(){return!0}},factionPenalty:function(){return 0}}}},{type:["crew"],source:"Sideboard",rules:"Combined cost 20 SP or less",canEquip:function(t,e,a,i){var r=0,t=($.each(a.resource.upgradeSlots,function(t,n){n.occupant&&n!=i&&(r+=p(n.occupant,"cost",e,a))}),p(t,"cost",e,a));return r+t<=20},intercept:{ship:{canEquip:{priority:100,fn:function(){return!0}},canEquipFaction:{priority:100,fn:function(){return!0}},factionPenalty:function(){return 0}}}},{type:["tech"],source:"Sideboard",rules:"Combined cost 20 SP or less",canEquip:function(t,e,a,i){var r=0,t=($.each(a.resource.upgradeSlots,function(t,n){n.occupant&&n!=i&&(r+=p(n.occupant,"cost",e,a))}),p(t,"cost",e,a));return r+t<=20},intercept:{ship:{canEquip:{priority:100,fn:function(){return!0}},canEquipFaction:{priority:100,fn:function(){return!0}},factionPenalty:function(){return 0}}}},{type:["weapon"],source:"Sideboard",rules:"Combined cost 20 SP or less",canEquip:function(t,e,a,i){var r=0,t=($.each(a.resource.upgradeSlots,function(t,n){n.occupant&&n!=i&&(r+=p(n.occupant,"cost",e,a))}),p(t,"cost",e,a));return r+t<=20},intercept:{ship:{canEquip:{priority:100,fn:function(){return!0}},canEquipFaction:{priority:100,fn:function(){return!0}},factionPenalty:function(){return 0}}}}]},"resource:R004":{slotType:"flagship",cost:0,hideCost:!0,showShipResourceSlot:function(t,n,e){var a;return!(!n.resource||"flagship"!=n.resource.type)||(a=!0,$.each(e.ships,function(t,n){n.resource&&(a=!1)}),a)},onRemove:function(t,n,e){$.each(e.ships,function(t,n){n.resource&&delete n.resource})}},"flagship:R004a":{canEquip:function(t,n,e){return s.hasFaction(n,"romulan",n,e)}},"flagship:R004b":{canEquip:function(t,n,e){return s.hasFaction(n,"klingon",n,e)},intercept:{ship:{canEquip:function(t,n,e){if(t)return!0}}}},"flagship:R004c":{canEquip:function(t,n,e){return s.hasFaction(n,"dominion",n,e)},intercept:{ship:{canEquip:function(t,n,e){if(t)return!0}}}},"flagship:R004e":{canEquip:function(t,n,e){return s.hasFaction(n,"federation",n,e)},intercept:{ship:{canEquip:function(t,n,e){if(t)return!0}}}},"flagship:R004f":{intercept:{ship:{factions:function(t,n,e,a){return t==n&&a.indexOf("independent")<0?a.concat(["independent"]):a}}}},"flagship:R004g":{intercept:{ship:{factions:function(t,n,e,a){return t==n&&a.indexOf("independent")<0?a.concat(["independent"]):a},canEquip:function(t,n,e){if(t)return!0}}}},"flagship:R004h":{intercept:{ship:{factions:function(t,n,e,a){return t==n&&a.indexOf("independent")<0?a.concat(["independent"]):a},canEquip:function(t,n,e){if(t)return!0}}}},"flagship:R004i":{intercept:{ship:{factions:function(t,n,e,a){return t==n&&a.indexOf("independent")<0?a.concat(["independent"]):a},canEquip:function(t,n,e){if(t)return!0}}}},"resource:R020":{cost:function(t,n,e){var a;return e?(a=0,$.each(e.ships||[],function(t,n){a+=p(n,"shields",n,e)}),Math.ceil(a/2)):0}},"resource:R029":{},"talent:E035":{upgradeSlots:[{type:["talent"],rules:"",faceDown:!0,canEquip:function(t,n,e){return s.match(t,n)&&p(t,"cost",n,e)<=5},intercept:{ship:{free:function(){return!0}}}}],canEquip:a("Balance of Terror"),intercept:{self:{cost:{priority:1e3,fn:function(){return 3}}}}},"crew:C035":{upgradeSlots:[{type:["crew"],rules:"",faceDown:!0,canEquip:function(t,n,e){return s.match(t,n)&&p(t,"cost",n,e)<=5},intercept:{ship:{free:function(){return!0}}}}],canEquip:a("Balance of Terror"),intercept:{self:{cost:{priority:1e3,fn:function(){return 3}}}}},"tech:T044":{upgradeSlots:[{type:["tech"],rules:"",faceDown:!0,canEquip:function(t,n,e){return s.match(t,n)&&p(t,"cost",n,e)<=5},intercept:{ship:{free:function(){return!0}}}}],canEquip:a("Balance of Terror"),intercept:{self:{cost:{priority:1e3,fn:function(){return 3}}}}},"weapon:W027":{upgradeSlots:[{type:["weapon"],rules:"",faceDown:!0,canEquip:function(t,n,e){return s.match(t,n)&&p(t,"cost",n,e)<=5},intercept:{ship:{free:function(){return!0}}}}],canEquip:a("Balance of Terror"),intercept:{self:{cost:{priority:1e3,fn:function(){return 3}}}}},"resource:R036":{intercept:{fleet:{type:function(t,n,e,a){return 0<=$.inArray("crew",a)?a.concat(["ship-resource"]):a}}}},"ship-resource:R036a":{upgradeSlots:[{type:["crew"]},{type:["talent"],intercept:{ship:{cost:function(t,n,e,a){return u(t,n,e,a)+1}}}}]},"ship:S362":{intercept:{ship:{cost:function(t,n,e,a){return n&&n.construction&&"Con001"==n.construction.id&&(t.text.includes("may only be purchased for a Prometheus Class ship")||t.text.includes("Prometheus Class Only"))?u(t,n,e,a)-2:a}}}}}}]),(module=angular.module("utopia-card-ship-class",[])).directive("cardShipClass",function(){return{scope:{shipClass:"=",ship:"=",fleet:"="},templateUrl:"card-ship-class.html",controller:["$scope",function(t){t.abs=Math.abs,t.speeds=[];for(var n=t.shipClass.maneuvers,e=n.max;e>=n.min;e--)0==e&&!n[0]||t.speeds.push(e);for(t.speeds.length<7&&-2<n.min&&t.speeds.push(9),t.speeds.length<7&&-1<n.min&&t.speeds.push(9);t.speeds.length<7;)t.speeds.unshift(9);t.getBaseTileName=function(t){return t.unique?t.name:t.class}}]}}),(module=angular.module("utopia-card-ship",[])).directive("cardShip",function(){return{scope:{ship:"=",fleet:"=",dragStore:"=",dragSource:"="},templateUrl:"card-ship.html",controller:["$scope",function(t){}]}}),(module=angular.module("utopia-card-token",[])).directive("cardToken",function(){return{scope:{token:"=",ship:"=",fleet:"=",dragStore:"=",dragSource:"="},templateUrl:"card-token.html",controller:["$scope",function(t){}]}}),(module=angular.module("utopia-card-upgrade",[])).directive("cardUpgrade",function(){return{scope:{upgrade:"=",ship:"=",fleet:"=",dragStore:"=",dragSource:"="},templateUrl:"card-upgrade.html",controller:["$scope",function(t){t.range=function(t){return new Array(t)},t.isDefined=function(t){return void 0!==t}}]}}),(module=angular.module("utopia-card",["utopia-tooltip","utopia-card-ship","utopia-card-ship-class","utopia-card-upgrade","utopia-card-resource","utopia-dragdrop","utopia-valueof"])).directive("card",function(){return{scope:{card:"=",ship:"=",fleet:"=",dragStore:"=",dragSource:"@"},restrict:"E",templateUrl:"card.html"}}),module.filter("icons",function(){return function(t){return t.replace(/\[([^\]]*)\]/g,"<i class='fs fs-$1'></i>").replace(/\n/g,"<br/>")}}),(module=angular.module("utopia-valueof",[])).filter("removeDashes",["$filter",function(t){return function(t){return t&&t.replace(/\-/g," ")}}]),module.factory("globalInterceptors",function(){return{cost:{priority:1e3,source:"Cost cannot be negative",hidden:!0,fn:function(t,n,e,a){return(a=a instanceof Function?a(t,n,e):a)<0?0:a}}}}),module.filter("upgradeSlots",function(){return function(t){for(var n=[],e=(t.resource&&t.resource.upgradeSlots&&(n=n.concat(t.resource.upgradeSlots)),t.captain&&t.captain.upgradeSlots&&(n=n.concat(t.captain.upgradeSlots)),t.admiral&&t.admiral.upgradeSlots&&(n=n.concat(t.admiral.upgradeSlots)),t.ambassador&&t.ambassador.upgradeSlots&&(n=n.concat(t.ambassador.upgradeSlots)),n=(n=t.construction&&t.construction.upgradeSlots?n.concat(t.construction.upgradeSlots):n).concat(t.upgrades).concat(t.upgradeSlots),[]);0<n.length;){var a=n.shift();a&&(e.push(a),a.occupant)&&a.occupant.upgradeSlots&&!a.faceDown&&(n=a.occupant.upgradeSlots.concat(n))}return e}}),module.filter("shipInterceptors",["$filter",function(t){var s=t("upgradeSlots");return function(e,t,a,i,r){var c=[],n=s(t);return $.each(n,function(t,n){n.occupant&&n.occupant.intercept[a][i]&&!n.faceDown&&wrapInterceptors(n.occupant.intercept[a][i],n.occupant,c),(r&&n==r||e==n.occupant)&&n.intercept&&n.intercept[a]&&n.intercept[a][i]&&wrapInterceptors(n.intercept[a][i],n.source||"Unknown",c)}),t.resource&&t.resource.intercept[a][i]&&wrapInterceptors(t.resource.intercept[a][i],t.resource,c),t.captain&&t.captain.intercept[a][i]&&wrapInterceptors(t.captain.intercept[a][i],t.captain,c),t.admiral&&t.admiral.intercept[a][i]&&wrapInterceptors(t.admiral.intercept[a][i],t.admiral,c),t.ambassador&&t.ambassador.intercept[a][i]&&wrapInterceptors(t.ambassador.intercept[a][i],t.ambassador,c),t.construction&&t.construction.intercept[a][i]&&wrapInterceptors(t.construction.intercept[a][i],t.construction,c),t.intercept&&t.intercept[a][i]&&wrapInterceptors(t.intercept[a][i],t,c),c}}]),module.filter("interceptors",["$filter","globalInterceptors",function(t,c){var s=t("shipInterceptors");return function(e,t,n,a,i){var r=[];return e.intercept&&e.intercept.self&&e.intercept.self[a]&&wrapInterceptors(e.intercept.self[a],e,r),t&&(r=r.concat(s(e,t,"ship",a,i))),n&&($.each(n.ships||[],function(t,n){r=r.concat(s(e,n,"fleet",a))}),n.resource)&&(r=r.concat(s(e,n.resource,"fleet",a))),r=c[a]?r.concat(c[a]):r}}]),module.filter("valueOf",["$filter",function(t){var s=t("interceptors");return function(a,t,i,r,n,e){var c=[{source:"Printed Value",value:data=(data=a[t])instanceof Function?data(a,i,r):data}];return i&&((t=s(a,i,r,t,n)).sort(function(t,n){return t.priority>n.priority?1:-1}),$.each(t,function(t,n){var e=data;(data=n.fn(a,i,r,data))==e||n.hidden||(data=data instanceof Function?data(a,i,r):data,e=e instanceof Function?e(a,i,r):e,data!=e&&c.push({source:n.source,value:data-e}))})),data instanceof Function&&(data=data(a,i,r)),e&&e.modifiers?c:data}}]),angular.module("utopia").run(["$templateCache",function(t){"use strict";t.put("fleet-builder.html",'<div class="fleet-open-export" ng-show="!searchOptions.showExport">\n\t<button class="fleet-search-bigger" ng-click="searchOptions.showExport = true"><i class="fa fa-chevron-left"></i> Export</button>\n</div>\n\n<div class="fleet-open-search" ng-show="searchOptions.columns < 1">\n\t<button class="fleet-search-bigger" ng-click="searchOptions.columns = 1">Search <i class="fa fa-chevron-right"></i></button>\n</div>\n\n<div class="fleet-ship-container" ng-repeat="ship in fleet.ships track by $index">\n\n\t<div class="fleet-ship-top">\n\t\t<div class="fleet-ship-top-left" ng-class="{\'fleet-ship-top-left-first\':$first}"></div>\n\t\t<div class="fleet-ship-title font-staw" ng-class="{\'fleet-ship-title-long\': ship.name.length >= 18, \'fleet-ship-title-longer\': ship.name.length >= 21}">{{ ship.name }}</div>\n\t\t<div class="fleet-ship-top-spacer"></div>\n\t\t<div class="fleet-ship-title fleet-ship-cost font-staw">{{ getTotalCost(ship,fleet) }} SP</div>\n\t\t<div class="fleet-ship-top-spacer"></div>\n\t\t<div class="fleet-ship-top-spacer"></div>\n\t\t<div class="toggle-button-value pull-left" ng-class="{\'toggle-button-value-active\': !ship.hideEmptySlots}"></div>\n\t\t<div class="fleet-ship-title fleet-ship-cost font-staw">\n\t\t\t<button class="title-button" ng-click="ship.hideEmptySlots = !ship.hideEmptySlots">Show Empty Slots</button>\n\t\t</div>\n\t\t<div class="fleet-ship-top-right"></div>\n\t</div>\n\t<div class="fleet-ship-middle">\n\t\t<div class="fleet-ship-left"></div>\n\n\t\t<div class="fleet-ship-inner">\n\n\t\t\t<div class="card-container" ng-class="{\'zoom\':zoom}">\n\t\t\t\t<card card="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t\t</div>\x3c!--\n\t\t\tStupid whitespace breaks card alignment\n\t\t --\x3e<div class="card-container" ng-class="{\'zoom\':zoom}">\n\t\t\t\t<card card="ship.classData" ship="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t\t</div>\x3c!--\n\t\t --\x3e<div class="card-container" ng-class="{\'zoom\':zoom}" ng-show="!ship.squadron && fleet.resource && (fleet.resource|valueOf:\'showShipResourceSlot\':ship:fleet)" droppable can-drop="$item.type == fleet.resource.slotType" drop="setShipResource(fleet,ship,$item)" drag-store="dragStore">\n\t\t\t\t<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([fleet.resource.slotType])">\n\t\t\t\t\t<div class="card-drop-target-inner">\n\t\t\t\t\t\t<div class="card-drop-target-type">\n\t\t\t\t\t\t\t<i class="fs fs-{{fleet.resource.slotType}}"></i><br/>{{fleet.resource.slotType|removeDashes}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<card card="ship.resource" ship="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t\t</div>\x3c!--\n\n\t\t --\x3e<div class="card-container" ng-class="{\'zoom\':zoom}" ng-hide="ship.squadron" droppable can-drop="$item.type == \'captain\' && $item != ship.captain" drop="setShipCaptain(fleet,ship,$item)" drag-store="dragStore">\n\t\t\t\t<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'captain\'])">\n\t\t\t\t\t<div class="card-drop-target-inner">\n\t\t\t\t\t\t<div class="card-drop-target-type">\n\t\t\t\t\t\t\t<i class="fs fs-captain"></i><br/>Captain\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<card card="ship.captain" ship="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t\t</div>\x3c!--\n\n\t\t --\x3e<div class="card-container" ng-class="{\'zoom\':zoom}" ng-hide="!ship.admiral && ( ship.squadron || ship.hideEmptySlots || fleetHasAdmiral(fleet) )"\n\t\t\t\tdroppable can-drop="$item.type == \'admiral\' && $item != ship.admiral" drop="setShipAdmiral(fleet,ship,$item)" drag-store="dragStore">\n\t\t\t\t<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'admiral\'])">\n\t\t\t\t\t<div class="card-drop-target-inner">\n\t\t\t\t\t\t<div class="card-drop-target-type">\n\t\t\t\t\t\t\t<i class="fs fs-admiral"></i><br/>Admiral\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<card card="ship.admiral" ship="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t\t</div>\x3c!--\n\n\t\t\t--\x3e<div class="card-container" ng-class="{\'zoom\':zoom}" ng-hide="!ship.ambassador && ( ship.squadron || ship.hideEmptySlots || fleetHasAmbassador(fleet) )"\n\t\t\t\t droppable can-drop="$item.type == \'ambassador\' && $item != ship.ambassador" drop="setShipAmbassador(fleet,ship,$item)" drag-store="dragStore">\n\t\t\t\t <div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'ambassador\'])">\n\t\t\t\t\t <div class="card-drop-target-inner">\n\t\t\t\t\t\t <div class="card-drop-target-type">\n\t\t\t\t\t\t\t <i class="fs fs-ambassador"></i><br/>Ambassador\n\t\t\t\t\t\t </div>\n\t\t\t\t\t </div>\n\t\t\t\t </div>\n\t\t\t\t <card card="ship.ambassador" ship="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t\t </div>\n\t\t\t \x3c!--\n\t\t\t--\x3e<div class="card-container" ng-class="{\'zoom\':zoom}" ng-hide="!ship.construction && ( ship.squadron || ship.hideEmptySlots )"\n\t\t\tdroppable can-drop="$item.type == \'starship_construction\' && $item != ship.starship_construction" drop="setShipConstruction(fleet,ship,$item)" drag-store="dragStore">\n\t\t\t<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'starship_construction\'])">\n\t\t\t\t<div class="card-drop-target-inner">\n\t\t\t\t\t<div class="card-drop-target-type">\n\t\t\t\t\t\t<i class="fs fs-starship_construction"></i><br/>Starship Construction\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<card card="ship.construction" ship="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t</div>\x3c!--\n\n\t\t--\x3e<div class="card-container" ng-class="{\'zoom\':zoom}" ng-mouseenter="hover = true" ng-mouseleave="hover = false"\n\t\t\t\tng-repeat="upgradeSlot in ship|upgradeSlots" ng-hide="!upgradeSlot.occupant && (ship.hideEmptySlots || (upgradeSlot|valueOf:\'hide\':ship:fleet))"\n\t\t\t\tdroppable can-drop="isUpgradeCompatible($item, upgradeSlot, ship, fleet)" drop="setUpgrade(fleet,ship,upgradeSlot,$item)" drag-store="dragStore">\n\t\t\t\t<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes(upgradeSlot.type)">\n\t\t\t\t\t<div class="card-drop-target-title" ng-class="{\'card-drop-target-title-hover\':hover || upgradeSlot.occupant == dragStore.item}" ng-show="upgradeSlot.source && upgradeSlot.source != \'ship\'">{{upgradeSlot.source}}<div ng-show="upgradeSlot.rules">{{upgradeSlot.rules}}</div></div>\n\t\t\t\t\t<div class="card-drop-target-inner">\n\t\t\t\t\t\t<div class="card-drop-target-type" ng-repeat="type in upgradeSlot|valueOf:\'type\':ship:fleet">\n\t\t\t\t\t\t\t<i class="fs fs-{{type}}"></i><br/>{{type|removeDashes}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="card-drop-target-subtitle">{{upgradeSlot|valueOf:\'show\':ship:fleet}}</div>\n\t\t\t\t<card card="upgradeSlot.occupant" ship="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t\t</div>\n\n\t\t</div>\n\n\t</div>\n\n\t<div class="fleet-ship-bottom" ng-show="$last && searchOptions.columns < 1 && !fleet.resource">\n\t\t<div class="fleet-ship-bottom-left" ng-class="{\'fleet-ship-bottom-left-long\': fleet.ships.length > 0 || fleet.resource}"></div>\n\t</div>\n\n</div>\n\n<div class="fleet-ship-container" ng-hide="loading || ( searchOptions.columns < 1 && !fleet.resource )">\n\n\t<div class="fleet-ship-top">\n\t\t<div class="fleet-ship-top-left" ng-class="{\'fleet-ship-top-left-first\': fleet.ships.length == 0}"></div>\n\t\t<div class="fleet-ship-title font-staw">Fleet Total</div>\n\t\t<div class="fleet-ship-top-spacer"></div>\n\t\t<div class="fleet-ship-title fleet-ship-cost font-staw">{{ getFleetCost(fleet) }} SP</div>\n\t\t<div class="fleet-ship-top-right"></div>\n\t</div>\n\n\t<div class="fleet-ship-middle">\n\t\t<div class="fleet-ship-left"></div>\n\n\t\t<div class="fleet-ship-inner">\n\n\t\t\t<div class="card-container" ng-class="{\'zoom\':zoom}" ng-hide="searchOptions.columns < 1">\n\t\t\t\t<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'ship\'])"\n\t\t\t\t\tdroppable can-drop="$item.type == \'ship\'" drop="addFleetShip(fleet,$item)" drag-store="dragStore">\n\t\t\t\t\t<div class="card-drop-target-title" ng-if="!isMobile">Click to search this card type</div>\n\t\t\t\t\t<div class="card-drop-target-title" ng-if="isMobile">Tap to search this card type</div>\n\t\t\t\t\t<div class="card-drop-target-inner">\n\t\t\t\t\t\t<div class="card-drop-target-type">\n\t\t\t\t\t\t\t<i class="fs fs-ship"></i><br/>Ship\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div ng-show="!isMobile" class="card-drop-target-subtitle">Drag here to add to fleet</div>\n\t\t\t\t\t<div ng-show="isMobile && (!dragStore.item || dragStore.item.type != \'ship\')" class="card-drop-target-subtitle">Tap a ship card to select it</div>\n\t\t\t\t\t<div ng-show="isMobile && dragStore.item && dragStore.item.type == \'ship\'" class="card-drop-target-subtitle">Tap here to add selected ship to fleet</div>\n\t\t\t\t</div>\n\t\t\t</div>\x3c!--\n\n\t\t\t--\x3e<div class="card-container" ng-class="{\'zoom\':zoom}" droppable can-drop="$item.type == \'resource\' && $item != fleet.resource" drop="setFleetResource(fleet,$item)" drag-store="dragStore">\n\t\t\t\t<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'resource\'])">\n\t\t\t\t\t<div class="card-drop-target-title"></div>\n\t\t\t\t\t<div class="card-drop-target-inner">\n\t\t\t\t\t\t<div class="card-drop-target-type">\n\t\t\t\t\t\t\t<i class="fs fs-resource"></i><br/>Resource\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="card-drop-target-subtitle"></div>\n\t\t\t\t</div>\n\t\t\t\t<card card="fleet.resource" ship="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t\t</div>\x3c!--\n\n\t\t\t--\x3e<div class="card-container" ng-class="{\'zoom\':zoom}" ng-repeat="upgradeSlot in fleet.resource.upgradeSlots"\n\t\t\t\tdroppable can-drop="isUpgradeCompatible($item, upgradeSlot) && $item != upgradeSlot.occupant" drop="setUpgrade(fleet,fleet.resource,upgradeSlot,$item)" drag-store="dragStore">\n\t\t\t\t<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes(upgradeSlot.type)">\n\t\t\t\t\t<div class="card-drop-target-title">{{upgradeSlot.source}}<div ng-show="upgradeSlot.rules">{{upgradeSlot.rules}}</div></div>\n\t\t\t\t\t<div class="card-drop-target-inner">\n\t\t\t\t\t\t<div class="card-drop-target-type" ng-repeat="type in upgradeSlot.type">\n\t\t\t\t\t\t\t<i class="fs fs-{{type}}"></i><br/>{{type|removeDashes}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="card-drop-target-subtitle"></div>\n\t\t\t\t</div>\n\t\t\t\t<card card="upgradeSlot.occupant" ship="ship" fleet="fleet" drag-store="dragStore"></card>\n\t\t\t</div>\n\n\t\t</div>\n\n\t</div>\n\n\t<div class="fleet-ship-bottom">\n\t\t<div class="fleet-ship-bottom-left fleet-ship-bottom-left-long"></div>\n\t</div>\n\n</div>\n'),t.put("fleet-export.html",'<div class="fleet-close-export" ng-show="searchOptions.showExport">\n\t<button class="fleet-search-bigger" ng-click="searchOptions.showExport = false"><i class="fa fa-chevron-right"></i> Export</button>\n</div>\n\n<div class="export-container">\n\t<div class="u-search-header"><div class="u-search-header-text">Copy Text Listing</div></div>\n\t<label class="export-option"><input type="checkbox" ng-model="showSetNames">Include Expansion Names</label>\n\t\x3c!-- New checkbox here for the table-top simulator option. --\x3e\n\t<label class="export-option"><input type="radio" ng-model="exportType" value="traditional">Traditional Export</label>\n\t<label class="export-option"><input type="radio" ng-model="exportType" value="tts">Table-Top Sim Export</label>\n\t\x3c!-- <label class="export-option"><input type="radio" ng-model="exportType" value="fleetSheet">Export JSON for Fleet Sheet</label> --\x3e\n\t<textarea class="export-text" ng-model="fleetText"></textarea>\n</div>\n'),t.put("fleet-list.html",'<div class="container-fluid">\n\n\t<div class="row" >\n\t\t<div class="col-md-4">\n\t\t</div>\n\t</div>\n\n</div>'),t.put("search-filter-group.html",'<div class="u-search-header" ng-click="showContent = !showContent"><div class="u-search-header-text">{{title}}</div></div>\n<div class="u-search-content" ng-show="showContent" ng-transclude></div>'),t.put("search.html",'<div class="u-search">\n\n\t<div class="search-query-container">\n\t\t<input class="u-search-query" ng-model="search.query" placeholder="Search" spellcheck="false" autocorrect="off">\n\t\t<button ng-click="resetSearch()">Reset</button>\n\t\t<button ng-click="showAdvanced = !showAdvanced">Advanced</button>\n\t</div>\n\n\t<div ng-show="showAdvanced && (!dragStore.item || dragStore.source == \'search\')">\n\n\t\t<div class="u-search-size">\n\t\t\t<button class="u-search-smaller" ng-click="modifySearchColumns(-1)"><i class="fa fa-chevron-left"></i></button>\n\t\t\t<div class="u-search-size-text">Resize Search Results</div>\n\t\t\t<button class="u-search-bigger" ng-click="modifySearchColumns(1)"><i class="fa fa-chevron-right"></i></button>\n\t\t</div>\n\n\t\t<search-filter-group title="Faction" open>\n\t\t\t<span ng-repeat="(faction,data) in search.factions">\n\t\t\t\t<label class="u-label"><input type="checkbox" ng-model="data.search" > <div class="u-faction card-faction-{{faction}}"></div> {{faction|removeDashes}}</label>\n\t\t\t</span>\n\t\t</search-filter-group>\n\n\t\t<search-filter-group title="Type" open>\n\t\t\t<span class="u-search-type" ng-repeat="(type,data) in search.types">\n\t\t\t\t<label class="u-label"><input type="checkbox" ng-model="data.search" > <i class="fs fs-{{type}}"></i> {{type|removeDashes}}</label>\n\t\t\t</span>\n\t\t</search-filter-group>\n\n\t\t<search-filter-group title="Uniqueness" open>\n\t\t\t<span>\n\t\t\t\t<label class="u-label"><input type="checkbox" ng-model="search.unique"> <i class="fs fs-unique"></i> Unique</label>\n\t\t\t</span>\n\t\t\t<span>\n\t\t\t\t<label class="u-label"><input type="checkbox" ng-model="search.generic"> <i class="fs"></i> Generic</label>\n\t\t\t</span>\n\t\t</search-filter-group>\n\n\t\t<search-filter-group title="Order By" open>\n\t\t\t<div class="u-search-filter-comment">\n\t\t\t\tOrder results by <select ng-model="search.sortBy" ng-options="sortable.value as sortable.name for sortable in sortables"></select>\n\t\t\t\t<select ng-model="search.ascending"><option value="true">Ascending</option><option value="false">Descending</option></select>\n\t\t\t\t<div class="u-order-default" ng-show="search.sortBy != defaults.search.sortBy || search.ascending != defaults.search.ascending">\n\t\t\t\t\t<button ng-click="defaults.search.sortBy = search.sortBy; defaults.search.ascending = search.ascending">Set as Default</button>\n\t\t\t\t\t<div>Default order is saved in browser for future sessions.</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</search-filter-group>\n\n\t\t<search-filter-group title="Custom Filter" open>\n\t\t\t<div class="u-search-filter-comment" ng-init="search.filterOperator = \'<\'">\n\t\t\t\t<select ng-model="search.filterField"><option value="">- No Filter -</option><option ng-repeat="sortable in sortables" value="{{sortable.value}}">{{sortable.name}}</option></select>\n\t\t\t\t<select ng-model="search.filterOperator"><option value="<">&lt;</option><option value="<=">&lt;=</option><option value="=">=</option><option value=">=">&gt;=</option><option value=">">&gt;</option></select>\n\t\t\t\t<input ng-model="search.filterValue" placeholder="Value"></input>\n\t\t\t</div>\n\t\t\t<div class="u-search-filter-comment">\n\t\t\t\tFilter On Maneuver: <select ng-model="search.maneuverType"><option value="">Any</option><option ng-repeat="maneuver in maneuvers" value="{{maneuver.value}}">{{maneuver.name}}</option></select>\n\t\t\t\t<select ng-model="search.maneuverDifficulty"><option value="">Any</option><option ng-repeat="difficulty in difficulty_list" value="{{difficulty.value}}">{{difficulty.name}}</option></select>\n\t\t\t</div>\n\t\t</search-filter-group>\n\n\t\t<search-filter-group title="Owned Expansions">\n\t\t\t<div class="u-search-filter-comment">\n\t\t\t\tExpansion filter settings are stored in your browser for future sessions. Uncheck the expansions you don\'t own. New expansions are automatically checked. These settings are not affected by the "Reset" button.\n\t\t\t</div>\n\t\t\t<div class="u-search-filter-comment">\n\t\t\t\t<label class="u-label"><input type="checkbox" ng-model="search.ignoreSetsFilter"> Temporarily show all cards</label>\n\t\t\t</div>\n\t\t\t<button ng-click="uncheckAllSets()">Uncheck all sets</button>\n\t\t\t<button ng-click="checkAllSets()">Check all sets</button>\n\t\t\t<button ng-click="exportSets()">Export Sets</button>\n\t\t\t<div class="u-search-filter-comment">Import Sets...</div>\n\t\t\t<input type="file" multiple onchange="angular.element(this).scope().importSets(this)">\n\t\t\t<div ng-repeat="set in setList | orderBy:\'-releaseDate\'" class="u-search-set" ng-hide="search.ignoreSetsFilter">\n\t\t\t\t<label class="u-label"><input type="checkbox" ng-model="search.sets[set.id].search"> {{set.parentSet}}: {{set.name}}</label>\n\t\t\t</div>\n\t\t</search-filter-group>\n\n\t</div>\n\n</div>\n\n<div ng-init="resultLimit = 10">\n\n\t<div class="u-loading" ng-show="loading">Loading cards...</div>\n\n\t<div class="card-container" ng-show="dragStore.item && dragStore.source != \'search\'" droppable can-drop="true" drop="$emit(\'removeFromFleetDropped\',$item)" drag-store="dragStore">\n\t\t<div class="card-outer card-drop-target font-staw">\n\t\t\t<div class="card-drop-target-inner">\n\t\t\t\t<div class="card-drop-target-type">\n\t\t\t\t\t<i class="fs fs-captain"></i><br/>Remove From Fleet\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div ng-hide="dragStore.item && dragStore.source != \'search\'">\n\n\t\t<div class="card-container" ng-repeat="card in cards | cardFilter:search | sortBy:search.sortBy:search.ascending | limitTo:resultLimit*search.columns">\n\t\t\t<card card="card" drag-store="dragStore" drag-source="search"></card>\n\t\t</div>\n\n\t\t<div>\n\t\t\t<button class="u-show-more" ng-hide="loading" ng-click="resultLimit = resultLimit + 10">Show More</button>\n\t\t</div>\n\n\t</div>\n\n</div>\n'),t.put("card-faction.html",'<div class="card-outer card-faction font-staw" ng-class="{ \'dragging\': faction == dragStore.item }" draggable drag-item="faction" drag-store="dragStore" drag-source="dragSource">\n\n\t<div class="card-faction-image card-faction-{{faction.factions[0]}}"></div>\n\n\t<div class="card-faction-name">{{faction.name | uppercase}}</div>\n\n</div>'),t.put("card-resource.html",'<div class="card-outer card-resource font-staw" ng-class="{ \'dragging\': resource == dragStore.item }" draggable drag-item="resource" drag-store="dragStore" drag-source="dragSource">\n\n\t<div class="card-resource-header">\n\t\t<span class="card-title" ng-class="{\'card-title-long\': resource.name.length > 20}">{{resource.name | uppercase}}<span ng-hide="resource.hideCost"> ({{resource|valueOf:\'cost\':ship:fleet}} SP)</span></span>\n\t\t\n\t</div>\n\t\n\t<div class="card-resource-header pull-right">\n\t\t<i ng-if="resource.opBanned" class="card-OP-banned-icon fs fs-opBanned"></i>\n\t</div>\n\t\n\t<div class="card-text">\n\t\t<div class="card-text-inner font-staw-alt" ng-bind-html="resource.text | icons"></div>\n\t</div>\n\n</div>'),t.put("card-ship-class.html",'<div class="card-outer card-ship card-shipclass font-staw">\n\n\t<div class="card-shipclass-arcs arc-faction-{{ship.factions[0]}}">\n\t\t<div class="arc arc-fill arc-fore-90" ng-show="shipClass.frontArc == 90"></div>\n\t\t<div class="arc arc-fill arc-fore-180" ng-show="shipClass.frontArc == 180"></div>\n\t\t<div class="arc arc-rear-90" ng-show="shipClass.rearArc == 90"></div>\n\t\t<div class="arc-hole"></div>\n\t\t<div class="arc-name">{{getBaseTileName(ship)}}</div>\n\t\t<div class="arc-stats">\n\t\t\t<div class="arc-stat card-ship-stat-attack text-center">{{ship|valueOf:\'attack\':ship:fleet}}</div>\n\t\t\t<div class="arc-stat card-ship-stat-agility text-center">{{ship|valueOf:\'agility\':ship:fleet}}</div>\n\t\t\t<div class="arc-stat card-ship-stat-hull text-center">{{ship|valueOf:\'hull\':ship:fleet}}</div>\n\t\t\t<div class="arc-stat card-ship-stat-shields text-center">{{ship|valueOf:\'shields\':ship:fleet}}</div>\n\t\t</div>\n\t\t<div class="arc-actions"><i ng-repeat="action in ship.actions" class="fs fs-{{action}}"></i></div>\n\t</div>\n\n\t\x3c!-- <div class="card-image" ng-class="{\'card-image-large\': Object.keys(shipClass.maneuvers).length > 9}"></div> --\x3e\n\t<div ng-class="(shipClass.id == \'borg_cube\' || shipClass.id == \'kelvin_constitution_class\') ? \'card-image-large\' : \'card-image\'"></div>\n\n\t<div class="card-corner-top-left pull-left">\n\t\t<div class="card-corner-inner pull-right"></div>\n\t</div>\n\t<div class="card-corner-top-right pull-right">\n\t\t<div class="card-corner-inner card-corner-inner-faction"></div>\n\t</div>\n\t<div class="card-title-container text-center">\n\t\t<span class="card-shipclass-title" ng-class="{\'card-title-long\': shipClass.name.length >= 20 }">{{shipClass.name | uppercase}}</span>\n\t</div>\n\n\t<div ng-class="(shipClass.id == \'borg_cube\' || shipClass.id == \'kelvin_constitution_class\') ? \'card-border-left-tall pull-left\' : \'card-border-left pull-left\'"></div>\n\n\t<div ng-class="(shipClass.id == \'borg_cube\' || shipClass.id == \'kelvin_constitution_class\') ? \'card-border-right-tall pull-right\' : \'card-border-right pull-right\'"></div>\n\n\t<div ng-class="(shipClass.id == \'borg_cube\' || shipClass.id == \'kelvin_constitution_class\') ? \'card-class-maneuvers-tall\' : \'card-class-maneuvers\'">\n\t\t<div class="card-maneuver-row" ng-repeat="speed in speeds track by $index">\n\t\t\t<div class="card-maneuver-box" ng-class="{\'speed-reverse\': speed < 0}"><span ng-show="speed != 9">{{abs(speed)}}</span></div>\n\t\t\t<div class="card-maneuver-box" ng-class="{\'card-maneuver-box-highlight\': shipClass.maneuvers[speed].turn || shipClass.maneuvers[speed][\'90-degree-rotate\']}">\n\t\t\t\t<i class="fs fs-turn-left speed-{{shipClass.maneuvers[speed].turn}}" ng-show="shipClass.maneuvers[speed].turn"></i>\n\t\t\t\t<i class="fs fs-90-rotate-left speed-{{shipClass.maneuvers[speed][\'90-degree-rotate\']}}" ng-show="shipClass.maneuvers[speed][\'90-degree-rotate\']"></i>\n\t\t\t</div>\n\t\t\t<div class="card-maneuver-box" ng-class="{\'card-maneuver-box-highlight\': shipClass.maneuvers[speed].bank || shipClass.maneuvers[speed].spin || shipClass.maneuvers[speed].flank || shipClass.maneuvers[speed][\'45-degree-rotate\']}">\n\t\t\t\t<i class="fs fs-bank-left speed-{{shipClass.maneuvers[speed].bank}}" ng-show="shipClass.maneuvers[speed].bank"></i>\n\t\t\t\t<i class="fs fs-spin-left speed-{{shipClass.maneuvers[speed].spin}}" ng-show="shipClass.maneuvers[speed].spin"></i>\n\t\t\t\t<i class="fs fs-left-flank speed-{{shipClass.maneuvers[speed].flank}}" ng-show="shipClass.maneuvers[speed].flank"></i>\n\t\t\t\t<i class="fs fs-45-rotate-left speed-{{shipClass.maneuvers[speed][\'45-degree-rotate\']}}" ng-show="shipClass.maneuvers[speed][\'45-degree-rotate\']"></i>\n\t\t\t</div>\n\t\t\t<div class="card-maneuver-box" ng-class="{\'card-maneuver-box-highlight\': shipClass.maneuvers[speed].straight || shipClass.maneuvers[speed].stop}">\n\t\t\t\t<i class="fs speed-{{shipClass.maneuvers[speed].straight}}" ng-class="{\'fs-forward\': speed > 0, \'fs-reverse\': speed < 0}" ng-show="shipClass.maneuvers[speed].straight"></i>\n\t\t\t\t<i class="fs fs-stop speed-{{shipClass.maneuvers[speed].stop}}" ng-show="shipClass.maneuvers[speed].stop"></i>\n\t\t\t</div>\n\t\t\t<div class="card-maneuver-box" ng-class="{\'card-maneuver-box-highlight\': shipClass.maneuvers[speed].bank || shipClass.maneuvers[speed].spin || shipClass.maneuvers[speed].flank || shipClass.maneuvers[speed][\'45-degree-rotate\']}">\n\t\t\t\t<i class="fs fs-bank-right speed-{{shipClass.maneuvers[speed].bank}}" ng-show="shipClass.maneuvers[speed].bank"></i>\n\t\t\t\t<i class="fs fs-spin-right speed-{{shipClass.maneuvers[speed].spin}}" ng-show="shipClass.maneuvers[speed].spin"></i>\n\t\t\t\t<i class="fs fs-right-flank speed-{{shipClass.maneuvers[speed].flank}}" ng-show="shipClass.maneuvers[speed].flank"></i>\n\t\t\t\t<i class="fs fs-45-rotate-right speed-{{shipClass.maneuvers[speed][\'45-degree-rotate\']}}" ng-show="shipClass.maneuvers[speed][\'45-degree-rotate\']"></i>\n\t\t\t</div>\n\t\t\t<div class="card-maneuver-box" ng-class="{\'card-maneuver-box-highlight\': shipClass.maneuvers[speed].turn || shipClass.maneuvers[speed][\'90-degree-rotate\']}">\n\t\t\t\t<i class="fs fs-turn-right speed-{{shipClass.maneuvers[speed].turn}}" ng-show="shipClass.maneuvers[speed].turn"></i>\n\t\t\t\t<i class="fs fs-90-rotate-right speed-{{shipClass.maneuvers[speed][\'90-degree-rotate\']}}" ng-show="shipClass.maneuvers[speed][\'90-degree-rotate\']"></i>\n\t\t\t</div>\n\t\t\t<div class="card-maneuver-box" ng-class="{\'card-maneuver-box-highlight\': shipClass.maneuvers[speed].about}">\n\t\t\t\t<i class="fs fs-come-about speed-{{shipClass.maneuvers[speed].about}}" ng-show="shipClass.maneuvers[speed].about"></i>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="card-corner-bottom-left pull-left">\n\t\t<div class="card-corner-inner"></div>\n\t</div>\n\n\t<div class="card-corner-bottom-right pull-right">\n\t\t<div class="card-corner-inner"></div>\n\t</div>\n\n\t<div class="card-border-bottom"></div>\n\n\t<div style="clear: both"></div>\n\n</div>\n'),t.put("card-ship.html",'<div class="card-outer card-ship font-staw" ng-class="{ \'card-unique\': ship.unique, \'card-mirror\': ship.mirror, \'dragging\': ship == dragStore.item }" draggable drag-item="ship" drag-store="dragStore" drag-source="dragSource">\n\n\t<div class="card-image"></div>\n\n\t<div class="card-corner-top-left pull-left"><i ng-if="ship.unique" class="card-unique-icon fs fs-unique pull-left"></i>\n\t\t<div class="card-corner-inner pull-right"></div>\n\t</div>\n\t<div class="card-corner-top-right pull-right"><i ng-repeat="faction in ship|valueOf:\'factions\':ship:fleet" class="card-ship-faction card-faction-{{faction}} card-faction-{{$index}} fs fs-empty" ng-class="{\'card-factions-multiple\': (ship|valueOf:\'factions\':ship:fleet).length > 1}"></i>\n\t\t<div class="card-corner-inner card-corner-inner-faction"></div>\n\t</div>\n\t<div class="card-title-container text-center">\n\t\t<span class="card-title" ng-class="{\'card-title-long\': ship.name.length >= 20 }">{{ship.name | uppercase}}</span>\n\t</div>\n\n\t<div class="card-ship-stats pull-left">\n\t\t<div class="card-ship-stat card-ship-stat-attack text-right" tooltip-show="fleet" tooltip="ship|valueOf:\'attack\':ship:fleet:false:{modifiers:true}" tooltip-position="e"><span class="card-skill-plus" ng-show="ship.isShipModifier">+</span>{{ship|valueOf:\'attack\':ship:fleet}}</div>\n\t\t<div class="card-ship-stat card-ship-stat-agility text-right" tooltip-show="fleet" tooltip="ship|valueOf:\'agility\':ship:fleet:false:{modifiers:true}" tooltip-position="e"><span class="card-skill-plus" ng-show="ship.isShipModifier">+</span>{{ship|valueOf:\'agility\':ship:fleet}}</div>\n\t\t<div class="card-ship-stat card-ship-stat-hull text-right" tooltip-show="fleet" tooltip="ship|valueOf:\'hull\':ship:fleet:false:{modifiers:true}" tooltip-position="e"><span class="card-skill-plus" ng-show="ship.isShipModifier">+</span>{{ship|valueOf:\'hull\':ship:fleet}}</div>\n\t\t<div class="card-ship-stat card-ship-stat-shields text-right" tooltip-show="fleet" tooltip="ship|valueOf:\'shields\':ship:fleet:false:{modifiers:true}" tooltip-position="e"><span class="card-skill-plus" ng-show="ship.isShipModifier">+</span>{{ship|valueOf:\'shields\':ship:fleet}}</div>\n\t</div>\n\n\t<div class="card-border-right pull-right"></div>\n\n\t<div class="card-ship-silhouette pull-left">\n\t  <i class="card-ship-silhouette-icon" style="background-image: url(img/ships/sil_{{ship.classId}}.png)"></i>\n\t</div>\n\n\t<div class="card-ship-class-container text-center">\n\t\t<span class="card-ship-class" ng-class="{\'card-ship-class-long\': ship.class.length >= 25 }">{{ship.class | uppercase}}</span>\n\t</div>\n\n\t<div class="card-text font-staw-alt"><div class="card-text-inner" ng-bind-html="ship.text | icons" ng-class="{\'card-text-inner-long\': ship.text.length > 230 }"></div></div>\n\n\t<div class="card-ship-action-bar text-center">\n\t\t<i ng-repeat="action in ship.actions" class="fs fs-{{action}}"></i>\n\t</div>\n\n\t<div class="card-corner-bottom-right pull-right">\n\t\t<div class="card-corner-inner"></div>\n\t</div>\n\n\t<div class="card-ship-cost pull-right">{{ship|valueOf:\'cost\':ship:fleet}}</div>\n\n\t<div class="card-ship-upgrade-bar">\n\t\t<i ng-repeat="upgrade in ship.upgrades track by $index" class="fs fs-{{upgrade.type[0]}}" ng-class="{\'card-ship-upgrade-occupied\': upgrade.occupant}"></i>\n\t</div>\n\t<div style="clear: both"></div>\n\n</div>\n'),t.put("card-token.html",'<div class="card-outer card-token font-staw">\n\n\t<div class="card-token-header">\n\t\t<span class="card-title" ng-class="{\'card-title-long\': token.name.length > 20}">{{token.name | uppercase}}</span>\n\t</div>\n\n\t<div class="card-text">\n\t\t<div class="card-text-inner font-staw-alt" ng-bind-html="token.text | icons"></div>\n\t</div>\n\n</div>'),t.put("card-upgrade.html",'<div class="card-outer card-upgrade font-staw" ng-class="{ \'card-unique\': upgrade.unique, \'card-OnePerShip\': upgrade.OnePerShip, \'card-factionFederation\': upgrade.factionFederation, \'card-FrontArc\': upgrade.FrontArc, \'card-RearArc\': upgrade.RearArc, \'card-Hull\': upgrade.Hull, \'card-mirror\': upgrade.mirror, \'dragging\': upgrade == dragStore.item }" draggable drag-item="upgrade" drag-store="dragStore" drag-source="dragSource">\n\n\t<div class="card-image"></div>\n\n\n\n\t<div class="card-corner-top-left pull-left">\n\t\t<i ng-if="upgrade.unique" class="card-unique-icon fs fs-unique pull-left"></i>\n\t\t<i ng-if="upgrade.OnePerShip" class="card-OnePerShip-icon fs fs-OnePerShip pull-left"></i>\n\t\t<i ng-if="upgrade.specialization" class="card-specialization-icon fs fs-specialization pull-left"></i>\n\t\t<div class="card-corner-inner pull-right"></div>\n\t</div>\n\n\t<div class="card-title-container text-left">\n\t\t<span ng-if="upgrade.showType" class="card-captain pull-right">{{upgrade.type|uppercase|removeDashes}}</span>\n\t\t<span ng-if="upgrade|valueOf:\'attack\':ship:fleet" class="card-weapon-attack pull-right" tooltip-show="ship" tooltip="upgrade|valueOf:\'attack\':ship:fleet:false:{modifiers:true}">{{upgrade|valueOf:\'attack\':ship:fleet}}</span>\n\t\t<span class="card-title"\n\t\t\tng-class="{ \'card-title-long\': upgrade.name.length >= 24 || (upgrade.showType && upgrade.name.length + upgrade.type.length >= 24) || (upgrade.attack && upgrade.name.length >= 20),\n\t\t\t\t\t\t\'card-title-super-long\': upgrade.name.length >= 31 || upgrade.showType && upgrade.name.length + upgrade.type.length >= 31,\n\t\t\t}">{{upgrade.name | uppercase}}</span>\n\t</div>\n\n\t<div class="card-border-left pull-left">\n\t\t<i ng-if="upgrade.captainFederation" class="card-captainFederation-icon fs fs-captainFederation"></i>\n\t\t<i ng-if="upgrade.captainBajoren" class="card-captainBajoren-icon fs fs-captainBajoren"></i>\n\t\t<i ng-if="upgrade.captainVulcan" class="card-captainVulcan-icon fs fs-captainVulcan"></i>\n\t\t<i ng-if="upgrade.captainKlingon"  class="card-captainKlingon-icon fs fs-captainKlingon"></i>\n\t\t<i ng-if="upgrade.captainRomulan" class="card-captainRomulan-icon fs fs-captainRomulan"></i>\n\t\t<i ng-if="upgrade.captainDominion" class="card-captainDominion-icon fs fs-captainDominion"></i>\n\t\t<i ng-if="upgrade.captainIndependent" class="card-captainIndependent-icon fs fs-captainIndependent"></i>\n\t\t<i ng-if="upgrade.captainFerengi" class="card-captainFerengi-icon fs fs-captainFerengi"></i>\n\t\t<i ng-if="upgrade.captainKazon" class="card-captainKazon-icon fs fs-captainKazon"></i>\n\t\t<i ng-if="upgrade.captainXindi" class="card-captainFerengi-icon fs fs-captainFerengi"></i>\n\t\t<i ng-if="upgrade.captainBorg" class="card-captainBorg-icon fs fs-captainBorg"></i>\n\t\t<i ng-if="upgrade.captain8472" class="card-captain8472-icon fs fs-captain8472"></i>\n\t\t<i ng-if="upgrade.captainMU" class="card-captainMU-icon fs fs-captainMU"></i>\n\n\t\t<i ng-if="upgrade.shipFederation" class="card-shipFederation-icon fs fs-card-shipFederation"></i>\n\t\t<i ng-if="upgrade.shipBajoren" class="card-shipBajoren-icon fs fs-card-shipBajoren"></i>\n\t\t<i ng-if="upgrade.shipVulcan" class="card-shipVulcan-icon fs fs-card-shipVulcan"></i>\n\t\t<i ng-if="upgrade.shipKlingon" class="card-shipKlingon-icon fs fs-shipKlingon"></i>\n\t\t<i ng-if="upgrade.shipRomulan" class="card-shipRomulan-icon fs fs-shipRomulan"></i>\n\t\t<i ng-if="upgrade.shipDominion" class="card-shipDominion-icon fs fs-shipDominion"></i>\n\t\t<i ng-if="upgrade.shipIndependent" class="card-shipIndependent-icon fs fs-shipIndependent"></i>\n\t\t<i ng-if="upgrade.shipFerengi" class="card-shipFerengi-icon fs fs-shipFerengi"></i>\n\t\t<i ng-if="upgrade.shipKazon" class="card-shipKazon-icon fs fs-shipKazon"></i>\n\t\t<i ng-if="upgrade.shipXindi" class="card-shipXindi-icon fs fs-shipXindi"></i>\n\t\t<i ng-if="upgrade.shipBorg" class="card-shipBorg-icon fs fs-shipBorg"></i>\n\t\t<i ng-if="upgrade.ship8472" class="card-ship8472-icon fs fs-ship8472"></i>\n\t\t<i ng-if="upgrade.shipMU" class="card-shipMU-icon fs fs-shipMU"></i>\n\n\t\t<i ng-if="upgrade.costFederation" class="card-costFederation-icon">{{upgrade|valueOf:\'costFederation\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costBajoren" class="card-costBajoren-icon">{{upgrade|valueOf:\'costFederation\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costVulcan" class="card-costVulcan-icon">{{upgrade|valueOf:\'costVulcan\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costKlingon" class="card-costKlingon-icon">{{upgrade|valueOf:\'costKlingon\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costRomulan" class="card-costRomulan-icon">{{upgrade|valueOf:\'costRomulan\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costDominion" class="card-costDominion-icon">{{upgrade|valueOf:\'costDominion\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costIndependent" class="card-costIndependent-icon">{{upgrade|valueOf:\'costIndependent\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costFerengi" class="card-costFerengi-icon">{{upgrade|valueOf:\'costFerengi\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costKazon" class="card-costKazon-icon">{{upgrade|valueOf:\'costKazon\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costXindi" class="card-costXindi-icon">{{upgrade|valueOf:\'costXindi\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costBorg" class="card-costBorg-icon">{{upgrade|valueOf:\'costBorg\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.cost8472" class="card-cost8472-icon">{{upgrade|valueOf:\'cost8472\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.costMU" class="card-costMU-icon">{{upgrade|valueOf:\'costMU\':ship:fleet}}</i>\n\n\t\t<i ng-if="upgrade.attackConstraint" class="card-attackConstraint-icon">{{upgrade|valueOf:\'attackConstraint\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.hullConstraint" class="card-hullConstraint-icon">{{upgrade|valueOf:\'hullConstraint\':ship:fleet}}</i>\n\t\t<i ng-if="upgrade.FrontArc" class="card-FrontArc-icon fs fs-FrontArc"></i>\n\t\t<i ng-if="upgrade.RearArc" class="card-RearArc-icon fs fs-RearArc"></i>\n\t\t<i ng-if="upgrade.arc360" class="card-360Arc-icon fs fs-360Arc"></i>\n\t\t<i ng-if="upgrade.shipLimit" class="card-shipLimit-icon fs fs-shipLimit"></i>\n\t\t<i ng-if="upgrade.constitutionLimit" class="card-constitutionLimit-icon fs fs-constitutionLimit"></i>\n\t\t<i ng-if="upgrade.akiraLimit" class="card-akiraLimit-icon fs fs-akiraLimit"></i>\n\t\t<i ng-if="upgrade.dkyrLimit" class="card-dkyrLimit-icon fs fs-dkyrLimit"></i>\n\t\t<i ng-if="upgrade.defiantLimit" class="card-defiantLimit-icon fs fs-defiantLimit"></i>\n\t\t<i ng-if="upgrade.prometheusLimit" class="card-prometheusLimit-icon fs fs-prometheusLimit"></i>\n\t\t<i ng-if="upgrade.remanLimit" class="card-remanLimit-icon fs fs-remanLimit"></i>\n\t\t<i ng-if="upgrade.suurokLimit" class="card-suurokLimit-icon fs fs-suurokLimit"></i>\n\t\t<i ng-if="upgrade.faq" class="card-faq-icon fs fs-faq"></i>\n\t\t<i ng-if="upgrade.opBanned" class="card-OP-banned-icon fs fs-opBanned"></i>\n\n\t</div>\n\n\t<div class="card-text">\n\t\t<div ng-if="upgrade.range" class="card-weapon-range pull-right">{{upgrade|valueOf:\'range\':ship:fleet}}</div>\n\t\t<div class="card-text-inner font-staw-alt" ng-bind-html="upgrade.text | icons" ng-class="{\'card-text-inner-long\': upgrade.text.length > 300, \'card-text-inner-super-long\': upgrade.text.length > 530, \'text-left\': upgrade.range }"></div>\n\t</div>\n\n\t<div class="card-upgrade-cost pull-right"><div ng-repeat="faction in upgrade|valueOf:\'factions\':ship:fleet" class="card-upgrade-faction card-faction-{{ (upgrade|valueOf:\'factions\':ship:fleet).length - $index}}"><div class="card-upgrade-faction-black"></div><div class="card-upgrade-faction-icon card-faction-{{faction}}"></div></div><div class="card-upgrade-cost-value" ng-class="{\'card-upgrade-cost-free\': \'{{upgrade|valueOf:\'free\':ship:fleet}}\' }" tooltip-show="ship" tooltip="upgrade|valueOf:\'cost\':ship:fleet:false:{modifiers:true}">{{upgrade|valueOf:\'cost\':ship:fleet}}</div></div>\n\n\t<div ng-if="upgrade.type == \'captain\' || upgrade.type == \'admiral\' || (upgrade|valueOf:\'skill\':ship:fleet)" class="card-skill-container pull-left">\n\t\t<div class="card-skill" tooltip-show="ship" tooltip="upgrade|valueOf:\'skill\':ship:fleet:false:{modifiers:true}" tooltip-position="nw-alt"><span class="card-skill-plus" ng-show="upgrade.isSkillModifier && upgrade.skill >= 0">+</span>{{upgrade|valueOf:\'skill\':ship:fleet}}</div>\n\t</div>\n\n\t<div ng-if="!(upgrade|valueOf:\'skill\':ship:fleet) && upgrade.type != \'captain\' && upgrade.type != \'admiral\' " class="card-upgrade-type pull-left fs fs-{{upgrade.type}}"></div>\n\n\t<div class="card-border-bottom">\n\t\t<i ng-if="upgrade.talents" ng-repeat="talent in range(upgrade.talents) track by $index" class="fs fs-talent"></i>\n\t\t<i ng-repeat="slot in upgrade.upgradeSlots track by $index" ng-if="slot.showOnCard" class="fs fs-{{slot.type[0]}}" ng-class="{\'card-upgrades-long\': upgrade.upgradeSlots.length > 2}"></i>\n\t</div>\n\n<i ng-if="upgrade.alliance" class="card-alliance-icon fs fs-alliance">\n\n\t<div style="clear: both"></div>\n\n</div>\n'),t.put("card.html",'<div ng-if="card" ng-switch on="card.type">\n\t<card-ship \t\t\tng-switch-when="ship" ship="card" drag-store="dragStore" drag-source="dragSource" fleet="fleet"></card-ship>\n\t<card-ship \t\t\tng-switch-when="flagship" ship="card" drag-store="dragStore" drag-source="dragSource" fleet="fleet"></card-ship>\n\t<card-ship-class\tng-switch-when="ship-class" ship-class="card" ship="ship" fleet="fleet"></card-ship-class>\n\t<card-resource \t\tng-switch-when="resource" resource="card" drag-store="dragStore" drag-source="dragSource" ship="ship" fleet="fleet"></card-resource>\n\t<card-token \t\tng-switch-when="token" token="card" drag-store="dragStore" drag-source="dragSource" ship="ship" fleet="fleet"></card-token>\n\t<card-faction \t\tng-switch-when="faction" faction="card" drag-store="dragStore" drag-source="dragSource" ship="ship" fleet="fleet"></card-faction>\n\t<card-upgrade \t\tng-switch-default upgrade="card" drag-store="dragStore" drag-source="dragSource" ship="ship" fleet="fleet"></card-upgrade>\n</div>')}]);
//# sourceMappingURL=utopia.min.js.map